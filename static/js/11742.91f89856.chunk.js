"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[11742],{11742:(t,e,s)=>{s.r(e),s.d(e,{default:()=>_});var i=s(35143),a=s(5632),o=s(50346),r=s(68134),l=s(46053),n=(s(81806),s(76460),s(47249),s(85842)),u=s(19451),p=s(9912),d=s(48397),c=s(91039),y=s(26547);let h=class extends(a.A.IdentifiableMixin(d.A)){constructor(t){super(t),this.group=null,this.type="utilityNetworkAssociations",this.featureItem=null,this._updatingHandlesSetUp=new u.U,this.addHandles([(0,r.watch)((()=>({feature:this.feature,element:this.element,layer:this.layer})),(t=>this._createAssociationVM(t)),r.initial),(0,r.watch)((()=>this.feature),(()=>this._setFeatureItem())),(0,r.watch)((()=>this.associatedLayer),((t,e)=>this._updateLayerEditHandle(t,e)),r.initial)])}destroy(){this._associationsVM?.destroy(),this._updatingHandlesSetUp.destroy()}get activeAssociationType(){return this._associationsVM?.activeAssociationType}get associatedFeatures(){const{associatedLayer:t}=this;if(t)return this.associatedFeatureInfos.get(t)}get associatedFeatureInfos(){const{_associationsVM:t}=this;if(!t?.associationFeatures?.size||!t?.utilityNetwork)return new Map;const{associationFeatures:e}=t,s=new Map;return e.forEach(((t,e)=>{const i=t.map((t=>{if(null==t.title){const e=(0,y.R)(t.feature);return{...t,title:e}}return t}));s.set(e,i)})),s}get associatedLayer(){return this._get("associatedLayer")}set associatedLayer(t){this._associationsVM.showAllEnabled=null!=t,this._set("associatedLayer",t)}get associationsViewModel(){return this._associationsVM}get canAddAssociation(){const{editable:t,utilityNetwork:e}=this;return!(!e||!this.loaded)&&t}get editable(){return this.evaluatedEditableExpression??!0}get featureCount(){return this._associationsVM?.featureCount??0}get viewModel(){return this._associationsVM}get loaded(){return"loading"!==this._associationsVM?.state&&!this._updatingHandlesSetUp.updating}get map(){return this._get("map")}set map(t){t&&this._associationsVM?.set("map",t),this._set("map",t)}get utilityNetwork(){return this._associationsVM?.utilityNetwork}get associationTypes(){return this._associationsVM?.associationTypes??this.element.associationTypes}get visible(){const{utilityNetwork:t}=this;return!!t&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element)}get updating(){return"loading"===this._associationsVM?.state||"querying"===this._associationsVM?.state}async refresh(){await(0,o.ignoreAbortErrors)(this._associationsVM.refresh())}_updateLayerEditHandle(t,e){e&&"layerId"in e&&this.removeHandles(e?.layerId),(0,p.isAssociatedFeatureSupportedLayer)(t)&&this.addHandles((0,r.on)((()=>t),"edits",(()=>this.refresh())),t.layerId)}_createAssociationVM(t){const{feature:e,element:s,layer:i}=t;if(this._associationsVM?.destroy(),!e||!s||!i)return;const{map:a,associationTypes:o}=this;(0,p.isAssociatedFeatureSupportedLayer)(i)&&(this._associationsVM=new c.A({graphic:e,layer:i,map:a,associationTypes:o,source:"featureForm",title:this.label,description:this.description}))}_setFeatureItem(){this._updatingHandlesSetUp.addPromise((async()=>{const{feature:t,layer:e}=this;t&&e&&"getFeatureTitle"in e&&(this.featureItem={feature:t,label:await e.getFeatureTitle(t)})})())}};(0,i._)([(0,l.MZ)()],h.prototype,"_associationsVM",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"activeAssociationType",null),(0,i._)([(0,l.MZ)()],h.prototype,"associatedFeatures",null),(0,i._)([(0,l.MZ)()],h.prototype,"associatedFeatureInfos",null),(0,i._)([(0,l.MZ)()],h.prototype,"associatedLayer",null),(0,i._)([(0,l.MZ)()],h.prototype,"associationsViewModel",null),(0,i._)([(0,l.MZ)()],h.prototype,"canAddAssociation",null),(0,i._)([(0,l.MZ)()],h.prototype,"editable",null),(0,i._)([(0,l.MZ)()],h.prototype,"featureCount",null),(0,i._)([(0,l.MZ)()],h.prototype,"viewModel",null),(0,i._)([(0,l.MZ)()],h.prototype,"group",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"loaded",null),(0,i._)([(0,l.MZ)()],h.prototype,"map",null),(0,i._)([(0,l.MZ)()],h.prototype,"utilityNetwork",null),(0,i._)([(0,l.MZ)()],h.prototype,"associationTypes",null),(0,i._)([(0,l.MZ)({readOnly:!0})],h.prototype,"type",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"visible",null),(0,i._)([(0,l.MZ)()],h.prototype,"updating",null),(0,i._)([(0,l.MZ)()],h.prototype,"featureItem",void 0),h=(0,i._)([(0,n.$)("esri.widgets.FeatureForm.UtilityNetworkAssociationInput")],h);const _=h},48397:(t,e,s)=>{s.d(e,{A:()=>p});var i=s(35143),a=s(46053),o=(s(81806),s(76460),s(47249),s(85842)),r=s(31933),l=s(84668),n=s(23301);let u=class extends l.A{constructor(t){super(t),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:t}=this;if(!t)return!1;const e=(0,r.BR)(t),s=e?.operations.supportsEditing,i=(0,n.of)(e,this.arcadeEditType);return!(!s||!i)}};(0,i._)([(0,a.MZ)()],u.prototype,"arcadeEditType",void 0),(0,i._)([(0,a.MZ)()],u.prototype,"editable",null),(0,i._)([(0,a.MZ)()],u.prototype,"editableExpressionExecutor",void 0),(0,i._)([(0,a.MZ)()],u.prototype,"evaluatedEditableExpression",null),(0,i._)([(0,a.MZ)()],u.prototype,"layerAllowsEdits",null),u=(0,i._)([(0,o.$)("esri.widgets.FeatureForm.EditableInput")],u);const p=u},84668:(t,e,s)=>{s.d(e,{A:()=>u});var i=s(35143),a=s(91967),o=s(46053),r=(s(81806),s(76460),s(47249),s(85842)),l=s(3320);let n=class extends a.default{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(t){const{feature:e,layer:s,timeZone:i}=this;return null==s||null==t?t:(0,l.LZ)({label:t,attributes:e.attributes,fieldsIndex:s.fieldsIndex,timeZone:i})}};(0,i._)([(0,o.MZ)({readOnly:!0})],n.prototype,"description",null),(0,i._)([(0,o.MZ)({constructOnly:!0})],n.prototype,"element",void 0),(0,i._)([(0,o.MZ)()],n.prototype,"evaluatedVisibilityExpression",null),(0,i._)([(0,o.MZ)()],n.prototype,"feature",void 0),(0,i._)([(0,o.MZ)()],n.prototype,"label",null),(0,i._)([(0,o.MZ)()],n.prototype,"layer",void 0),(0,i._)([(0,o.MZ)()],n.prototype,"timeZone",void 0),(0,i._)([(0,o.MZ)()],n.prototype,"type",void 0),(0,i._)([(0,o.MZ)()],n.prototype,"updating",null),(0,i._)([(0,o.MZ)()],n.prototype,"visible",null),(0,i._)([(0,o.MZ)()],n.prototype,"visibilityExpressionExecutor",void 0),n=(0,i._)([(0,r.$)("esri.widgets.FeatureForm.InputBase")],n);const u=n}}]);
//# sourceMappingURL=11742.91f89856.chunk.js.map