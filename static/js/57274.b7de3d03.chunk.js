"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[13888,57274],{13888:(e,t,s)=>{s.r(t),s.d(t,{default:()=>g});var r=s(35143),o=s(46053),l=(s(81806),s(76460),s(47249),s(85842)),i=s(25329);const n="esri-search-result-renderer",u={base:n,showMoreResults:`${n}__more-results--show-more-results`,moreResults:`${n}__more-results`,moreResultsList:`${n}__more-results-list`,moreResultsHeader:`${n}__more-results-header`,moreResultsItem:`${n}__more-results-item`,moreResultsListHeader:`${n}__more-results-list-header`};var a=s(97537),c=s(98108),h=s(20459),d=s(63582),p=s(54761);s(76099);let _=class extends i.default{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[u.showMoreResults]:this.showMoreResultsOpen};return(0,p.K)("div",{class:this.classes(u.base,c.D.widget)},(0,p.K)("div",{class:this.classes(u.moreResults,e),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return(0,p.K)("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){const e=this.viewModel?.selectedResult,t=e?.name||"";return(0,p.K)("div",{class:u.moreResultsItem,key:"esri-search-renderer__result-name"},t)}_renderMoreResultsLists(){const{viewModel:e}=this;if(!e)return[];const t=e.results;if((e.resultCount??0)<2)return null;const s=t?.map((e=>this._renderMoreResultsList(e)));return(0,p.K)("div",{class:u.moreResultsList,key:"esri-search-renderer__more-results-container"},s)}_renderMoreResultsButton(){const{messages:e,viewModel:t}=this;return t?(t.resultCount??0)<2?null:(0,p.K)("div",{class:u.moreResultsItem,key:"esri-search-renderer__more-results-button"},(0,p.K)("a",{bind:this,class:c.D.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults)):null}_renderMoreResultsHeader(e,t){return(0,p.K)("div",{class:u.moreResultsListHeader,key:`esri-search-result-renderer__header-${t}`},e)}_renderMoreResultsList(e){const{results:t}=e,s=t?.length??0,r=s>0,o=this.viewModel?.selectedResult,l=1===s&&t[0]===o,i=this._getSourceName(e.source,e.sourceIndex),n=(this.viewModel?.results?.length??0)>1&&!l?this._renderMoreResultsHeader(i,e.sourceIndex):null,u=r&&t.map(((e,t)=>this._renderMoreResultsListItem(e,t))),a=r&&!l?(0,p.K)("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},u):null;return r?(0,p.K)("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},n,a):null}_renderMoreResultsListItem(e,t){const s=this.viewModel?.selectedResult;return e!==s?(0,p.K)("li",{key:`esri-search-result-renderer__list-item-${t}`},(0,p.K)("a",{bind:this,class:c.D.anchor,"data-result":e,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const t=this.viewModel?.view?.popup;t&&"reposition"in t&&t.reposition()}_selectResultClick(e){e.preventDefault();const t=e.currentTarget["data-result"];this.viewModel?.select(t)}_getSourceName(e,t){return t===a.default.ALL_INDEX?this.messages.all:e.name}};(0,r._)([(0,o.MZ)(),(0,d.G)("esri/widgets/Search/t9n/Search")],_.prototype,"messages",void 0),(0,r._)([(0,o.MZ)()],_.prototype,"showMoreResultsOpen",void 0),(0,r._)([(0,o.MZ)()],_.prototype,"viewModel",void 0),(0,r._)([(0,h.$)()],_.prototype,"_showMoreResultsClick",null),(0,r._)([(0,h.$)()],_.prototype,"_selectResultClick",null),_=(0,r._)([(0,l.$)("esri.widgets.Search.SearchResultRenderer")],_);const g=_},57274:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var r=s(35143),o=(s(11265),s(63241)),l=s(76460),i=s(30726),n=s(50346),u=s(68134),a=s(52394),c=s(46053),h=(s(81806),s(47249),s(85842)),d=s(25329);const p="esri-search",_={base:p,autocomplete:`${p}__autocomplete`,dropdown:`${p}__dropdown`,container:`${p}__container`,form:`${p}__form`};var g=s(13888),m=s(97537),v=s(94126),M=s(98108),w=(s(76099),s(63582)),b=s(12254),S=s(54761),y=s(39348);let R=class extends d.default{constructor(e,t){super(e,t),this._currentLocationValue=`${this.id}-search-use-current-location`,this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new g.default,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new m.default,this._renderSearchResultsContent=()=>this._searchResultRenderer,this.addHandles([(0,u.watch)((()=>this.viewModel),(e=>this._searchResultRenderer.viewModel=e),u.initial),(0,u.watch)((()=>this.viewModel.results),(()=>this._searchResultRenderer.showMoreResultsOpen=!1)),(0,u.watch)((()=>this.viewModel?.defaultPopupTemplate),(e=>{e&&(e.content=this._renderSearchResultsContent)}),u.initial)])}loadDependencies(){return(0,v.W)({autocomplete:()=>s.e(19637).then(s.bind(s,19637)),"autocomplete-item-group":()=>s.e(64767).then(s.bind(s,64767)),"autocomplete-item":()=>s.e(5065).then(s.bind(s,5065)),button:()=>Promise.resolve().then(s.bind(s,43285)),dropdown:()=>Promise.resolve().then(s.bind(s,24482)),"dropdown-group":()=>Promise.resolve().then(s.bind(s,5368)),"dropdown-item":()=>Promise.resolve().then(s.bind(s,84660)),notice:()=>s.e(12261).then(s.bind(s,12261))})}destroy(){this._cancelQueries(),this._searchResultRenderer=(0,i.pR)(this._searchResultRenderer),this._focusAbortController?.abort()}get _isDisabled(){const{state:e}=this.viewModel;return"disabled"===e||"loading"===e||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const{activeMenu:e}=this;return this._isDisabled?"none":"warning"===e?"suggestion":e}get activeMenu(){return"none"}set activeMenu(e){"warning"===e&&(0,o.ck)(l.A.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",e)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"search"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){return this.viewModel?.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){this._autocompleteNode?.blur(),this._emitBlur()}async search(e){this._cancelQueries();const t=new AbortController,{signal:s}=t;this._searchController=t;try{const r=await this.viewModel.search(e,{signal:s});if(this._searchController!==t)return;return r?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,r}catch(r){if(this._searchController!==t)return;return void(this._searchController=null)}}async suggest(e){this._cancelSuggest();const t=new AbortController,{signal:s}=t;this._suggestController=t;try{const r=await this.viewModel.suggest(e,null,{signal:s});if(this._suggestController!==t)return;return this._suggestController=null,r?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),r}catch(r){return this._suggestController!==t||(this._suggestController=null),null}}render(){return(0,S.K)("div",{class:this.classes(_.base,M.D.widget)},(0,S.K)("div",{class:_.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(e){"Tab"===e.key&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const e=this._focusAbortController.signal;await(0,n.ignoreAbortErrors)((0,a.waitAnimationFrame)(e)),this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const{messages:e,_isDisabled:t,_effectiveActiveMenu:s}=this,{allSources:r,searchAllEnabled:o}=this.viewModel;return r.length>1?(0,S.K)("calcite-dropdown",{bind:this,class:_.dropdown,disabled:t,open:"source"===s,overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},(0,S.K)("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:e.searchIn,slot:"trigger"}),(0,S.K)("calcite-dropdown-group",{groupTitle:e.searchIn},o?this._renderSource(m.default.ALL_INDEX):null,r.map(((e,t)=>this._renderSource(t))).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:e}=this;return(0,S.K)("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:e,value:e})}_handleAutocompleteCreate(e){this._autocompleteNode=e}_handleCalciteAutocompleteTextInput(e){const t=e.target.inputValue;t!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=t,t||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){"suggestion"===this.activeMenu&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(e){const t=e.target.value;if(t===this._currentLocationValue)return void this._useCurrentLocation();const s=this.viewModel.suggestions?.flatMap((e=>e.results??[])),r=s?.find((e=>`${e.key}`==`${t}`));r&&this.search(r)}_renderAutocomplete(){const{_effectiveActiveMenu:e,messages:t,_isDisabled:s}=this,{maxInputLength:r,placeholder:o,searchTerm:l,state:i}=this.viewModel,n=this.label??t.searchButtonTitle??"";return(0,S.K)("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:_.autocomplete,disabled:s,icon:this.icon,inputValue:l,label:n,loading:"searching"===i,maxLength:r,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:"suggestion"===e,overlayPositioning:"fixed",placeholder:o,title:l?"":o,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return(0,S.K)("form",{bind:this,class:_.form,disabled:this._isDisabled,key:_.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete())}_renderSuggestGroup(e){return e.results?.map((e=>this._renderSuggestion(e)))}_renderSuggestions(){const{suggestions:e}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():e?.map((e=>this._renderSuggestResults(e)))}_renderSuggestResults(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:r}=e,o=e.results?.length,l=t.length>1&&s===m.default.ALL_INDEX,i=this._getSourceName(r);return o&&l?(0,S.K)("calcite-autocomplete-item-group",{heading:i,key:`suggestion-group-${i}-${r}`},this._renderSuggestGroup(e)):this._renderSuggestGroup(e)}_renderSuggestion(e){return(0,S.K)("calcite-autocomplete-item",{heading:e.text??this.messages.untitledResult,key:`suggestion_${e.key}`,value:`${e.key}`})}_renderSource(e){const t=this._getSourceName(e);return(0,S.K)("calcite-dropdown-item",{"data-source-index":`${e}`,key:`source-${t}-${e}`,selected:e===this.viewModel.activeSourceIndex},t)}_renderNoResultsWarning(e){const{messages:t}=this,s=e?(0,y.V)(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return(0,S.K)("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},(0,S.K)("div",{slot:"title"},t.noResults),(0,S.K)("div",{slot:"message"},s))}_renderLocateError(){return(0,S.K)("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},(0,S.K)("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const e=new AbortController,{signal:t}=e;this._searchController=e;try{await this.viewModel.searchNearby({signal:t})}catch(p){(0,n.isAbortError)(p)||(this._locateFailed=!0)}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){"source"===this.activeMenu&&(this.activeMenu="none")}_handleSourceSelect(e){const t=e.target.selectedItems[0].getAttribute("data-source-index");t&&(this.viewModel.activeSourceIndex=parseInt(t,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=(0,i.DC)(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=(0,i.DC)(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(e){e.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(e){const{messages:t}=this,{allSources:s}=this.viewModel,r=s.at(e);return e===m.default.ALL_INDEX?t.all:r?.name||t.untitledSource}};(0,r._)([(0,c.MZ)()],R.prototype,"_locateFailed",void 0),(0,r._)([(0,c.MZ)()],R.prototype,"_showNoResults",void 0),(0,r._)([(0,c.MZ)()],R.prototype,"_isDisabled",null),(0,r._)([(0,c.MZ)()],R.prototype,"_showCurrentLocation",null),(0,r._)([(0,c.MZ)()],R.prototype,"_effectiveActiveMenu",null),(0,r._)([(0,c.MZ)()],R.prototype,"activeMenu",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"activeSource",null),(0,r._)([(0,c.MZ)()],R.prototype,"activeSourceIndex",null),(0,r._)([(0,c.MZ)()],R.prototype,"allPlaceholder",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"allSources",null),(0,r._)([(0,c.MZ)()],R.prototype,"autoNavigate",null),(0,r._)([(0,c.MZ)()],R.prototype,"autoSelect",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"defaultSources",null),(0,r._)([(0,c.MZ)()],R.prototype,"disabled",void 0),(0,r._)([(0,c.MZ)()],R.prototype,"goToOverride",null),(0,r._)([(0,c.MZ)()],R.prototype,"icon",null),(0,r._)([(0,c.MZ)()],R.prototype,"includeDefaultSources",null),(0,r._)([(0,c.MZ)()],R.prototype,"label",null),(0,r._)([(0,c.MZ)()],R.prototype,"locationEnabled",null),(0,r._)([(0,c.MZ)()],R.prototype,"maxResults",null),(0,r._)([(0,c.MZ)()],R.prototype,"maxSuggestions",null),(0,r._)([(0,c.MZ)(),(0,w.G)("esri/widgets/Search/t9n/Search")],R.prototype,"messages",void 0),(0,r._)([(0,c.MZ)(),(0,w.G)("esri/t9n/common")],R.prototype,"messagesCommon",void 0),(0,r._)([(0,c.MZ)()],R.prototype,"minSuggestCharacters",null),(0,r._)([(0,c.MZ)()],R.prototype,"popupEnabled",null),(0,r._)([(0,c.MZ)()],R.prototype,"popupTemplate",null),(0,r._)([(0,c.MZ)()],R.prototype,"portal",null),(0,r._)([(0,c.MZ)()],R.prototype,"resultGraphic",null),(0,r._)([(0,c.MZ)()],R.prototype,"resultGraphicEnabled",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"results",null),(0,r._)([(0,c.MZ)()],R.prototype,"searchAllEnabled",null),(0,r._)([(0,c.MZ)()],R.prototype,"searchTerm",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"selectedResult",null),(0,r._)([(0,c.MZ)()],R.prototype,"sources",null),(0,r._)([(0,c.MZ)({readOnly:!0})],R.prototype,"suggestions",null),(0,r._)([(0,c.MZ)()],R.prototype,"suggestionsEnabled",null),(0,r._)([(0,c.MZ)()],R.prototype,"view",null),(0,r._)([(0,b.U)(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),(0,c.MZ)({type:m.default})],R.prototype,"viewModel",void 0),R=(0,r._)([(0,h.$)("esri.widgets.Search")],R);const C=R}}]);
//# sourceMappingURL=57274.b7de3d03.chunk.js.map