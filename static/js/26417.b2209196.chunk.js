"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[21964,26417,40998,63733,64826,89646,91329,95327],{2504:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Y});var i=r(35143),s=r(55171),a=r(19276),l=r(63241),o=r(50076),n=r(54099),c=r(76460),u=r(68134),h=r(46053),p=(r(81806),r(47249),r(85842)),d=r(19902),y=r(63860),g=r(30907),f=r(63733),m=r(72599),w=r(31933),v=r(14147),b=r(78715),_=r(24883),A=r(96422),k=r(40998),R=r(91329),I=r(64826),G=r(69120),S=r(63391),L=r(23701),T=r(9624),F=r(13312);function M(e){return"polygon"===e.type||"polyline"===e.type}class N{createBuffer(e,t,r,i){if(Array.isArray(e)){if(e.length>0){const s=F.default.fromJSON(e[0].spatialReference);return s.isWGS84||s.isWebMercator?(0,S.geodesicBuffer)(e,t,r,i):(0,S.buffer)(e,t,r,i)}return}const s=F.default.fromJSON(e.spatialReference);return s.isWGS84||s.isWebMercator?(0,S.geodesicBuffer)(e,t[0],r):(0,S.buffer)(e,t[0],r)}createConvexHull(e){if(Array.isArray(e)){if(1===e.length&&function(e){return function(e){return e.hasOwnProperty("points")}(e)&&2===e.points.length}(e[0])){const t=(0,S.convexHull)(e[0]);if(M(t))return t}return(0,S.convexHull)(e,!0).filter(M)}const t=(0,S.convexHull)(e);if(M(t))return t}calculateArea(e,t){const r=new F.default({wkid:e.spatialReference.wkid});return r.isWGS84||r.isWebMercator?parseFloat((0,S.geodesicArea)(e,t).toFixed(2)):parseFloat((0,S.planarArea)(e,t).toFixed(2))}mergeAggregatedToGeometries(e){const t=[],{line:r,multipoint:i,polygon:s}=e;return r&&t.push(r),i&&t.push(i),s&&t.push(s),t}getPercentageAlong(e,t,r){let i=e;const s=this._createPolyline(e.paths,r.wkid);if("point"===t.type){const e=t.x-.5,a=t.x+.5,l=[[[e,t.y-.5],[a,t.y+.5]]];i=this._createPolyline(l,t.spatialReference.wkid),i=(0,T.project)(i,r);const o=(0,S.cut)(s,i);if(o.length>0){const e=(0,S.planarLength)(s,"feet");let t;return t=o[0].paths[0][0][0]===s.paths[0][0][0]?(0,S.planarLength)(o[0],"feet"):(0,S.planarLength)(o[1],"feet"),[t/e]}return[.5]}i=(0,T.project)(t,r);const a=(0,S.cut)(s,i);if(a.length>0){const e=(0,S.planarLength)(s,"feet");return[(0,S.planarLength)(a[0],"feet")/e]}return[.5]}async projectGeometry(e,t){return await(0,T.load)(),(0,T.project)(e,t)}_createPolyline(e,t){return new L.default({hasZ:!1,hasM:!0,paths:e,spatialReference:new F.default({wkid:t})})}}var O=r(94560),C=r(39356),P=r(73204),B=r(40585),H=r(86875);const U=`utility-network-trace-result-area-${Date.now()}`;function V(e){return"graphics"===e.type}class E{constructor(){this.traceInformation={},this._geometryHandler=new N}addResultAreaToMap(e,t){const r=this.createGraphicLayer(t);r&&V(r)&&r.add(e)}changeResultAreaColor(e,t,r){const i=new H.default({color:t.color,style:"solid",outline:{color:t.color,width:1}}),s=this._findGraphicsByTraceId(e,r);return s&&s.forEach((e=>{e.symbol=i})),i}createBuffer(e,t,r,i){return this._geometryHandler.createBuffer(e,t,r,i)}createConvexHull(e,t,r){const i=this._geometryHandler.createConvexHull(e);return t>0&&i?this.createBuffer(i,[t],r,!1):i}createResultAreaGraphic(e,t,r,i,s,a){const l=new H.default({color:a.color,style:"solid",outline:{color:a.color,width:1}}),o=[];for(const n in t)o.push(new B.default({fieldName:n,label:"areaStatistic"===n?i.attributeStrings[n]+" ("+s.units[r]?.abbr+")":i.attributeStrings[n]}));return new C.default({geometry:e,symbol:l,attributes:t,popupTemplate:new P.default({title:t.traceName,content:[{type:"fields",fieldInfos:o}]})})}removeResultArea(e,t){const r=t.findLayerById(U);if(r&&V(r)){const i=this._findGraphicsByTraceId(e,t);return i&&r.removeMany(i),i}return null}removeAllResultAreaGraphics(e){if(e){const t=e.findLayerById(U);t&&V(t)&&t.removeAll()}}createGraphicLayer(e,t){const r=e.findLayerById(U);if(r&&V(r))return r;const i=new f.default({title:t??U,listMode:"hide",id:U});return e.add(i),i}_findGraphicsByTraceId(e,t){const r=t.findLayerById(U);if(r&&V(r)){const t=r.graphics.filter((t=>t.attributes.traceId===e));return t.length>0?t.toArray():null}return null}}function Z(e){return"feature"===e.type}function x(e,t){return e.url.includes(t)}function D(e,t){return(e.dataElement?.domainNetworks||[]).some((e=>e.subnetworkLayerId===t.layerId))}class j{getValidUtilityNetworkLayers(e,t){const r=[];return e?.allLayers.forEach((e=>{"group"===e.type?r.push(...e.layers.filter(w.yZ).filter((e=>Z(e)&&t.isUtilityLayer(e)&&!D(t,e))).filter((e=>x(e,t.featureServiceUrl))).toArray()):"subtype-group"===e.type?r.push(...e.sublayers.filter((e=>x(e,t.featureServiceUrl))).toArray()):(0,w.yZ)(e)&&Z(e)&&t.isUtilityLayer(e)&&!D(t,e)&&x(e,t.featureServiceUrl)&&r.push(e)})),r}}const q=`utility-network-trace-flags-${Date.now()}`,J=`utility-network-trace-results-${Date.now()}`,z=`utility-network-trace-sketch-${Date.now()}`;function W(e){return void 0!==e.layerViews}function $(e){return"feature"===e.type||"subtype-group"===e.type||"group"===e.type}let K=class extends n.A.EventedAccessor{constructor(e){super(e),this._activeProgress=!1,this._clickHandler=null,this._flags=[],this._flagId=0,this._geometryHandler=null,this._highlightHandler=[],this._resultAreaHandler=null,this._sketchViewModel=null,this._traceTimeout=6e5,this._utilityHelper=new j,this._validUNLayers=[],this._watchHandler=null,this.traces=[],this.graphicHandler=null,this.defaultGraphicColor={color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#FFFF00"},this.enableResultArea=!1,this.flags=[],this.gdbVersion="sde.DEFAULT",this.messages=null,this.messagesUnits=null,this.defaultResultAreaProperties={type:"convexhull",distance:10,unit:"meters",areaUnit:"square-meters",color:{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},show:!1},this.selectedTraces=[],this.selectOnComplete=!0,this.showGraphicsOnComplete=!0,this.showSelectionAttributes=!0,this.traceResults=[],this.utilityNetwork=null}initialize(){(0,l.eO)(c.A.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this._geometryHandler=new N,this.graphicHandler=new O.pC,this._resultAreaHandler=new E,(async()=>{const[e,t]=await Promise.all([(0,y.ud)("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace"),(0,y.ud)("esri/core/t9n/Units")]);this.set({messages:e,messagesUnits:t})})()}destroy(){this.view=null}get resultAreaProperties(){return this.defaultResultAreaProperties}set resultAreaProperties(e){this._set("resultAreaProperties",{...this.defaultResultAreaProperties,...e}),this.graphicHandler.addCustomColor(this.resultAreaProperties.color),this.traceResults.forEach((t=>{const r=t.resultArea?.show;t.resultArea={...this.defaultResultAreaProperties,...e},this.removeResultAreaFromMap(t),this.enableResultArea&&this.createResultAreaGraphic(t).then((i=>{if(i){t.resultAreaGraphic=i;const s=e?.show??r;t.resultArea&&(t.resultArea.show=s),s&&this.addResultAreaToMap(t,i)}}))}))}get state(){return this.view?.ready?"ready":"loading"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&c.A.getLogger(this).error(new o.default("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e),this.utilityNetwork&&this.reset(),this.utilityNetwork=null,this.loadUtilityNetwork().then((e=>{e&&this.selectTracesOnLoad()}))}addFlagByHit(e,t){const r=!!this.view&&this.view.popupEnabled,i=e=>{this.view?.popup&&(this.view.popupEnabled=e)};return new Promise(((s,a)=>{r&&i(!1),this._clickHandler?.remove(),this._clickHandler=this._sketchViewModel.on("create",(l=>{if("complete"===l.state){const o=this._getGraphicLayer(z);o&&l.graphic&&o.remove(l.graphic),this.queryFlagByHitTest(l,e,t).then((r=>{this.emit("add-flag-complete",{type:e,symbol:t}),s(r)})).catch((r=>{this.emit("add-flag-error",{type:e,symbol:t}),a(r)})).finally((()=>{r&&i(!0),this._clickHandler?.remove()}))}})),this._sketchViewModel.create("point"),this.emit("add-flag",{type:e})}))}addNonspatialTraceLocation(e,t){const r=this._getDisplayField(e),i=this.utilityNetwork?.getTerminalConfiguration(e),s={terminalId:null,isFilterBarrier:!1,allTerminals:i,selectedTerminals:[i?i.terminals[0].id||null:1],displayValue:r};e.attributes={...e.attributes,...s};const a=e.attributes.hasOwnProperty("GLOBALID")?e.attributes.GLOBALID:e.attributes.globalid;if(!this._flags.some((e=>e.globalId===a&&e.type===t))){const r=this._createFlagProperty(e,t,null);this._flags.push(r),this.emit("add-flag-complete",{type:t})}this.emit("add-flag",{type:t})}async addFlagsOnLoad(){return this._flags.length>0?[]:(await(0,u.whenOnce)((()=>null!=this.view&&!this.view.updating)),(await Promise.all(this.flags.map((async e=>{if(!e.mapPoint)return null;const{type:t}=e,r=e.mapPoint.clone(),i="barrier"===t?O.XU:O.KM,s={graphic:this.graphicHandler.makeGraphic(r,i),state:"complete",tool:"point",toolEventInfo:null,type:"create"};try{return await this.queryFlagByHitTest(s,e.type,null),this.emit("add-flag-complete",{type:t}),null}catch(D){return this.emit("add-flag-error",{type:t}),"barrier"===t?"barrier":"starting-point"}})))).filter((e=>!e)))}async addResultAreaToMap(e,t){if(this.view)if(e.resultArea.show=!0,t)this._resultAreaHandler?.addResultAreaToMap(t,this.view.map),this.emit("add-result-area",{graphic:t});else if(e.results){const t=await this.createResultAreaGraphic(e);t&&(e.resultAreaGraphic=t,this._resultAreaHandler?.addResultAreaToMap(t,this.view.map),this.emit("add-result-area",{graphic:t}))}}async addResultGraphicToView(e,t){const{view:r}=this,{results:i}=e;if(r&&i&&this.utilityNetwork)for(const s in i.aggregatedGeometry)if("line,multipoint,polygon".includes(s)){const a=s,l=i.aggregatedGeometry[a];if(null!=l){l.spatialReference=this.utilityNetwork.spatialReference,e.graphicEnabled=!0;const i=await this._geometryHandler.projectGeometry(l,r.spatialReference),s={globalid:e.trace.globalId};if(null!==i){const e=this.graphicHandler.makeGraphic(i,t.color,s,r.spatialReference);this._getGraphicLayer(J)?.add(e)}}}}addTerminal(e,t){const r=[...this._flags];r.forEach((r=>{r.globalId===t.globalId&&(t.selectedTerminals?.includes(parseInt(e,10))||r.selectedTerminals?.push(parseInt(e,10)))})),this._flags=r}async callTrace(){const e=this.traces.filter((e=>e.selected));return!!e.length&&(this.traceResults.length>0&&this.traceResults.forEach((e=>{this.removeResultGraphicFromView(e)})),this.traceResults=[],this.removeSelection(),await Promise.all(e.map((async(e,t)=>{const r=e,i=new I.default({gdbVersion:this.utilityNetwork?.gdbVersion,moment:this.utilityNetwork?.historicMoment,namedTraceConfigurationGlobalId:r.globalId,outSpatialReference:null,resultTypes:null,traceType:r.traceType,traceLocations:this._flags,traceConfiguration:null});await this.executeTrace(r,this.utilityNetwork?.networkServiceUrl,i).then((e=>{if(e.hasOwnProperty("results")){const r={...e};if(null!==r.results){r.resultArea={...this.resultAreaProperties};const e=[...r.results.elements];r.results.elements.length=0;const i=new Map;for(const t of e)i.has(t.globalId)||(i.set(t.globalId,!0),r.results.elements.push(t));const s=[...this.traceResults];s.splice(t,0,r),this.traceResults=s,null!==r.results&&(this.selectOnComplete&&this.mergeSelection(!0,r.trace),this.showGraphicsOnComplete&&this.addResultGraphicToView(r,r.graphicColor),this.enableResultArea&&this.createResultAreaGraphic(r).then((e=>{e&&(r.resultAreaGraphic=e,r.resultArea?.show&&this.addResultAreaToMap(r,r.resultAreaGraphic))})))}else{const r=[...this.traceResults];r.splice(t,0,e),this.traceResults=r}this._activeProgress=!1}else{this._activeProgress=!1;const r=[...this.traceResults];r.splice(t,0,e),this.traceResults=r}})).catch((e=>{throw this._activeProgress=!1,e}))}))),!0)}cancelAddFlagByHit(){this._sketchViewModel.cancel()}changeResultAreaColor(e,t){if(!e.resultArea)return;e.resultArea.color=t;const r=this._resultAreaHandler?.changeResultAreaColor(e.trace.globalId,t,this.view.map);e.resultAreaGraphic&&(e.resultAreaGraphic.symbol=r)}changeResultGraphicColor(e,t){const r=[...this.traceResults];r.length>0&&r.forEach((r=>{r.trace.globalId===t.trace.globalId&&(r.graphicColor=e,r.graphicEnabled=!0)})),this.traceResults=r,this.removeResultGraphicFromView(t),this.addResultGraphicToView(t,e)}changeFlagSymbol(e,t){this._flags.length>0&&this._flags.forEach((r=>{r.type===e&&t&&r.mapGraphic&&(r.mapGraphic.symbol=t)}))}checkCanTrace(){const e={status:!0,issues:[]},t=this.traces.filter((e=>e.selected));return t.length||(e.status=!1,e.issues.push("noTracesSelected")),this._flags.some((e=>"starting-point"===e.type))||(e.status=!1,e.issues.push("noStartingPoints")),this._flags.filter((e=>null!==e.allTerminals)).some((e=>!e.selectedTerminals.length))&&(e.status=!1,e.issues.push("noTerminalSelected")),e}checkSelectionExist(){return this._highlightHandler.some((e=>e))}clearResult(e){if(!this.view)return;let t=this.traceResults;if(t.length>0){const r=t.filter((t=>t.trace.globalId===e.globalId));r.length>0&&(this.removeResultGraphicFromView(r[0]),this.removeResultAreaFromMap(r[0])),t=t.filter((t=>t.trace.globalId!==e.globalId))}this.traceResults=t,0===t.length?(this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]})):this.mergeSelection(!1,e)}createResultAreaGeometries(e,t,r){if(!this.view||!this.resultAreaProperties)return;let i;if(i="convexhull"===this.resultAreaProperties?.type?1===t.length&&((0,d.isPoint)(t[0])||(0,d.isMultipoint)(t[0])&&1===t[0].points.length)?this._resultAreaHandler?.createBuffer(t,r,e.resultArea?.unit,!0):this._resultAreaHandler?.createConvexHull(t,e.resultArea?.distance,e.resultArea?.unit):this._resultAreaHandler?.createBuffer(t,r,e.resultArea?.unit,!0),!i)return;if(Array.isArray(i)){for(const t of i){const r=this.getResultAreaAttributes(e,t),i=this._resultAreaHandler?.createResultAreaGraphic(t,r,e.resultArea?.areaUnit,this.messages,this.messagesUnits,e.resultArea?.color);if(i)return i}return}const s=this.getResultAreaAttributes(e,i);return this._resultAreaHandler?.createResultAreaGraphic(i,s,e.resultArea?.areaUnit,this.messages,this.messagesUnits,e.resultArea?.color)}async createResultAreaGraphic(e){if(e.results){const t=await this._createResultAreaInputGeometry(e.results);if(t.length>0){const r=Array(t.length).fill(e.resultArea?.distance),i=this.createResultAreaGeometries(e,t,r);return this.emit("create-result-area",{graphic:i}),i}}}executeTrace(e,t,r){const i=this._processFlags(r.traceLocations);return r.traceLocations=i,(0,k.trace)(t,r,{timeout:this._traceTimeout}).then((t=>({trace:e,results:t,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:"success",date:new Date}))).catch((t=>({trace:e,results:null,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:t.message,date:new Date})))}async getNonspatialTraceLocationInitialFeature(){return new Promise(((e,t)=>{this._clickHandler?.remove(),this._clickHandler=this._sketchViewModel.on("create",(async r=>{if("complete"!==r.state)return;const i=this._getGraphicLayer(z);i&&r.graphic&&i.remove(r.graphic);const s=this.view?.toScreen(r.graphic?.geometry);if(!s)return;const a=await(this.view?.hitTest(s));if(a?.results.length){const r=a.results.find((e=>"graphic"===e.type&&this.utilityNetwork?.isUtilityLayer(e.layer)));r?e(r):t(null)}})),this._sketchViewModel.create("point")}))}getResultAreaAttributes(e,t){const{messages:r}=this,i=[],a=[];this._flags.forEach((e=>{const t=e.displayValue?.field+":"+e.displayValue?.value+";"+r.attributeStrings.globalid+":"+e.globalId+";"+r.attributeStrings.terminalid+":"+e.terminalId+";"+r.attributeStrings.x+":"+e.mapPoint?.x+";"+r.attributeStrings.y+":"+e.mapPoint?.y;"starting-point"===e.type?i.push(t):a.push(t)}));const l=this.utilityNetwork?this.utilityNetwork.gdbVersion:this.gdbVersion;return{traceId:e.trace.globalId,traceName:e.trace.title,traceDescription:e.trace.description??"",startingPoints:i.toString(),barriers:a.toString(),version:l??void 0,username:s.id.credentials[0].userId,date:e.date,elementCount:e.results?.elements.length,functionResult:JSON.stringify(e.results?.globalFunctionResults),areaStatistic:t?this._geometryHandler.calculateArea(t,e.resultArea?.areaUnit):0}}getValidSources(){let e=[];const t=this.utilityNetwork?.dataElement?.domainNetworks??[];for(const r of t)e=e.concat(r.junctionSources),e=e.concat(r.edgeSources);return e}groupResultsByNetworkSource(e){return 0===e.length?[]:this._groupBy(e,"networkSourceId")}async loadUtilityNetwork(){const{view:e}=this;if(!e)return null;if(await e.when(),this.utilityNetwork){if(this.utilityNetwork.loaded||await this.utilityNetwork.load(),this.utilityNetwork instanceof v.default){try{const t=e.map;await t.loadAll()}catch(E){if("layer:unsupported-layer-type"!==E.name)throw E}finally{this._loadUNSupportItems()}return this.utilityNetwork}return null}const t=e.map,r=t.utilityNetworks?.at(0);if(r){if(await r.load(),this.utilityNetwork=r,!await async function(e){const t=new g.default({url:e.networkSystemLayers.dirtyAreasLayerUrl});await t.load();const r=t.version;if(Number(r)<=11.1){const t=await(0,w.wI)(e.layerUrl),r=new _.default({url:t});await r.load();const i=r?.user?.username;return!!i&&(0,A.RE)(r,i,"utilityNetwork")}return!0}(r))throw new o.default("utility-network:no-user-type-extension","User type extension not found");try{await t.loadAll()}catch(E){if("layer:unsupported-layer-type"!==E.name)throw E}finally{this._loadUNSupportItems()}return r}return null}manageFilterBarrier(e,t){const r=[...this._flags];r.forEach((r=>{r.globalId===t.globalId&&"barrier"===t.type&&r.id===t.id&&(r.isFilterBarrier=e)})),this._flags=r}mergeSelection(e,t){let r=[];const i=[...this.traceResults],s=t.globalId;i.forEach((t=>{s===t.trace.globalId&&(t.selectionEnabled=e),t.selectionEnabled&&null!==t.results?.elements&&(r=[...r,...t.results?.elements??[]])})),this.selectResults([...new Set(r)])}async queryFeaturesById(e){const{view:t}=this;if(!t||!this.utilityNetwork)return null;const r=this.utilityNetwork.getObjectIdsFromElements(e),i={layerUrl:r[0].layerUrl,objectIds:r[0].objectIds,outFields:["*"]},s=t.map?.allTables.toArray().filter((e=>e?.parsedUrl?.path===r[0].layerUrl)).filter(w.yZ)??[];this._getUniqueMapLayerViews(t).filter((e=>{let{layer:t}=e;return t?.parsedUrl?.path===r[0].layerUrl})).forEach((e=>{let{layer:t}=e;"feature"!==t.type&&"subtype-group"!==t.type||s.push(t)}));const l=(await Promise.all(s.map((async e=>{const r={layers:new a.default([e]),layerInfos:[i],returnGeometry:!0,outSpatialReference:t.spatialReference},[s]=await(0,b.s)(r,!1);return s})))).filter((e=>{let{featureSet:t}=e;return t.features.length>0}));return l.length>0?l:null}queryFlagByHitTest(e,t,r){return this._lookupFlagByHit(e).then((e=>{const{view:i}=this;if(!i)return!1;if(e.length>0){const i=[...this._flags],s=r;return e.forEach((e=>{const r=e.graphic,a=r.attributes.hasOwnProperty("GLOBALID")?r.attributes.GLOBALID:r.attributes.globalid;if(i.filter((e=>e.globalId===a)).length<=0){const e=this.graphicHandler.getFlagGraphic(r.attributes.mapPoint,t,r,s);this._getGraphicLayer(q)?.add(e);const a=this._createFlagProperty(r,t,e);i.push(a)}else if(null!==r.attributes.percentAlong){const e=this.graphicHandler.getFlagGraphic(r.attributes.mapPoint,t,r,s);this._getGraphicLayer(q)?.add(e);const a=this._createFlagProperty(r,t,e);i.push(a)}})),this._flags=i,!0}return!1}))}removeResultGraphicFromView(e){const{view:t}=this;if(!t)return;const r=this._getGraphicLayer(J)?.graphics;e.graphicEnabled=!1;const i=r?.filter((t=>t.attributes[t.attributes.hasOwnProperty("GLOBALID")?"GLOBALID":"globalid"]===e.trace.globalId));i?.forEach((e=>{this._getGraphicLayer(J)?.remove(e)}))}removeFlag(e){const t=this._flags.filter((t=>{if(t.id!==e.id)return t}));this._removeGraphic(e),this._flags=t}removeAllResultAreaGraphics(){this._resultAreaHandler?.removeAllResultAreaGraphics(this.view.map)}removeResultAreaFromMap(e){if(e.resultArea){e.resultArea.show=!1;const t=this._resultAreaHandler?.removeResultArea(e.trace.globalId,this.view?.map);t&&this.emit("remove-result-area",{graphic:t})}}removeSelection(){this._highlightHandler.forEach((e=>{e&&e.remove()})),this._highlightHandler=[]}removeTerminal(e,t){const r=[...this._flags];r.forEach((r=>{if(r.globalId===t.globalId&&t.selectedTerminals?.includes(parseInt(e,10))){const i=t.selectedTerminals.indexOf(parseInt(e,10));r.selectedTerminals?.splice(i,1)}})),this._flags=r}removeFlagsOnLoadWatcher(){this._watchHandler&&null!==this._watchHandler&&this._watchHandler.remove()}removeClickHandler(){this._clickHandler&&(this._sketchViewModel.cancel(),this._clickHandler.remove())}reset(){this._flags=[],this.traceResults=[];const e=[...this.traces];e.forEach((e=>{e.selected=!1})),this.traces=e,this.view&&(this._getGraphicLayer(z)?.removeAll(),this._getGraphicLayer(q)?.removeAll(),this._getGraphicLayer(J)?.removeAll(),this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]}),this.emit("reset"))}selectFeaturesById(e){const{view:t}=this;if(!t||!this.utilityNetwork)return;const r=this.utilityNetwork.getObjectIdsFromElements(e);this._getUniqueMapLayerViews(t).forEach((e=>{(function(e){return"layer"in e})(e)&&e.layer?.parsedUrl?.path===r[0].layerUrl&&function(e){return"feature"===e.layer.type||"subtype-group"===e.layer.type}(e)&&this._highlightHandler.push(e.highlight(r[0].objectIds))}))}selectResults(e){if(e.length>0){this.removeSelection();const t=this.groupResultsByNetworkSource(e),r=[];for(const e in t)this.selectFeaturesById(t[e]),r.push(this.queryFeaturesById(t[e]));Promise.all(r).then((e=>{this.emit("select-features",{resultSet:e})}))}else this.removeSelection(),this.emit("clear-selection",{resultSet:[]})}selectTraces(e,t){const r=[...this.traces];r.forEach((r=>{t===r.globalId&&(r.selected=e)})),this.traces=r}selectTracesOnLoad(){this.utilityNetwork?.hasOwnProperty("sharedNamedTraceConfigurations")&&(this.traces=[...this.utilityNetwork.sharedNamedTraceConfigurations],this.traces.forEach((e=>{e.selected=!1,this.selectedTraces.includes(e.globalId)&&(e.selected=!0)})))}zoomToAsset(e){this.view?.goTo(e).catch((e=>console.error(e)))}async _createResultAreaInputGeometry(e){if(null!=e.aggregatedGeometry)return this._geometryHandler.mergeAggregatedToGeometries(e.aggregatedGeometry);const t=this.groupResultsByNetworkSource(e.elements),r=[];for(const i in t)r.push(this.queryFeaturesById(t[i]));try{const e=await Promise.all(r),t=[];for(const r of e)if(r)for(const e of r)for(const r of e.featureSet.features)r.geometry&&t.push(r.geometry);return t}catch{return[]}}_loadUNSupportItems(){if(!this.utilityNetwork)return;const{map:e}=this.view,{messages:t}=this;this._populateOutfields(),this._createGraphicLayer(z),this._createGraphicLayer(q),this._createGraphicLayer(J),this._resultAreaHandler?.createGraphicLayer(e,t?.alertsStrings.genericResultHeader),this._validUNLayers=this._utilityHelper.getValidUtilityNetworkLayers(e,this.utilityNetwork),this._sketchViewModel=this.graphicHandler.initializeSketch(this.view,this._getGraphicLayer(z),this._validUNLayers)}_getUniqueMapLayerViews(e){const t=[],r=e.layerViews.filter((e=>{let{layer:{type:t}}=e;return"feature"===t||"group"===t||"subtype-group"===t})).toArray(),i=e=>{for(const r of e.layerViews)W(r)?i(r):t.push(r)};return r.forEach((e=>{switch(e.layer.type){case"group":W(e)&&i(e);break;case"subtype-group":t.push(e);break;default:t.some((t=>t.layer.id===e.layer.id))||t.push(e)}})),t}_processFlags(e){const t=[];return e.forEach((e=>{if(null!==e.selectedTerminals&&e.selectedTerminals.length>0)e.selectedTerminals.forEach((r=>{const i=new R.default({globalId:e.globalId,percentAlong:e.percentAlong,terminalId:r,type:e.type,isFilterBarrier:e.isFilterBarrier});t.push(i)}));else{const r=new R.default({globalId:e.globalId,percentAlong:e.percentAlong,type:e.type,isFilterBarrier:e.isFilterBarrier});t.push(r)}})),t}_getDisplayField(e){return"subtype-sublayer"===e?.layer?.type?this._getDisplayFieldBySublayer(e):this._getDisplayFieldByFeatureLayer(e)}_getDisplayFieldBySublayer(e){let t="",r="";const i=e.layer;t=this._checkParentForData(i,"displayField");for(const s in e.attributes){const a=s.toLowerCase();a===t?.toLowerCase()?(r=e.attributes[s],"assetgroup"===a||"assettype"===a?r=this._checkSubtype(i,i.subtypeCode):(r=this._checkDomain(i.fields,s,r),"string"==typeof r&&(r=this._defaultDisplayField(r,i)))):(r=this._checkDomain(i.fields,s,r),"string"==typeof r&&(r=this._defaultDisplayField(r,i)))}return{field:t,value:r.toString()}}_getDisplayFieldByFeatureLayer(e){const t=e.layer;let r=t.displayField,i="";for(const s in e.attributes){const a=s.toLowerCase();if(a===r?.toLowerCase())if(i=e.attributes[s],"assetgroup"===a||"assettype"===a){let a=e.attributes[t.typeIdField.toUpperCase()];a||(a=e.attributes[t.typeIdField.toLowerCase()]),r=t.typeIdField,i=this._checkSubtype(t,a),""===r&&(t.templates&&t.templates.length>0?(r=t.templates[0]?.name,i=t.templates[0]?.name):(r=t.displayField,i=e.attributes[s]))}else i=this._checkDomain(t.fields,s,i),"string"==typeof i&&(i=this._defaultDisplayField(i,t));else i=this._checkDomain(t.fields,s,i),"string"==typeof i&&(i=this._defaultDisplayField(i,t))}return{field:r,value:i?i.toString():""}}_checkSubtype(e,t){let r=t;if("subtype-sublayer"===e.type){const i=this._checkParentForData(e,"subtypes");i?.length>0&&i.forEach((e=>{e.code===t&&(r=e.name)}))}else if(null!=e.types&&e.types.length>0){const i=e.types.filter((e=>e.id===t));i.length>0&&(r=i[0].name)}return r}_checkDomain(e,t,r){let i=r;const s=e.filter((e=>e.name.toLowerCase()===t.toLowerCase()));if(s.length>0&&function(e){return e instanceof m.default}(s[0].domain)&&s[0].domain?.codedValues){const e=s[0].domain.codedValues.filter((e=>{let{code:t}=e;return t===r}));e.length>0&&(i=e[0].name)}return i}_checkParentForData(e,t){return e.parent?.[t]??null}_defaultDisplayField(e,t){return e.trim()?e:t.templates&&t.templates?.length>0?t.templates[0].name:t.title}get _uniqueFlagId(){return this._flagId++}_groupBy(e,t){return e.reduce(((e,r)=>((e[r[t]]=e[r[t]]||[]).push(r),e)),{})}async _lookupFlagByHit(e){const t=e.graphic?.geometry,r=[];if(t&&(0,d.isPoint)(t)&&this.view){const i=this.view.toScreen(t);if(i){const t=await this.view.hitTest(i,{include:this._validUNLayers});if(t?.results.length){const i=t.results.find((e=>null!==e.layer));if(i.graphic?.geometry)if("polyline"===i.graphic.geometry.type){const t={terminalId:null,isFilterBarrier:!1,allTerminals:null,selectedTerminals:null,percentAlong:this._geometryHandler.getPercentageAlong(i.graphic.geometry,e.graphic?.geometry,i.graphic.geometry.spatialReference),displayValue:this._getDisplayField(i.graphic),mapPoint:i.mapPoint};i.graphic.attributes={...i.graphic.attributes,...t},r.push(i)}else if(("point"===i.graphic.geometry.type||"polygon"===i.graphic.geometry.type)&&this.utilityNetwork){const e=this.utilityNetwork.getTerminalConfiguration(i.graphic),t=this._getDisplayField(i.graphic),s={terminalId:e?e.terminals[0].id||null:1,isFilterBarrier:!1,allTerminals:e??null,selectedTerminals:[e?e.terminals[0].id||null:1],percentAlong:null,displayValue:t,mapPoint:i.mapPoint};i.graphic.attributes={...i.graphic.attributes,...s},r.push(i)}}}}return r}_createFlagProperty(e,t,r){const i=new R.default;i.terminalId=e.attributes.terminalId,i.isFilterBarrier=e.attributes.isFilterBarrier,i.percentAlong=e.attributes.percentAlong,i.globalId=e.attributes.globalid||e.attributes.GLOBALID,i.type=t;const s=i;return s.details=e,s.mapGraphic=r,s.id=this._uniqueFlagId,s.allTerminals=e.attributes.allTerminals,s.selectedTerminals=e.attributes.selectedTerminals,s.displayValue=e.attributes.displayValue,s.mapPoint=e.attributes.mapPoint,s}async _populateOutfields(){if(!this.view)return;const{map:e}=this.view,t=this.getValidSources(),r=e=>{"group"===e.type?e.layers.forEach((e=>{$(e)&&r(e)})):t.some((t=>t.layerId===e.layerId))&&e.fields.some((e=>"assetgroup"===e.name.toLowerCase()))&&(e.outFields=["assetgroup","assettype","globalid","objectid"])};for(const i of e.layers)$(i)&&r(i)}_removeGraphic(e){this._getGraphicLayer(q)?.remove(e.mapGraphic)}_createGraphicLayer(e){const{map:t}=this.view;if(!t.findLayerById(e)){const t=new f.default({id:e,internal:!0,listMode:"hide",title:e});(0,G.Y)(this.view,t)}}_getGraphicLayer(e){const{map:t}=this.view;if(t){const r=t.findLayerById(e);if(r&&function(e){return"graphics"===e.type}(r))return r}return null}};(0,i._)([(0,h.MZ)()],K.prototype,"_activeProgress",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"_flags",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"traces",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"defaultGraphicColor",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"enableResultArea",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"flags",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"gdbVersion",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"messages",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"messagesUnits",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"resultAreaProperties",null),(0,i._)([(0,h.MZ)()],K.prototype,"selectedTraces",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"selectOnComplete",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"showGraphicsOnComplete",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"showSelectionAttributes",void 0),(0,i._)([(0,h.MZ)({readOnly:!0})],K.prototype,"state",null),(0,i._)([(0,h.MZ)()],K.prototype,"traceResults",void 0),(0,i._)([(0,h.MZ)()],K.prototype,"utilityNetwork",void 0),(0,i._)([(0,h.MZ)({value:null})],K.prototype,"view",null),K=(0,i._)([(0,p.$)("esri.widgets.UtilityNetworkTrace.UtilityNetworkTraceViewModel")],K);const Y=K},40998:(e,t,r)=>{r.r(t),r.d(t,{submitTraceJob:()=>o,trace:()=>l});var i=r(3825),s=r(54994),a=r(74819);async function l(e,t,r){const l=(0,s.Dl)(e),o=t.toJSON();o.traceLocations=JSON.stringify(t.traceLocations),t.resultTypes&&(o.resultTypes=JSON.stringify(t.resultTypes));const n=(0,s.jV)(l.query,{query:(0,s.lF)({...o,f:"json"}),...r}),c=`${l.path}/trace`;return(0,i.default)(c,n).then((e=>function(e){const{data:t}=e;return a.default.fromJSON(t.traceResults)}(e)))}async function o(e,t,r){const a=(0,s.Dl)(e),l=t.toJSON();l.traceLocations=JSON.stringify(t.traceLocations),t.resultTypes&&(l.resultTypes=JSON.stringify(t.resultTypes));const o=(0,s.jV)(a.query,{query:(0,s.lF)({...l,async:!0,f:"json"}),...r}),n=`${a.path}/trace`,{data:c}=await(0,i.default)(n,o);return c.statusUrl}},63733:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var i=r(35143),s=r(46053),a=(r(81806),r(76460),r(47249),r(85842)),l=r(5364),o=r(25515),n=r(65624),c=r(5682),u=r(64519),h=r(731);let p=class extends((0,n.dM)((0,c.j)(o.default))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new u.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,i._)([(0,s.MZ)({type:h.A})],p.prototype,"elevationInfo",void 0),(0,i._)([(0,s.MZ)((0,l.C)(u.Y,"graphics"))],p.prototype,"graphics",void 0),(0,i._)([(0,s.MZ)({type:["show","hide"]})],p.prototype,"listMode",void 0),(0,i._)([(0,s.MZ)()],p.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],p.prototype,"type",void 0),(0,i._)([(0,s.MZ)({constructOnly:!0})],p.prototype,"internal",void 0),p=(0,i._)([(0,a.$)("esri.layers.GraphicsLayer")],p);const d=p},64826:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var i,s=r(35143),a=r(42553),l=r(46053),o=r(40565),n=(r(81806),r(47249),r(85842)),c=r(17707),u=r(13312),h=r(12899),p=r(64154),d=r(91329);let y=i=class extends a.A{static from(e){return(0,o.PZ)(i,e)}constructor(e){super(e),this.namedTraceConfigurationGlobalId=null,this.gdbVersion=null,this.traceLocations=[],this.moment=null,this.outSpatialReference=null,this.traceConfiguration=null,this.resultTypes=null,this.traceType=null}writeOutSR(e,t,r){if(null!=e){const{wkid:i,latestWkid:s,wkt:a,wkt2:l}=e;t[r]=JSON.stringify({wkid:i??void 0,latestWkid:s??void 0,wkt:a??void 0,wkt2:l??void 0})}}};(0,s._)([(0,l.MZ)({type:String,json:{read:{source:"traceConfigurationGlobalId"},write:{target:"traceConfigurationGlobalId"}}})],y.prototype,"namedTraceConfigurationGlobalId",void 0),(0,s._)([(0,l.MZ)({type:String,json:{write:!0}})],y.prototype,"gdbVersion",void 0),(0,s._)([(0,l.MZ)({type:[d.default],json:{write:!0}})],y.prototype,"traceLocations",void 0),(0,s._)([(0,l.MZ)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],y.prototype,"moment",void 0),(0,s._)([(0,l.MZ)({type:u.default,json:{write:{allowNull:!0,target:"outSR"}}})],y.prototype,"outSpatialReference",void 0),(0,s._)([(0,c.K)("outSpatialReference")],y.prototype,"writeOutSR",null),(0,s._)([(0,l.MZ)({type:p.default,json:{write:!0}})],y.prototype,"traceConfiguration",void 0),(0,s._)([(0,l.MZ)({type:[Object],json:{write:!0}})],y.prototype,"resultTypes",void 0),(0,s._)([(0,l.MZ)({type:h.fO.apiValues,json:{type:h.fO.jsonValues,read:h.fO.read,write:h.fO.write}})],y.prototype,"traceType",void 0),y=i=(0,s._)([(0,n.$)("esri.rest.networks.support.TraceParameters")],y);const g=y},89646:(e,t,r)=>{r.d(t,{$h:()=>g,Ef:()=>R,IP:()=>m,P1:()=>_,hF:()=>k,jQ:()=>b,rT:()=>A,rZ:()=>i,uR:()=>w});var i,s,a=r(73582),l=r(24648),o=r(31633),n=r(19555),c=r(72745),u=r(20664),h=r(9392),p=r(14487),d=r(7137),y=r(80963);function g(e,t){if(null==e||null==t)return;const r=f(e,t);return null!=r?(0,l.Wq)(r,"radians","geographic"):void 0}(s=i||(i={})).Absolute="absolute",s.Relative="relative",s.RelativeBilateral="relative-bilateral";const f=(()=>{const e=(0,h.vt)(),t=(0,h.vt)();return(r,i)=>((0,u.i)(e,r.x,r.y,r.z??0),(0,u.i)(t,i.x,i.y,i.z??0),m(e,t,r.spatialReference,i.spatialReference))})(),m=(()=>{const e=(0,c.vt)(),t=(0,h.vt)(),r=(0,h.vt)();return(i,s,a,l)=>{if((0,u.p)(i,s))return;const h=(0,d.geodesicCompatibleSpatialReference)(a),g=(0,d.geodesicCompatibleSpatialReference)(l);if(h&&g&&(0,y.aI)(h,g)&&(0,p.F)(i,a,t,h)&&(0,p.F)(s,l,r,g)){const{azimuth:e}=(0,d.inverseGeodeticSolver)(G,t,r,h);return null!=e?(0,o.oU)(e,"degrees","radians"):void 0}e[0]=s[0]-i[0],e[1]=s[1]-i[1];let f=(0,n.g7)(c.JP,e);return e[0]<0&&(f=S-f),f}})();function w(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.Absolute;if(t&&r)switch(s){case i.Absolute:return g(t,r);case i.Relative:return b(v(e,t,r),i.Relative);case i.RelativeBilateral:return b(v(e,t,r),i.RelativeBilateral)}}function v(e,t,r){if(!e||!t||!r)return;const i=f(e,t),s=f(t,r);return null!=i&&null!=s?(0,l.Wq)(s-i,"radians","geographic"):void 0}function b(e,t){if(null!=e)switch(t){case i.Absolute:return _(e);case i.Relative:{const t=k(e);let r=T.normalize(t,0,!0);return-180===r&&(r=180),(0,l.Wq)(r,"degrees","geographic")}case i.RelativeBilateral:{const t=k(e),r=Math.abs(T.normalize(t,0,!0));return(0,l.Wq)(r,"degrees","geographic")}}}function _(e){const t=k(e),r=L.normalize(t,0,!0);return(0,l.Wq)(r,"degrees","geographic")}const A=(()=>{const e=(0,h.vt)();return function(t,r,i,s,a){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"geodesic";(0,u.c)(e,r);const c=k(a);if("geodesic"===n){const a=(0,d.geodesicCompatibleSpatialReference)(i);if(a&&(0,p.F)(e,i,e,a))return(0,d.directGeodeticSolver)(t,e,c,s,a),t[2]=r[2],!!(0,p.F)(t,a,t,i)}const h=(0,l.g2)(c,"geographic","arithmetic"),y=(0,o.oU)(h,"degrees","radians"),g=r[0]+s*Math.cos(y),f=r[1]+s*Math.sin(y),m=r[2];return(0,u.i)(t,g,f,m),!0}})();function k(e){if(null!=e)return(0,l.g2)(I(e),e.rotationType,"geographic")}function R(e){if(null!=e)return(0,l.g2)(I(e),e.rotationType,"arithmetic")}function I(e){return(0,o.oU)(e.value,e.unit,"degrees")}const G=new d.InverseGeodeticSolverResult,S=2*Math.PI,L=a.ie,T=new a.hr(-180,180)},91329:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var i=r(35143),s=r(45802),a=r(42553),l=r(46053),o=(r(81806),r(76460),r(47249),r(85842));const n=new s.J({startingPoint:"starting-point",barrier:"barrier"});let c=class extends a.A{constructor(e){super(e),this.globalId=null,this.isFilterBarrier=!1,this.percentAlong=null,this.terminalId=null,this.type=null}};(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],c.prototype,"globalId",void 0),(0,i._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],c.prototype,"isFilterBarrier",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],c.prototype,"percentAlong",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],c.prototype,"terminalId",void 0),(0,i._)([(0,l.MZ)({type:n.apiValues,json:{type:n.jsonValues,read:{reader:n.read,source:"traceLocationType"},write:{writer:n.write,target:"traceLocationType"}}})],c.prototype,"type",void 0),c=(0,i._)([(0,o.$)("esri.rest.networks.support.TraceLocation")],c);const u=c},94560:(e,t,r)=>{r.d(t,{K9:()=>d,KM:()=>p,XU:()=>h,pC:()=>y});var i=r(39356),s=r(19276),a=r(86875),l=r(38996),o=r(76940),n=r(3589),c=r(83973),u=r(81257);const h=[227,27,21,.6],p=[21,244,21,.6],d=[{color:[255,0,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff0000"},{color:[255,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff00ff"},{color:[217,188,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#D9BCFF"},{color:[0,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#00ff00"},{color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ffff00"},{color:[0,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#0000ff"},{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},{color:[0,0,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#000000"}];class y{constructor(){this.highlightColor=[...d]}addCustomColor(e){this.highlightColor=[...d],this.highlightColor.some((t=>t.hex.toLowerCase()===e.hex.toLowerCase()))||this.highlightColor.push(e)}getFlagGraphic(e,t,r,i){const s="starting-point"===t?p:h;if("polygon"===e.type){const t=e;t.centroid&&(e=t.centroid)}return i?this.makeGraphic(e,s,r?.attributes,null,i):this.makeGraphic(e,s,r?.attributes)}initializeSketch(e,t,r){const i=new s.default;return r.forEach((e=>i.add(new n.default({layer:e,enabled:!0})))),new u.default({layer:t,view:e,snappingOptions:new c.default({enabled:!0,featureEnabled:!0,featureSources:i})})}makeGraphic(e,t,r,s,n){let c,u=e;switch(e.type){case"multipoint":c=new o.default({color:t,size:12,outline:{color:t,width:0}}),s&&(u=e);break;case"point":c=n||new o.default({color:t,size:12,outline:{color:t,width:0}}),s&&(u=e);break;case"polyline":c=new l.default({color:t,width:12}),s&&(u=e);break;case"polygon":c=new a.default({color:t,outline:{color:t,width:12}}),s&&(u=e)}return new i.default({geometry:u,symbol:c,attributes:r??null})}}},95327:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var i=r(35143),s=r(91967),a=r(46053),l=(r(81806),r(76460),r(47249),r(85842));let o=class extends s.default{constructor(e){super(e),this.enabled=!1}};(0,i._)([(0,a.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"enabled",void 0),o=(0,i._)([(0,l.$)("esri.views.interactive.sketch.SketchLabelOptions")],o);const n=o},96422:(e,t,r)=>{r.d(t,{Kw:()=>a,RE:()=>o,Sl:()=>l});var i=r(55171),s=r(3825);async function a(e,t,r){const a=i.id?.findCredential(e.restUrl);if(!a)return null;if("loaded"===e.loadStatus&&""===t&&e.user?.sourceJSON&&!1===r)return e.user.sourceJSON;const l={responseType:"json",query:{f:"json"}};if(r&&(l.query.returnUserLicenseTypeExtensions=!0),""===t){const t=await(0,s.default)(e.restUrl+"/community/self",l);if(t.data){const e=t.data;if(e?.username)return e}return null}const o=await(0,s.default)(e.restUrl+"/community/users/"+t,l);if(o.data){const e=o.data;return e.error?null:e}return null}async function l(e,t,r){const i=await a(e,t,!0);return i?.privileges?.includes(r)??!1}async function o(e,t,r){const i=await a(e,t,!0);return i?.userLicenseTypeExtensions?.includes(r)??!1}}}]);
//# sourceMappingURL=26417.b2209196.chunk.js.map