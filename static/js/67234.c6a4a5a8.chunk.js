"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[63733,67234],{53181:(e,t,i)=>{i.d(t,{J:()=>M});var n=i(39356),r=i(54901),a=i(76931),o=i(40565),s=i(19555),l=i(72745),p=i(9392),c=i(19247),h=i(23701),d=i(13312),y=i(89465),u=i(38996),m=i(76940),g=i(28808),_=i(23862),v=i(63078),f=i(14727);class M extends f.b{constructor(e){super(),this._graphicsLayer=e,this._symbolPairingsByType=new Map}visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator(new c.default({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("intersectionPoint",t.view.effectiveTheme.accentColor))}visualizePoint(e,t){return this._visualizeSnappingIndicator(new c.default({x:e.point[0],y:e.point[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("point",t.view.effectiveTheme.accentColor))}visualizeLine(e,t){return this._visualizeSnappingIndicator(new h.default({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:(0,o.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol("line",t.view.effectiveTheme.accentColor))}visualizeParallelSign(e,t){return this._visualizeSnappingIndicator(new h.default({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:(0,o.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol("parallelSign",t.view.effectiveTheme.accentColor))}visualizeRightAngleQuad(e,t){const i=(0,l.vt)(),n=(0,l.vt)(),r=(0,p.vt)();(0,s.Re)(i,(0,_.Xz)(e.centerVertex),(0,_.Xz)(e.previousVertex)),(0,s.Re)(n,(0,_.Xz)(e.nextVertex),(0,_.Xz)(e.previousVertex)),(0,s.$A)(r,i,n);const a="rightAngleQuad"+(r[2]<0?45:225);return this._visualizeSnappingIndicator(new h.default({paths:[[[...e.previousVertex],[...e.centerVertex],[...e.nextVertex]]],spatialReference:(0,o.PZ)(d.default,t.spatialReference)}),this._getOrCreateSymbol(a,t.view.effectiveTheme.accentColor))}_visualizeSnappingIndicator(e,t){const i=new n.default({geometry:e,symbol:t});return this._graphicsLayer.add(i),(0,r.hA)((()=>{this._graphicsLayer.remove(i)}))}_getOrCreateSymbol(e,t){const i=this._symbolPairingsByType;return i.get(e)?.color!==t&&i.set(e,{color:t,symbol:x(e,t)}),i.get(e).symbol}}function x(e,t){const i=[...t.toRgb(),255*t.a];switch(e){case"point":return new m.default({outline:{width:.5,color:[0,0,0,1]},size:10,color:t});case"intersectionPoint":return new m.default({outline:new u.default({width:1.5,color:t}),size:15,color:[0,0,0,0]});case"line":return new y.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:g.uT.Butt,joinStyle:g.wd.Round,miterLimit:10,width:(0,a.PN)(v.N.lineHintWidthTarget),color:i}]}}});case"parallelSign":return new y.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});case"rightAngleQuad45":case"rightAngleQuad225":{const n="rightAngleQuad45"===e?45:225;return new y.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:(0,a.PN)(v.N.rightAngleHintSize),rotation:n,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:(0,a.PN)(v.N.rightAngleHintOutlineSize),color:i},{type:"CIMSolidFill",enable:!0,color:[...t.toRgb(),255*t.a*.4]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}})}}}},63733:(e,t,i)=>{i.r(t),i.d(t,{default:()=>y});var n=i(35143),r=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),o=i(5364),s=i(25515),l=i(65624),p=i(5682),c=i(64519),h=i(731);let d=class extends((0,l.dM)((0,p.j)(s.default))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new c.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,n._)([(0,r.MZ)({type:h.A})],d.prototype,"elevationInfo",void 0),(0,n._)([(0,r.MZ)((0,o.C)(c.Y,"graphics"))],d.prototype,"graphics",void 0),(0,n._)([(0,r.MZ)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,n._)([(0,r.MZ)()],d.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],d.prototype,"type",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],d.prototype,"internal",void 0),d=(0,n._)([(0,a.$)("esri.layers.GraphicsLayer")],d);const y=d},67234:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var n,r=i(35143),a=i(54099),o=i(53084),s=i(30726),l=i(50346),p=i(76931),c=i(46053),h=(i(81806),i(76460),i(85842)),d=i(63733),y=i(18117),u=i(64465),m=i(53181),g=i(89238),_=i(974),v=i(59833),f=i(13284),M=i(14318);let x=n=class extends a.A.EventedAccessor{constructor(e){super(e),this._hasZ=null,this._cursorScreenPoint=null,this._activePointerId=null,this._stagedVertexUnsnapped=null,this._lastVertexUnsnapped=null,this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0,this._coordinateHelper=(0,g.BV)(!!e.hasZ,!1,e.view.spatialReference),this._snappingManager=e.snappingManager,this._editGeometryOperations=new v.p(new _.ZE(e.editGeometryType??"polygon",this._coordinateHelper),u.RT.Local),this._snappingGraphicsLayer=new d.default({id:n.SNAPPING_GRAPHICS_LAYER_ID,listMode:"hide",internal:!0}),this._snappingContext=new f.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new m.J(this._snappingGraphicsLayer)}),this._activeComponent=new _.uA(e.view.spatialReference,u.RT.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}normalizeCtorArgs(e){const t={...e};return delete t.editGeometryType,delete t.snappingManager,t}initialize(){this._snappingOperation=new M.O({view:this.view}),"2d"===this.view.type&&this.view.map.layers.add(this._snappingGraphicsLayer)}destroy(){this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy(),null!=this._snappingManager&&this._snappingManager.doneSnapping(),this._snappingOperation=(0,s.pR)(this._snappingOperation),this._editGeometryOperations.destroy()}get _committedVertices(){return this._editGeometryOperations.data.components[0].vertices.map((e=>e.pos))}get vertices(){return null!=this._stagedVertex?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:this._committedVertices}get hasZ(){return null!=this._hasZ?this._hasZ:"3d"===this.view.type}set hasZ(e){this._hasZ=e,this.notifyChange("hasZ")}get _stagedVertex(){return this._snappingOperation?.stagedPoint}set _stagedVertex(e){this._snappingOperation&&(this._snappingOperation.stagedPoint=(0,o.clone)(e))}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this.canUndo&&this._editGeometryOperations.undo()}redo(){this.canRedo&&this._editGeometryOperations.redo()}getCoordsFromScreenPoint(e){const t=e&&this.screenToMap(e);return null==t?null:t.hasZ?[t.x,t.y,t.z]:[t.x,t.y]}getCoordsAndPointFromScreenPoint(e){const t=this.screenToMap(e);return null==t?null:t.hasZ?{vertex:[t.x,t.y,t.z],mapPoint:t}:{vertex:[t.x,t.y],mapPoint:t}}screenToMap(e){let t=null;if("3d"===this.view.type)if(this.hasZ){const i=this.elevationInfo??P;t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,p.gs)(e.x,e.y),i,this._getGeometryZValue())}else{const i=this.elevationInfo??b;t=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,p.gs)(e.x,e.y),i,0),null!=t&&(t.z=void 0)}else t=this.view.toMap(e),null!=t&&(t.z=this.hasZ?this._getGeometryZValue():void 0);return t}_pushCursorVertex(e,t){const i=(0,y.T)(e[0],e[1],void 0,this.view.spatialReference);this._stagedVertexUnsnapped=i;const n=this._snappingManager;if(null==n)return this._stagedVertex=i,void t();(0,l.ignoreAbortErrors)(this._snappingOperation.snap({point:i},n,this._snappingContext)).then((()=>{t()}))}_popCursorVertex(){this._stagedVertexUnsnapped=null,this._stagedVertex=null}_getGeometryZValue(){return this.defaultZ}_abortSnapping(){this._snappingOperation.abort()}_isDuplicateOfLastVertex(e){const t=this._editGeometryOperations.data.components[0].getLastVertex()?.pos;if(t&&e[0]===t[0]&&e[1]===t[1])return!0;const{x:i,y:n}=this._coordinateHelper.vectorToDehydratedPoint(e);return null!=this._lastVertexUnsnapped&&i===this._lastVertexUnsnapped.x&&n===this._lastVertexUnsnapped.y}_shouldHandlePointerEvent(e){return function(e){return"mouse"!==e.pointerType||0===e.button}(e)&&(null==this._activePointerId||this._activePointerId===e.pointerId)}_vertexAddHandler(e){const t=null!=this._stagedVertex?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);null!=t&&this._addVertex(t,e.native)}_drawCompleteHandler(e){this._completeDrawing(e.native)}};x.SNAPPING_GRAPHICS_LAYER_ID="DrawAction-snapping-graphics-layer",(0,r._)([(0,c.MZ)({readOnly:!0})],x.prototype,"vertices",null),(0,r._)([(0,c.MZ)({type:Boolean,nonNullable:!0})],x.prototype,"interactiveUndoDisabled",void 0),(0,r._)([(0,c.MZ)({readOnly:!0})],x.prototype,"history",void 0),(0,r._)([(0,c.MZ)({readOnly:!0})],x.prototype,"redoHistory",void 0),(0,r._)([(0,c.MZ)()],x.prototype,"snapToScene",void 0),(0,r._)([(0,c.MZ)()],x.prototype,"view",void 0),(0,r._)([(0,c.MZ)()],x.prototype,"elevationInfo",void 0),(0,r._)([(0,c.MZ)({nonNullable:!0})],x.prototype,"defaultZ",void 0),(0,r._)([(0,c.MZ)()],x.prototype,"hasZ",null),(0,r._)([(0,c.MZ)()],x.prototype,"_snappingOperation",void 0),(0,r._)([(0,c.MZ)()],x.prototype,"_stagedVertex",null),x=n=(0,r._)([(0,h.$)("esri.views.draw.DrawAction")],x);const P={mode:"absolute-height",offset:0},b={mode:"on-the-ground",offset:0};const S=x}}]);
//# sourceMappingURL=67234.c6a4a5a8.chunk.js.map