{"version":3,"file":"static/js/15208.84e8443c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/widgets/OrientedImageryViewer/adapters/view/MapViewAdapter.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Graphic.js\";import{isSome as t}from\"../../../../core/arrayUtils.js\";import i from\"../../../../core/Logger.js\";import{waitTick as o,throwIfAborted as r,isAbortError as a}from\"../../../../core/promiseUtils.js\";import s from\"../../../../geometry/Polygon.js\";import{convertOrientationToPixelLocation as n}from\"../../../../layers/orientedImagery/transformations/utils.js\";import{activePolygonSymbol as l,polygonSymbol as c}from\"../../symbols.js\";class m{constructor(m){this.viewModel=m,this.createFootprints=async t=>{await o(t);const{coveragePolygons:i,currentBestFeature:r,isAdditionalCoverageVisible:a}=this.viewModel;for(const o of i)o?.imageID===r.attributes.objectId?this.viewModel.bestFeatureFootprint=new e({attributes:{imageID:o?.imageID},geometry:o,symbol:l,visible:!1}):this.viewModel.additionalFootprints.push(new e({attributes:{imageID:o?.imageID},geometry:o,symbol:c.clone(),visible:a}))},this.updateFootprint=async(o,n)=>{const{activeViewer:c,currentBestFeature:m,currentCoverageVisible:u,footprintExtent:g}=this.viewModel,p=c?.imageSize;if(m&&p&&g)try{const i=await this.viewModel.getMapPoint(o,{feature:m,mode:\"default\",imageSize:p});r(n);const a=i.filter(t);if(!a.length)return;const c=[a.map((({x:e,y:t})=>[e,t,1]))];c[0].push(c[0][0]);const g=new s({rings:c,spatialReference:a[0].spatialReference});this.viewModel.updateCurrentCoveragePolygon(new e({geometry:g,attributes:{imageID:m.attributes.objectId},symbol:l,visible:u}))}catch(d){a(d)||i.getLogger(this.viewModel).error(\"update-footprint\",d)}else this.viewModel.updateCurrentCoveragePolygon(null)},this.updateFootprintPanorama=async(t,i)=>{const{horizontalFieldOfView:o,pitch:a,verticalFieldOfView:c,yaw:m}=t,{activeViewer:u,currentBestFeature:g,currentCoverageVisible:p,footprintExtent:d}=this.viewModel,f=u?.imageSize;if(!g||!f||!d)return void this.viewModel.updateCurrentCoveragePolygon(null);const{cameraPitch:v,objectId:h}=g.attributes;if(a+v-c/2>180)return void this.viewModel.updateCurrentCoveragePolygon(null);let w=[];if(a+v+c/2<180){w=[[-o/2,c/2],[o/2,c/2],...a-c/2<0?[[-o/2,-c/2],[o/2,-c/2]]:[[o/2,-c/2],[-o/2,-c/2]]]}else if(a+v-c/2<180&&a+v+c/2>180){w=[[-o/2,-c/2]];const e=Math.floor(o/6),t=o/e;for(let i=0;i<=e;i++)w.push([i*t-o/2,90-a]);w.push([o/2,-c/2]);a-c/2<0&&([w[0],w[w.length-1]]=[w[w.length-1],w[0]])}const y=w.map((([e,t])=>n(m+e,a+t,f[0],f[1]))),b=await this.viewModel.getMapPoint(y,{feature:g,mode:\"panorama\",imageSize:f});r(i);const M=[b.map((({x:e,y:t})=>[e,t,1]))];M[0].push(M[0][0]);const C=new s({rings:M,spatialReference:b[0].spatialReference});this.viewModel.updateCurrentCoveragePolygon(new e({geometry:C,attributes:{imageID:h},symbol:l.clone(),visible:p}))}}}export{m as default};\n"],"names":["m","constructor","this","viewModel","createFootprints","async","o","t","coveragePolygons","i","currentBestFeature","r","isAdditionalCoverageVisible","a","imageID","attributes","objectId","bestFeatureFootprint","e","geometry","symbol","l","visible","additionalFootprints","push","c","clone","updateFootprint","n","activeViewer","currentCoverageVisible","u","footprintExtent","g","p","imageSize","getMapPoint","feature","mode","filter","length","map","_ref","x","y","s","rings","spatialReference","updateCurrentCoveragePolygon","d","getLogger","error","updateFootprintPanorama","horizontalFieldOfView","pitch","verticalFieldOfView","yaw","f","cameraPitch","v","h","w","Math","floor","_ref2","b","M","_ref3","C"],"sourceRoot":""}