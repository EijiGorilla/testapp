"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[60831],{60831:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var n=i(35143),s=i(91967),r=i(76931),a=i(31633),c=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),l=i(19247),u=i(23701),d=i(13312),p=i(7137),h=i(73953),m=i(80963),w=i(45417),f=i(47818);function g(e){let{state:{paddedViewState:t},spatialReference:i,width:n}=e;return i.isWrappable&&t.worldScreenWidth<n}function v(e,t){const{x:i,y:n}=e?(0,w.webMercatorToGeographic)(t,!0):t;return[i,n]}let S=class extends s.default{constructor(e){super(e),this.scaleComputedFrom=(0,r.tc)(),this.view=null}get state(){return this.view?.ready&&"2d"===this.view.type?(0,f.O)(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(e,t){if("disabled"===this.state||isNaN(e)||!t||!this.view)return null;const i=this._getDistanceInMeters();return null==i?null:this._getScaleBarProps(e,i,t)}_getDistanceInMeters(){const{state:e,spatialReference:t}=this.view;if(!(0,m.fn)(t))return null;const{isGeographic:i}=t,n=function(e){const{isWebMercator:t,wkt:i,wkt2:n}=e;return t||((n||i)?.includes("WGS_1984_Web_Mercator")??!1)}(t);if(!i&&!n)return e.extent.width*((0,a.Ao)(t)??1);const[s,r]=this._getScaleMeasuringPoints(),c=n||i&&!(0,p.isSupported)(t)?d.default.WGS84:t,o=new u.default({paths:[[v(n,s),v(n,r)]],spatialReference:c}),l=(0,h.straightLineDensify)(o,10);let w;try{[w]=(0,p.geodesicLengths)([l],"meters")}catch{return null}return w}_getScaleMeasuringPoints(){const e=this.view,{width:t,height:i,position:n,spatialReference:s}=e;if(g(e)){const e=(0,m.Vp)(s),{valid:t}=e;return[new l.default(t[0],0,s),new l.default(t[1],0,s)]}let a=this.scaleComputedFrom.y-n[1];a>i?a=i:a<0&&(a=0);const c=(0,r.tc)(0,a),o=(0,r.tc)(t,a);return[e.toMap(c),e.toMap(o)]}_getScaleBarProps(e,t,i){const n=this.view,s=e*t/(g(n)?n.state.paddedViewState.worldScreenWidth:n.width);if(s<.001)return null;const r=function(e,t){switch(t){case"metric":return e>1e3?{distance:(0,a.oU)(e,"meters","kilometers"),unit:"kilometer"}:e>1?{distance:e,unit:"meter"}:e>.01?{distance:(0,a.oU)(e,"meters","centimeters"),unit:"centimeter"}:{distance:(0,a.oU)(e,"meters","millimeters"),unit:"millimeter"};case"imperial":return e>1609.344?{distance:(0,a.oU)(e,"meters","miles"),unit:"mile"}:e>.3048?{distance:(0,a.oU)(e,"meters","feet"),unit:"foot"}:{distance:(0,a.oU)(e,"meters","inches"),unit:"inch"}}}(s,i),{distance:c,unit:o}=r;let l=c,u=0;for(;l>=1;)l/=10,u++;const{min:d,max:p}=function(e){return e>.5?{min:.5,max:1}:e>.2?{min:.2,max:.5}:{min:.1,max:.2}}(l),h=p/l>=l/d?d:p;return{length:e*(h/l),value:10**u*h,unit:o}}};(0,n._)([(0,c.MZ)()],S.prototype,"scaleComputedFrom",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],S.prototype,"state",null),(0,n._)([(0,c.MZ)()],S.prototype,"view",void 0),S=(0,n._)([(0,o.$)("esri.widgets.ScaleBar.ScaleBarViewModel")],S);const M=S}}]);
//# sourceMappingURL=60831.73ad6d40.chunk.js.map