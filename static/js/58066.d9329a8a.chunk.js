"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[58066,71257],{9003:(e,t,l)=>{l.d(t,{BR:()=>o,mH:()=>i});var n=l(50912);const i=e=>s(e)||a(e),s=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":case"subtype-sublayer":return!0;default:return!1}},a=e=>{const t=(0,n.oZ)(e);if(null!=t&&e.hasOwnProperty(t)&&null!=e[t])for(const l of e[t])if(i(l))return!0;return!1},o=(e,t)=>null!=t&&null!=e&&(t.test(e.title)?"self":!!e.children.some((e=>!1!==o(e,t)))&&"children")},10286:(e,t,l)=>{l.d(t,{A:()=>r});var n=l(35143),i=l(91967),s=l(46053),a=(l(81806),l(76460),l(47249),l(85842));let o=class extends i.default{constructor(e){super(e),this.colorSelection=!0,this.dynamicScaleToggle=!0,this.gridEnabledToggle=!0,this.numericInputs=!0,this.gridSnapEnabledToggle=!0,this.lineIntervalInput=!0,this.outOfScaleWarning=!0,this.placementButtons=!0,this.rotateWithMapToggle=!0}};(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"colorSelection",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"dynamicScaleToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"gridEnabledToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"numericInputs",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"gridSnapEnabledToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"lineIntervalInput",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"outOfScaleWarning",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"placementButtons",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"rotateWithMapToggle",void 0),o=(0,n._)([(0,a.$)("esri.widgets.support.GridControls.VisibleElements")],o);const r=o},58066:(e,t,l)=>{l.r(t),l.d(t,{default:()=>S});var n=l(35143),i=l(18690),s=l(98773),a=l(30726),o=l(68134),r=l(90632),d=l(46053),p=(l(81806),l(76460),l(85842)),g=l(25329),c=l(94126),h=l(98108),u=l(71981),y=l(76099),b=l(63582),_=l(54761),m=l(71257),v=l(9003),w=l(61750);const f="esri-snapping-controls",L={base:f,container:`${f}__container`,item:`${f}__item`,toggleBlock:`${f}__toggle-block`,layerListBlock:`${f}__layer-list-block`,layerList:`${f}__layer-list`,layerListFilter:`${f}__layer-list__filter`,layerListButton:`${f}__layer-list__button`,layerListItem:`${f}__layer-list__item`,layerListGroup:`${f}__layer-list__group`,nestedContainer:`${f}__nested-container`};let M=class extends g.default{constructor(e,t){super(e,t),this._defaultViewModel=null,this._layerListFilter=null,this._gridLoadTask=null,this.layerListOpen=!0,this.gridOptionsOpen=!1,this.messages=null,this.messagesCommon=null,this.snappingManager=null,this.visibleElements=new w.A,this._enableSnappingSwitchChange=e=>{this.snappingOptions.enabled=e},this._featureEnabledSwitchChange=e=>{this.snappingOptions.featureEnabled=e},this._gridEnabledSwitchChange=e=>{this.snappingOptions.gridEnabled=e,e&&this._startLoadGrid()},this._selfEnabledSwitchChange=e=>{this.snappingOptions.selfEnabled=e},this._onToggleLayersButtonClick=e=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled),(0,y.Z6)(e.target)};const{snappingOptions:l,view:n,viewModel:i}=e;this.viewModel=i??(this._defaultViewModel=new m.default({snappingOptions:l,view:n}))}normalizeCtorArgs(e){const{snappingOptions:t,view:l,viewModel:n,...i}=e;return i}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=(0,a.pR)(this._defaultViewModel))}loadDependencies(){return Promise.all([(0,c.W)({block:()=>l.e(75502).then(l.bind(l,75502)),button:()=>Promise.resolve().then(l.bind(l,43285)),input:()=>Promise.resolve().then(l.bind(l,38841)),list:()=>Promise.resolve().then(l.bind(l,75802)),"list-item":()=>Promise.resolve().then(l.bind(l,70205)),checkbox:()=>Promise.resolve().then(l.bind(l,64990)),loader:()=>Promise.resolve().then(l.bind(l,35688))}),(0,u.m)()])}initialize(){this.addHandles((0,o.watch)((()=>"2d"===this.view?.type&&!!this.view.grid),(e=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=e)})))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&(null!=this._defaultViewModel&&this._defaultViewModel===e||(this._defaultViewModel=(0,a.pR)(this._defaultViewModel)),this._set("viewModel",e))}render(){const{label:e}=this;return(0,_.K)("div",{"aria-label":e,class:this.classes(L.base,h.D.widget)},(0,_.K)("div",{class:L.container},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),"2d"===this.view?.type&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const{visibleElements:e,view:t}=this,l=[e.selfEnabledToggle?this._renderSelfEnabledToggle():null,e.featureEnabledToggle?this._renderFeatureEnabledToggle():null,e.gridEnabledToggle&&"2d"===t?.type?this._renderGridEnabledToggle():null].filter(i.Ru),n=[e.enabledToggle?this._renderEnabledToggle():null,l.length>0?(0,_.K)("div",{class:L.nestedContainer},l):null].filter(i.Ru);return 0===n.length?null:(0,_.K)("calcite-block",{class:L.toggleBlock,heading:e.header?this.label:"",key:"toggle-block",label:this.label,open:!0},n)}_renderEnabledToggle(){return(0,_.K)(u.o,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return(0,_.K)(u.o,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return(0,_.K)(u.o,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return(0,_.K)(u.o,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const{messages:e,viewModel:t}=this,l=t.layerListViewModel.operationalItems.length>9?(0,_.K)("calcite-input",{class:L.layerListFilter,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:e=>{let{currentTarget:{value:t}}=e;this._layerListFilter=""===t?null:new RegExp(t,"i")}}):null,n=this._secondaryElementsDisabled,i=this.layerListOpen&&!n,s=t.layerListViewModel.operationalItems?.find((e=>!!e.children.length));return(0,_.K)("calcite-block",{class:L.layerListBlock,collapsible:!0,disabled:this._secondaryElementsDisabled,heading:e.snappingLayers,key:"list-block",open:i,onCalciteBlockToggle:e=>this.layerListOpen=e.currentTarget.open},l,this._renderToggleLayersButton(),(0,_.K)("calcite-list",{class:L.layerList,displayMode:s?"nested":"flat",label:e?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(t.layerListViewModel.operationalItems)))}_renderGridOptions(){const{view:e,visibleElements:t,snappingManager:l,snappingOptions:n,_openAndReady:i}=this,{gridEnabled:s,enabled:a}=n;(i||"2d"===e?.type&&e.grid)&&this._startLoadGrid();const o=this._gridLoadTask?.value,r=o&&"2d"===e?.type&&(0,_.K)(o,{snappingManager:l,snappingOptions:n,view:e,visibleElements:t.gridControlsElements});return(0,_.K)("calcite-block",{class:L.layerListBlock,collapsible:!0,disabled:!s||!a,heading:this.messages.gridOptionsHeading,key:"grid-block",open:i,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},r??(0,_.K)("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&"2d"===this.view?.type&&(this._gridLoadTask=(0,s.UT)((async()=>(await Promise.all([l.e(93613),l.e(51742),l.e(85324),l.e(10061),l.e(25704),l.e(84513),l.e(50720),l.e(14605)]).then(l.bind(l,36986))).default)))}_renderLayerListItemCollection(e){const t=this._layerListFilter;return e.map((e=>{switch(t?(0,v.BR)(e,t):null){case"children":{const l=e.children.filter((e=>!1!==(0,v.BR)(e,t)));return this._renderLayerListItemGroup(e,l)}case"self":case null:return this._renderLayerListItemOrGroup(e);case!1:return"self"===(0,v.BR)(e.parent,t)?this._renderLayerListItemOrGroup(e):null}})).toArray().filter(i.Ru)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const{viewModel:{allLayersEnabled:e},messages:t}=this,l=e?t.disableAllLayers:t.enableAllLayers;return(0,_.K)("calcite-button",{appearance:"transparent",class:L.layerListButton,label:l,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},l)}_renderLayerListItemOrGroup(e){if(e.children.length)return this._renderLayerListItemGroup(e);const{messages:{untitledLayer:t}}=this,l=e.title||t,n=()=>{this.viewModel.toggleSnappingForLayers([e.layer?.id],"enabled"!==e.enabled)};return(0,_.K)("calcite-list-item",{class:L.layerListItem,key:`${this.id}-list-item-${e.uid}`,label:l,onCalciteListItemSelect:e=>{e.stopPropagation(),n()}},(0,_.K)("calcite-checkbox",{checked:"enabled"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:n}))}_renderLayerListItemGroup(e,t){const{messages:l}=this,{children:n,title:i}=e,s=i||l.untitledLayer,a=i&&""!==i?i:(0,r.c)(),o=!!t?.length,d=t??n,p=()=>{this.viewModel.toggleSnappingForLayers(e.childLayerIds,"enabled"!==e.enabled)},g=d?.find((e=>!!e.children.length));return(0,_.K)("calcite-list-item",{class:L.layerListGroup,key:a,label:s,open:o,onCalciteListItemSelect:e=>{e.stopPropagation(),p()}},(0,_.K)("calcite-checkbox",{checked:"enabled"===e.enabled,indeterminate:"indeterminate"===e.enabled,slot:"actions-start",onCalciteCheckboxChange:p}),(0,_.K)("calcite-list",{displayMode:g?"nested":"flat",label:l?.snappingLayers,selectionMode:"none"},this._renderLayerListItemCollection(d)))}get _enabledToggleDisabled(){const e=this.snappingOptions;return e.enabledToggled||e.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};(0,n._)([(0,d.MZ)()],M.prototype,"_defaultViewModel",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"_layerListFilter",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"_gridLoadTask",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"_openAndReady",null),(0,n._)([(0,d.MZ)()],M.prototype,"label",null),(0,n._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],M.prototype,"layerListOpen",void 0),(0,n._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],M.prototype,"gridOptionsOpen",void 0),(0,n._)([(0,d.MZ)(),(0,b.G)("esri/widgets/support/SnappingControls/t9n/SnappingControls")],M.prototype,"messages",void 0),(0,n._)([(0,d.MZ)(),(0,b.G)("esri/t9n/common")],M.prototype,"messagesCommon",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"snappingOptions",null),(0,n._)([(0,d.MZ)()],M.prototype,"snappingManager",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"view",null),(0,n._)([(0,d.MZ)()],M.prototype,"viewModel",null),(0,n._)([(0,d.MZ)({type:w.A,nonNullable:!0})],M.prototype,"visibleElements",void 0),(0,n._)([(0,d.MZ)()],M.prototype,"_enabledToggleDisabled",null),(0,n._)([(0,d.MZ)()],M.prototype,"_secondaryElementsDisabled",null),M=(0,n._)([(0,p.$)("esri.widgets.support.SnappingControls")],M);const S=M},61750:(e,t,l)=>{l.d(t,{A:()=>d});var n=l(35143),i=l(91967),s=l(46053),a=(l(81806),l(76460),l(47249),l(85842)),o=l(10286);let r=class extends i.default{constructor(e){super(e),this.enabledToggle=!0,this.featureEnabledToggle=!0,this.gridEnabledToggle=!0,this.header=!1,this.layerList=!0,this.gridControls=!0,this.gridControlsElements=new o.A({gridSnapEnabledToggle:!1,gridEnabledToggle:!1}),this.layerListToggleLayersButton=!0,this.selfEnabledToggle=!0}};(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"enabledToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"featureEnabledToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"gridEnabledToggle",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"header",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"layerList",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"gridControls",void 0),(0,n._)([(0,s.MZ)({type:o.A,nonNullable:!0})],r.prototype,"gridControlsElements",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"layerListToggleLayersButton",void 0),(0,n._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],r.prototype,"selfEnabledToggle",void 0),r=(0,n._)([(0,a.$)("esri.widgets.support.SnappingControls.VisibleElements")],r);const d=r},71257:(e,t,l)=>{l.r(t),l.d(t,{default:()=>f});var n,i=l(35143),s=l(91967),a=l(50076),o=l(68134),r=l(46053),d=(l(81806),l(76460),l(47249),l(85842)),p=l(3589),g=l(83973),c=l(50912),h=l(19276),u=l(38283),y=l(9003),b=l(18690),_=l(30545);let m=n=class extends _.default{constructor(e){super(e),this.children=new h.default,this.parent=null}get enabled(){const{children:e}=this;if(0===e.length)return null!=this.featureSource&&this.featureSource.enabled?"enabled":"disabled";let t=!1,l=!1;for(const n of e){if("indeterminate"===n.enabled)return n.enabled;if("enabled"===n.enabled?t=!0:"disabled"===n.enabled&&(l=!0),l&&t)return"indeterminate"}return l?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap((e=>[e.layer?.id,...e.childLayerIds]))}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find((t=>t.layer===e))}_initializeChildLayers(e){if(!e)return;const t=e.filter(y.mH);super._initializeChildLayers(t)}_createChildItems(e){return e.map((e=>(0,c.oU)(e)?new n({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null)).filter(b.Ru).reverse()}};(0,i._)([(0,r.MZ)()],m.prototype,"enabled",null),(0,i._)([(0,r.MZ)()],m.prototype,"children",void 0),(0,i._)([(0,r.MZ)()],m.prototype,"childLayerIds",null),(0,i._)([(0,r.MZ)()],m.prototype,"featureSource",null),(0,i._)([(0,r.MZ)({constructOnly:!0})],m.prototype,"getFeatureSnappingSources",void 0),(0,i._)([(0,r.MZ)()],m.prototype,"parent",void 0),m=n=(0,i._)([(0,d.$)("esri.widgets.support.SnappingControls.SnappingListItem")],m);let v=class extends u.default{constructor(){super(...arguments),this.featureSnappingSources=new h.default}get operationalItemsFlat(){return this.operationalItems.flatten((e=>e.children))}get selectableItems(){return this.operationalItemsFlat.filter((e=>!e.children?.length))}_compileList(){const e=this.view?.map?.layers;if(!e)return;const t=e.filter(y.mH);this._watchLayersListMode(t);const l=this._getViewableLayers(t);l?.length?(this._createNewItems(l),this._removeItems(l),this._sortItems(l)):this._removeAllItems()}_createListItem(e){return new m({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};(0,i._)([(0,r.MZ)()],v.prototype,"featureSnappingSources",void 0),(0,i._)([(0,r.MZ)()],v.prototype,"operationalItems",void 0),(0,i._)([(0,r.MZ)()],v.prototype,"operationalItemsFlat",null),(0,i._)([(0,r.MZ)()],v.prototype,"selectableItems",null),v=(0,i._)([(0,d.$)("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],v);let w=class extends s.default{constructor(e){super(e),this.layerListViewModel=new v,this.snappingOptions=new g.default,this.view=null}initialize(){this.addHandles([(0,o.watch)((()=>({viewModel:this.layerListViewModel,view:this.view})),(e=>{let{viewModel:t,view:l}=e;t.view=l}),o.initial),(0,o.watch)((()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources})),(e=>{let{viewModel:t,sources:l}=e;t.featureSnappingSources=l}),o.initial)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>"enabled"===e.enabled))}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every((e=>!e.enabled))}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter((e=>"enabled"===e.enabled)).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(e,t){e?.forEach((e=>t?this.enableSnappingForLayer(e):this.disableSnappingForLayer(e)))}toggleSnappingForAllLayers(e){this.layerListViewModel.selectableItems.forEach((t=>{let{layer:l}=t;const n=l?.id;e?this.enableSnappingForLayer(n):this.disableSnappingForLayer(n)}))}enableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e);t&&(t.enabled=!0)}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)(0,c.oU)(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find((t=>t.layer.id===e))}_makeSnappingSourceForLayer(e){const t=this.layerListViewModel.operationalItemsFlat.find((t=>t.layer?.id===e))?.layer;if(!t)throw new a.default("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);if("group"===t.type)return;const l=new p.default({layer:t});return this.snappingOptions.featureSources.add(l),l}};(0,i._)([(0,r.MZ)()],w.prototype,"allLayersEnabled",null),(0,i._)([(0,r.MZ)()],w.prototype,"allLayersDisabled",null),(0,i._)([(0,r.MZ)({constructOnly:!0})],w.prototype,"layerListViewModel",void 0),(0,i._)([(0,r.MZ)()],w.prototype,"layersEnabledCount",null),(0,i._)([(0,r.MZ)({type:g.default,nonNullable:!0})],w.prototype,"snappingOptions",void 0),(0,i._)([(0,r.MZ)()],w.prototype,"state",null),(0,i._)([(0,r.MZ)()],w.prototype,"view",void 0),w=(0,i._)([(0,d.$)("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],w);const f=w},71981:(e,t,l)=>{l.d(t,{m:()=>s,o:()=>r});var n=l(94126),i=(l(76099),l(54761));const s=()=>(0,n.W)({icon:()=>Promise.resolve().then(l.bind(l,16702)),label:()=>Promise.resolve().then(l.bind(l,11839)),switch:()=>l.e(8989).then(l.bind(l,8989)),tooltip:()=>l.e(31748).then(l.bind(l,31748))}),a="esri-labeled-switch",o={label:`${a}__label`,labelContent:`${a}__label-content`,iconInfo:`${a}__icon_info`,iconWarning:`${a}__icon_warning`,tooltip:`${a}__tooltip`};function r(e){let{checked:t,disabled:l,hint:n,key:s,label:a,onChange:r,hintIcon:d,hintKind:p}=e;return(0,i.K)("calcite-label",{class:o.label,disabled:l,key:s,layout:"inline-space-between",scale:"s"},n?(0,i.K)("div",{class:o.labelContent,key:"label-content"},(0,i.K)("div",null,a),(0,i.K)("calcite-icon",{class:"warning"!==p?o.iconInfo:o.iconWarning,icon:d??"information",id:s,scale:"s",tabIndex:0}),(0,i.K)("calcite-tooltip",{class:o.tooltip,overlayPositioning:"fixed",referenceElement:s},n)):a,(0,i.K)("calcite-switch",{checked:t,disabled:l,scale:"s",onCalciteSwitchChange:e=>r(e.currentTarget.checked)}))}}}]);
//# sourceMappingURL=58066.d9329a8a.chunk.js.map