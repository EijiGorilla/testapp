"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[58872,85367],{2052:(e,t,a)=>{a.d(t,{i:()=>n});class n{constructor(e,t,a,n){this._hasNoDataValues=null,this._minValue=null,this._maxValue=null,"pixelData"in e?(this.values=e.pixelData,this.width=e.width,this.height=e.height,this.noDataValue=e.noDataValue):(this.values=e,this.width=t,this.height=a,this.noDataValue=n)}get hasNoDataValues(){if(null==this._hasNoDataValues){const e=this.noDataValue;this._hasNoDataValues=this.values.includes(e)}return this._hasNoDataValues}get minValue(){return this._ensureBounds(),this._minValue}get maxValue(){return this._ensureBounds(),this._maxValue}get cachedMemory(){return this.values.byteLength+256}_ensureBounds(){if(null!=this._minValue)return;const{noDataValue:e,values:t}=this;let a=1/0,n=-1/0,i=!0;for(const r of t)r===e?this._hasNoDataValues=!0:(a=r<a?r:a,n=r>n?r:n,i=!1);i?(this._minValue=0,this._maxValue=0):(this._minValue=a,this._maxValue=n>-3e38?n:0)}}},23875:(e,t,a)=>{a.r(t),a.d(t,{default:()=>T});var n=a(35143),i=a(3825),r=a(50076),o=a(30726),l=a(77717),s=a(50346),c=a(90534),u=a(46053),h=(a(81806),a(76460),a(47249),a(28379)),f=a(85842),d=a(91605),p=a(25515),m=a(76328),v=a(19502),y=a(11270),g=a(94729),w=a(95363),M=a(2052),b=a(60883);let A=class extends((0,m.f)((0,v.b)((0,y.q)((0,g.A)((0,l.P)(p.default)))))){constructor(){super(...arguments),this.capabilities={operations:{supportsTileMap:!1}},this.copyright=null,this.heightModelInfo=null,this.path=null,this.minScale=void 0,this.maxScale=void 0,this.opacity=1,this.operationalLayerType="ArcGISTiledElevationServiceLayer",this.sourceJSON=null,this.type="elevation",this.url=null,this.version=null,this._lercDecoder=(0,b.b)()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._lercDecoder=(0,o.Gz)(this._lercDecoder)}readCapabilities(e,t){const a=t.capabilities&&t.capabilities.split(",").map((e=>e.toLowerCase().trim()));return a?{operations:{supportsTileMap:a.includes("tilemap")}}:{operations:{supportsTileMap:!1}}}readVersion(e,t){let a=t.currentVersion;return a||(a=9.3),a}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:e=>{if(e.typeKeywords)for(let t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new r.default("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}},e).catch(s.throwIfAbortError).then((()=>this._fetchImageService(t)))),Promise.resolve(this)}fetchTile(e,t,a,n){const r=n?.signal,o={responseType:"array-buffer",signal:r},l={noDataValue:n?.noDataValue,returnFileInfo:!0};return this.load().then((()=>this._fetchTileAvailability(e,t,a,n))).then((()=>(0,i.default)(this.getTileUrl(e,t,a),o))).then((e=>this._lercDecoder.decode(e.data,l,r))).then((e=>new M.i(e)))}getTileUrl(e,t,a){const n=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,i=(0,c.objectToQuery)({...this.parsedUrl.query,blankTile:!n&&null});return`${this.parsedUrl.path}/tile/${e}/${t}/${a}${i?"?"+i:""}`}async queryElevation(e,t){const{ElevationQuery:n}=await a.e(18722).then(a.bind(a,18722));return(0,s.throwIfAborted)(t),(new n).query(this,e,t)}async createElevationSampler(e,t){const{ElevationQuery:n}=await a.e(18722).then(a.bind(a,18722));return(0,s.throwIfAborted)(t),(new n).createSampler(this,e,t)}_fetchTileAvailability(e,t,a,n){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,a,n):Promise.resolve("unknown")}async _fetchImageService(e){if(this.sourceJSON)return this.sourceJSON;const t={query:{f:"json",...this.parsedUrl.query},responseType:"json",signal:e},a=await(0,i.default)(this.parsedUrl.path,t);a.ssl&&(this.url=this.url?.replace(/^http:/i,"https:")),this.sourceJSON=a.data,this.read(a.data,{origin:"service",url:this.parsedUrl})}get hasOverriddenFetchTile(){return!this.fetchTile[x]}};(0,n._)([(0,u.MZ)({readOnly:!0})],A.prototype,"capabilities",void 0),(0,n._)([(0,h.w)("service","capabilities",["capabilities"])],A.prototype,"readCapabilities",null),(0,n._)([(0,u.MZ)({json:{read:{source:"copyrightText"}}})],A.prototype,"copyright",void 0),(0,n._)([(0,u.MZ)({readOnly:!0,type:d.default})],A.prototype,"heightModelInfo",void 0),(0,n._)([(0,u.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],A.prototype,"path",void 0),(0,n._)([(0,u.MZ)({type:["show","hide"]})],A.prototype,"listMode",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],A.prototype,"minScale",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}},readOnly:!0})],A.prototype,"maxScale",void 0),(0,n._)([(0,u.MZ)({json:{read:!1,write:!1,origins:{"web-document":{read:!1,write:!1}}}})],A.prototype,"opacity",void 0),(0,n._)([(0,u.MZ)({type:["ArcGISTiledElevationServiceLayer"]})],A.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.MZ)()],A.prototype,"sourceJSON",void 0),(0,n._)([(0,u.MZ)({json:{read:!1},value:"elevation",readOnly:!0})],A.prototype,"type",void 0),(0,n._)([(0,u.MZ)(w.OZ)],A.prototype,"url",void 0),(0,n._)([(0,u.MZ)()],A.prototype,"version",void 0),(0,n._)([(0,h.w)("version",["currentVersion"])],A.prototype,"readVersion",null),A=(0,n._)([(0,f.$)("esri.layers.ElevationLayer")],A);const x=Symbol("default-fetch-tile");A.prototype.fetchTile[x]=!0;const T=A},34780:(e,t,a)=>{a.d(t,{q:()=>i});var n=a(38205);class i{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.tile=e,null!=t&&null!=e){const a=e.extent;this._samplerData=new n.Q(t,a)}}get zmin(){return null!=this._samplerData?this._samplerData.data.minValue:0}get zmax(){return null!=this._samplerData?this._samplerData.data.maxValue:0}get hasNoDataValues(){return!!this._samplerData?.data.hasNoDataValues}sample(e,t){if(null==this._samplerData)return;const{safeWidth:a,data:n,dx:i,dy:o,y1:l,x0:s}=this._samplerData,{width:c,values:u,noDataValue:h}=n,f=r(o*(l-t),0,a),d=r(i*(e-s),0,a),p=Math.floor(f),m=Math.floor(d),v=p*c+m,y=v+c,g=u[v],w=u[y],M=u[v+1],b=u[y+1];if(g!==h&&w!==h&&M!==h&&b!==h){const e=d-m,t=g+(M-g)*e;return t+(w+(b-w)*e-t)*(f-p)}}}function r(e,t,a){return e<t?t:e>a?a:e}},36116:(e,t,a)=>{a.d(t,{Ys:()=>M,gm:()=>A,h:()=>b,kV:()=>T});var n,i,r=a(50076),o=a(76460),l=a(50346),s=a(9624),c=a(2413),u=a(23875),h=a(85598),f=(a(33562),a(96138)),d=a(34780),p=a(2052),m=a(44038),v=a(88235),y=a(11164),g=(a(90391),a(81950),a(67061)),w=a(38338);async function M(e,t,a){if(!t.extent||!t.url)throw(0,w.EW)("esri.layer.orientedImagery.transformations",new r.default("update-elevation:missing-property","both extent and url are required to create a sampler",t));const n=await A(t);if(!n)throw(0,w.EW)("esri.layers.orientedImagery.transformations",new r.default("update-elevation:elevation-source","could not create a sampler using provided elevation source",t));return b(e,n,a)}async function b(e,t,a){await(0,l.waitTick)(a);const n=function(e,t){return async a=>{let n=a.clone();const i=a.spatialReference.equals(e.spatialReference)?n:await(0,s.projectWithZConversion)(a,e.spatialReference,t),r=e.queryElevation(i);return r&&(n=a.spatialReference.equals(e.spatialReference)?r.clone():await(0,s.projectWithZConversion)(r,a.spatialReference,t)),n.z=n.z??1,n}}(t,a),i=Array.isArray(e)?e:[e];return await Promise.all(i.map(n))}(i=n||(n={}))[i.DYNAMIC=0]="DYNAMIC",i[i.ELEVATION=1]="ELEVATION",i[i.IMAGE=2]="IMAGE";const A=async(e,t)=>{let a;const{extent:i,rasterFunction:r,url:s,lod:g}=e;try{a=await x(s)}catch(w){if((0,l.isAbortError)(w))return;o.A.getLogger("esri.layers.orientedImagery.transformations").error("updateElevationUsingElevationSource",w)}switch(a){case n.DYNAMIC:return await async function(e,t,a,n){const i=a?new m.default({functionName:a}):void 0,r=new h.default({url:e,rasterFunction:i,format:"lerc"});await r.load(n);let o,l=512,s=512;const u=t.width/t.height;u>1?(s/=u,o=t.height/s):(l*=u,o=t.width/l);const g=await r.fetchImage(t,l,s,n),w=v.default.create({scales:[o],size:512,spatialReference:t.spatialReference}),M=new y.U(null,0,0,0,(0,c.VY)(t)),b=new p.i(g.pixelData.pixelBlock.pixels[0],l,s,0),A=new d.q(M,b);return new f.TileElevationSampler(A,w,void 0)}(s,i,r,t);case n.ELEVATION:return await async function(e,t,a,n){const i=new u.default(e);let r;try{const{tileInfo:e}=await i.load(),o=(a&&e.lodAt(Math.min(e.lods.length-1,a))?.resolution)??"finest-contiguous";r=await i.createElevationSampler(t,{...n,demResolution:o})}catch(w){if((0,l.isAbortError)(w))return;o.A.getLogger(i).error(w)}finally{i.destroy()}return r}(s,i,g,t);default:return}};async function x(e,t){await(0,l.waitTick)(t);const a=await(0,g.V)(e),{tileInfo:i,cacheType:o}=a;if(!a.hasOwnProperty("bandCount")||!a.hasOwnProperty("pixelSizeX"))throw new r.default("elevation-source:invalid-service-url",`ElevationSource URL expects an elevation 3D image service but given ${e}`);return i?"LERC"!==i?.format?.toUpperCase()||o&&"elevation"!==o.toLowerCase()?n.IMAGE:n.ELEVATION:n.DYNAMIC}async function T(e,t,a){return await(0,l.waitTick)(a),e.map((e=>(e.z=t,e)))}},38338:(e,t,a)=>{a.d(t,{Cg:()=>h,DU:()=>l,EW:()=>y,FL:()=>d,Fe:()=>m,Gd:()=>o,NL:()=>p,RP:()=>s,_U:()=>c,br:()=>v,gt:()=>g,mz:()=>f,wB:()=>u});var n=a(3825),i=a(76460),r=a(44538);function o(e){return"3d"===e?.type}function l(e){return"esri.Graphic"===e?.declaredClass}function s(e){return/(tiff|tif|mrf)$/i.test(e??"")}function c(e){if(!e)return!1;if(!URL.canParse(e))return!1;const{pathname:t}=new URL(e);return/.*\.(tiff|tif|mrf)$/i.test(t??"")}function u(e){return Math.abs(e)>=135?"WEST":e<-45&&e>-135?"SOUTH":e<=45?"EAST":"NORTH"}function h(e,t){const a=e/t*r.rV[2];return a<=r.rV[0]?"NEAR":a<=r.rV[1]?"":"FAR"}function f(e){return"string"==typeof e&&e.length?e:function(e){return e&&e.url&&e.datasetFormat?e:null}(e)}const d=e=>t=>t.layer===e;function p(e){return"NoAttachmentError"===e?.name}const m=e=>`${e}:missing-property`,v=(e,t)=>`Property ${t} is missing in ${e}`,y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"esri.widgets.OrientedImageryViewer",t=arguments.length>1?arguments[1]:void 0;throw i.A.getLogger(e).error(t),t},g=async(e,t)=>{const a=await(0,n.default)(e,{...t,method:"head"}),i=a?.getHeader?.("Content-Type");if(i)return i.split("/")[1]}},44067:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(50076),i=a(50346);class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.lods[e.lods.length-1].level;this.tileInfo=e,this.minLOD=t,this.maxLOD=a,e.lodAt(t)||(this.minLOD=e.lods[0].level),e.lodAt(a)||(this.maxLOD=e.lods[e.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(e,t,a){const n=this.tileInfo?.lodAt(e);return!n||e<this.minLOD||e>this.maxLOD?"unavailable":n.cols&&n.rows?a>=n.cols[0]&&a<=n.cols[1]&&t>=n.rows[0]&&t<=n.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(e,t,a,r){await(0,i.waitTick)(r);const o=this.getAvailability(e,t,a);if("unavailable"===o)throw new n.default("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:a});return o}async fetchAvailabilityUpsample(e,t,a,n,r){await(0,i.waitTick)(r),n.level=e,n.row=t,n.col=a;const o=this.tileInfo;return o.updateTileInfo(n),this.fetchAvailability(e,t,a,r).catch((e=>{if((0,i.isAbortError)(e))throw e;if(o.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,r);throw e}))}}},44538:(e,t,a)=>{a.d(t,{BH:()=>u,PD:()=>o,RK:()=>h,Vx:()=>c,Z5:()=>n,dx:()=>r,j5:()=>d,p4:()=>f,rV:()=>i,uS:()=>p});const n=120,i=[21,36,51,60],r=3.5,o=["FAR_WEST","FAR_NORTH","FAR_EAST","FAR_SOUTH","WEST","NORTH","EAST","SOUTH","NEAR_WEST","NEAR_NORTH","NEAR_EAST","NEAR_SOUTH"],l=23.937554159486076,s=96.06244584051393,c={EAST:[l,l,s,l,60,l],NORTH:[l,s,l,l,l,60],SOUTH:[s,l,s,s,s,60],WEST:[s,s,l,s,60,s]},u=-999,h=100,f=()=>["after-data-capture-complete","deselect-data-capture-features","select-data-capture-features"],d="ImageGeometry",p="OIObjectId"},57134:(e,t,a)=>{a.d(t,{EA:()=>s,EF:()=>l,ZH:()=>r,li:()=>c,vK:()=>o});var n=a(19247),i=a(13312);const r=new n.default({x:0,y:0,z:0,spatialReference:i.default.WebMercator}),o=1e3,l=114,s=120,c=50},58872:(e,t,a)=>{a.d(t,{E1:()=>u,Mr:()=>c,TH:()=>s,jV:()=>h});var n=a(35143),i=a(69098),r=a(42553),o=a(46053),l=(a(81806),a(76460),a(47249),a(85842));let s=class extends(i.A.ClonableMixin(r.A)){constructor(){super(...arguments),this.url=null}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],s.prototype,"lod",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"rasterFunction",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"url",void 0),s=(0,n._)([(0,l.$)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ElevationSource")],s);let c=class extends(i.A.ClonableMixin(r.A)){constructor(){super(...arguments),this.constantElevation=null}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],c.prototype,"constantElevation",void 0),c=(0,n._)([(0,l.$)("esri.layers.orientedImagery.core.ElevationSourceDefinitions.ConstantElevation")],c);const u=e=>null!=e&&"number"==typeof e.constantElevation,h=e=>null!=e&&e.url?.length>0},60883:(e,t,a)=>{a.d(t,{b:()=>o});var n=a(12016);class i extends n.B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super("LercWorker","_decode",{_decode:e=>[e.buffer]},e,{strategy:"dedicated"}),this.schedule=e,this.ref=0}decode(e,t,a){return e&&0!==e.byteLength?this.invoke({buffer:e,options:t},a):Promise.resolve(null)}release(){--this.ref<=0&&(r.forEach(((e,t)=>{e===this&&r.delete(t)})),this.destroy())}}const r=new Map;function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=r.get(e);return t||(null!=e?(t=new i((t=>e.immediate.schedule(t))),r.set(e,t)):(t=new i,r.set(null,t))),++t.ref,t}},76328:(e,t,a)=>{a.d(t,{f:()=>h});var n=a(35143),i=a(46053),r=(a(81806),a(76460),a(47249),a(28379)),o=a(85842),l=a(13312),s=a(88235),c=a(44067),u=a(82356);const h=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}readMaxScale(e,t){return null!=t.minLOD&&null!=t.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,t,a){const n=t.capabilities?.includes("Tilemap");let{minLOD:i,maxLOD:r,minScale:o,maxScale:l}=t;if(null==i&&null==r&&(0!==o||0!==l)){const e=e=>Math.round(1e4*e)/1e4;o=e(o||t.tileInfo.lods[0].scale),l=e(l||t.tileInfo.lods[t.tileInfo.lods.length-1].scale);for(const a of t.tileInfo.lods){const t=e(a.scale);i=t>=o?a.level:i,r=t>=l?a.level:r}}if(n)return new u.d({layer:this,minLOD:i,maxLOD:r});if(t.tileInfo){const e=new s.default;return e.read(t.tileInfo,a),new c.A(e,i,r)}return null}};return(0,n._)([(0,i.MZ)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),(0,n._)([(0,i.MZ)()],t.prototype,"minScale",void 0),(0,n._)([(0,r.w)("service","minScale")],t.prototype,"readMinScale",null),(0,n._)([(0,i.MZ)()],t.prototype,"maxScale",void 0),(0,n._)([(0,r.w)("service","maxScale")],t.prototype,"readMaxScale",null),(0,n._)([(0,i.MZ)({type:l.default})],t.prototype,"spatialReference",void 0),(0,n._)([(0,i.MZ)({readOnly:!0})],t.prototype,"supportsBlankTile",null),(0,n._)([(0,i.MZ)({type:s.default})],t.prototype,"tileInfo",void 0),(0,n._)([(0,i.MZ)()],t.prototype,"tilemapCache",void 0),(0,n._)([(0,r.w)("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),(0,n._)([(0,i.MZ)()],t.prototype,"version",void 0),t=(0,n._)([(0,o.$)("esri.layers.mixins.ArcGISCachedService")],t),t}},85367:(e,t,a)=>{a.r(t),a.d(t,{worldToImage:()=>s,worldToImagePanoramic:()=>u,worldToImageWithLTPFlag:()=>c});var n=a(15941),i=a(9392),r=a(20664),o=a(45417),l=a(97572);function s(e,t){const{cameraLocation:a,pointsToTransform:n,scalingFactor:o}=function(e,t,a){const n=Array.isArray(e)||"items"in e?e:[e];(0,l.N5)(n,t),h(n,t),(0,l._)(a);const i=(0,l.i2)(t.y,t.spatialReference);return{pointsToTransform:n.map((e=>e.toArray())),scalingFactor:i,cameraLocation:t.toArray()}}(e,t.cameraLocation,t.rotationMatrix),s=new Array;return function(e,t,a){const{affineTransformations:n,cameraLocation:o,focalLengthX:l,focalLengthY:s,principalOffsetPoint:c,radialDistortionCoefficients:u,rotationMatrix:h,scalingFactor:f,tangentialDistortionCoefficients:d}=a;for(const p of e){const e=(0,i.vt)();(0,r.a)(e,p,o),e[0]=e[0]/f,e[1]=e[1]/f;const a=-l*((h[0]*e[0]+h[3]*e[1]+h[6]*e[2])/(h[2]*e[0]+h[5]*e[1]+h[8]*e[2])),m=-s*((h[1]*e[0]+h[4]*e[1]+h[7]*e[2])/(h[2]*e[0]+h[5]*e[1]+h[8]*e[2])),v=a*a+m*m;let y=0,g=0,w=0,M=0,b=0,A=0,x=0;u&&(y=u[0]??0,g=u[1]??0,w=u[2]??0),d&&(M=d[0],b=d[1]),c&&(A=c[0]??0,x=c[1]??0);const T=1+y*v+g*v*v+w*v*v*v;let _=a*T+M*(v+2*a**2)+2*b*a*m,O=m*T+b*(v+2*m**2)+2*M*a*m;_+=A,O+=x;const E=Number(n[0])+Number(n[1])*_+Number(n[2])*O,S=Number(n[3])+Number(n[4])*_+Number(n[5])*O;t.push({x:E,y:S})}}(n,s,{...t,cameraLocation:a,scalingFactor:o,...f(t)}),Array.isArray(e)?s:s[0]}function c(e,t,a){return s(e?t.map((e=>(0,o.webMercatorToGeographic)(e))):t,a).map((e=>({...e,z:1})))}function u(e,t){const{cameraHeading:a,imageHeight:i,imageWidth:o}=t,{cameraLocation:s,pointsToTransform:c}=function(e,t){const a=Array.isArray(e)||"items"in e?e:[e];return(0,l.N5)(a,t),h(a,t),{pointsToTransform:a.map((e=>e.toArray())),cameraLocation:t.toArray()}}(e,t.cameraLocation),u=new Array;for(const h of c){const e=(0,r.j)(s,h),t=(0,l.MO)((0,n.KJ)(Math.atan2(h[0]-s[0],h[1]-s[1]))-a),c=(0,n.KJ)(Math.acos((s[2]-h[2])/e));u.push((0,l._H)(t,c,o,i))}return Array.isArray(e)?u:u[0]}function h(e,t){if(e.some((e=>!e.spatialReference.equals(t.spatialReference))))throw new Error("Input points and camera location must have the same spatial reference")}function f(e){if(function(e){return null!=e?.focalLength}(e))return{focalLengthX:e.focalLength,focalLengthY:e.focalLength};const{imageWidth:t,imageHeight:a,horizontalFieldOfView:i,verticalFieldOfView:r}=e;return{focalLengthX:t/(2*Math.tan((0,n.kU)(i)/2)),focalLengthY:a/(2*Math.tan((0,n.kU)(r)/2))}}},97572:(e,t,a)=>{a.d(t,{D5:()=>F,Dy:()=>ue,Hk:()=>re,L2:()=>ie,MO:()=>ce,MY:()=>_,Mm:()=>G,N5:()=>W,Ns:()=>ne,Qu:()=>O,SP:()=>te,Yc:()=>$,ZA:()=>K,Zq:()=>N,_:()=>j,_H:()=>U,_i:()=>I,cC:()=>z,cL:()=>A,cV:()=>Y,cb:()=>ee,dM:()=>C,eM:()=>oe,ei:()=>E,i2:()=>q,id:()=>k,m0:()=>X,n3:()=>P,or:()=>H,ox:()=>Z,pq:()=>R,sp:()=>J,tB:()=>ae,x1:()=>V});var n=a(50076),i=a(42553),r=a(15941),o=a(44680),l=a(13191),s=a(55855),c=a(9392),u=a(63919),h=a(34761),f=a(20664),d=a(19247),p=a(9624),m=a(14556),v=a(80963),y=a(45136),g=a(58872),w=a(36116),M=a(85632),b=a(57134);function A(e,t,a){const[n,i,r,o]=t,[s,c,u,f]=a;x(n,i,r,o);const d=x(s,c,u,f),p=T(n,i,r,o),m=T(s,c,u,f),v=(0,h.Qw)((0,l.vt)(),p),y=(0,h.lK)((0,l.vt)(),v,m),[g,w,M,b]=function(e,t){const[a,n,i]=e,r=[0,0,0,0];return r[0]=a*t[0]+n*t[1]+i*t[2]+t[3],r[1]=a*t[4]+n*t[5]+i*t[6]+t[7],r[2]=a*t[8]+n*t[9]+i*t[10]+t[11],r[3]=function(e){return 0===e?1:e}(a*t[12]+n*t[13]+i*t[14]+t[15]),r}(e,y);return[g/b,w/b,d?0:M/b]}function x(e,t,a,n){return 0===e[2]&&0===t[2]&&0===a[2]&&0===n[2]&&(e[2]=t[2]=a[2]=n[2]=1,!0)}function T(e,t,a,n){const i=function(e,t){const[a,n,i,r]=e,o=new Array(4);return o[0]=a*t[0]+n*t[1]+i*t[2]+r*t[3],o[1]=a*t[4]+n*t[5]+i*t[6]+r*t[7],o[2]=a*t[8]+n*t[9]+i*t[10]+r*t[11],o[3]=a*t[12]+n*t[13]+i*t[14]+r*t[15],o}((0,s.ci)([...n,1]),(0,h.Qw)(new Array(16),(0,l.fA)(e[0],t[0],a[0],0,e[1],t[1],a[1],0,e[2],t[2],a[2],0,1,1,1,1))),r=i[0],o=i[1],c=i[2],u=(0,l.vt)();return u[0]=r*e[0],u[1]=o*t[0],u[2]=c*a[0],u[3]=0,u[4]=r*e[1],u[5]=o*t[1],u[6]=c*a[1],u[7]=0,u[8]=r*e[2],u[9]=o*t[2],u[10]=c*a[2],u[11]=0,u[12]=r,u[13]=o,u[14]=c,u[15]=1,u}function _(e,t,a,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,c.Ul)();return i[0]=e[0]+t[0]*a,i[1]=e[1]+t[1]*a,i[2]=e[2]+t[2]*(a/n),i}function O(e,t,a){const n=(0,c.Ul)();return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*(t/a),n}function E(e,t){const[a,n,i]=e,r=(0,c.Ul)();return r[0]=a*t[0]+n*t[3]+i*t[6],r[1]=a*t[1]+n*t[4]+i*t[7],r[2]=a*t[2]+n*t[5]+i*t[8],r}function S(e,t,a){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!Number.isFinite(e))throw new n.default("InvalidRotationAngle","Please specify a valid angle for rotation");const l=a*(i?(0,r.kU)(e):e),s=Math.cos(l),c=Math.sin(l),u=(0,o.vt)();switch(t){case 0:u[4]=s,u[5]=-c,u[7]=c,u[8]=s;break;case 1:u[0]=s,u[2]=c,u[6]=-c,u[8]=s;break;case 2:u[0]=s,u[1]=-c,u[3]=c,u[4]=s;break;default:throw new n.default("InvalidRotationAxis","Please specify either 0, 1 or 2 for X, Y or Z axis respectively")}return u}const L={HPR:[[2,-1],[0,1],[2,-1]],OPK:[[0,1],[1,1],[2,1]]};function D(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(3!==e?.length||3!==t?.length)throw new n.default("InvalidRotationAngles","Please specify three angles with config for rotation");const i=(0,o.vt)();for(let n=0;n<3;n++){const[r,o]=t[n],l=S(e[n],r,o,a);(0,u.lw)(i,l,i)}return i}function I(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return D(e,L.HPR,t)}function V(e,t,a){const n=Math.sin((0,r.kU)(a)),i=Math.cos((0,r.kU)(a)),o=[[e,0],[e,t],[0,t]];o.forEach(((e,t)=>{o[t]=[i*e[0]-n*e[1],n*e[0]+i*e[1]]}));const l=Math.min(0,o[0][0],o[1][0],o[2][0]),s=Math.max(0,o[0][0],o[1][0],o[2][0]),c=Math.min(0,o[0][1],o[1][1],o[2][1]),u=Math.max(0,o[0][1],o[1][1],o[2][1]);return{hfov:Math.abs(s-l),vfov:Math.abs(u-c)}}function N(e,t){const a=Number(e[0]),n=Number(e[1]),i=Number(e[2]),[o,l,s,c]=t,u=(0,r.kU)(o),h=(0,r.kU)(l),f=s/Math.sqrt(1-c*Math.sin(u)**2),d=a/f,p=n/f,m=i/f,v=Math.cos(u)-Math.sin(u)*p+Math.cos(u)*m,y=Math.sin(u)+Math.cos(u)*p+Math.sin(u)*m,g=Math.sqrt(v**2+d**2),w=c*f*Math.sin(u),M=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(0===t)return e;const a=M(e,t-1);return Math.atan(y/g-(w-c*(s/Math.sqrt(1-c*Math.sin(a)**2))*Math.sin(a))/(f*g))},b=M(u),A=Math.atan(a/(f*v))+h,x=(0,r.KJ)(b);return[(0,r.KJ)(A),x,a/(Math.cos(b)*Math.sin(A-h))-s/Math.sqrt(1-c*Math.sin(b)**2)]}function C(e,t,a){const n=360/t,i=180/a;return{heading:(e.x-t/2)*n,pitch:90-(e.y-a/2)*i}}function R(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.vK/2;const{heading:i,pitch:o}=function(e,t){const a=(0,r.KJ)(Math.acos(-e.z/t));return{heading:(0,r.KJ)(Math.atan2(e.x,e.y)),pitch:a}}(e,n);return U(i,o,t,a)}function U(e,t,a,n){return{x:a/2+e/(360/a),y:n-t/(180/n),heading:e,pitch:t}}function k(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b.vK/2;return[a*(Math.sin((0,r.kU)(e))*Math.sin((0,r.kU)(t))),a*(Math.cos((0,r.kU)(e))*Math.sin((0,r.kU)(t))),a*Math.cos((0,r.kU)(180-t))]}function F(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.vK/2;const{heading:i,pitch:r}=C(e,t,a);return k(i,r,n)}async function Z(e,t,a){const n=await(0,p.projectWithZConversion)(t,e.spatialReference,a);let i=(0,r.KJ)(Math.atan2(n.y-e.y,n.x-e.x));return i=i>=0&&i<=90?90-i:i>90&&i<=180?360-i+90:90+Math.abs(i),i}function z(e,t,a){const n=Math.cos(a),i=Math.sin(a),r=[1,0,0,1,0,0],o=r[0]*n+r[2]*i,l=r[1]*n+r[3]*i,s=-r[0]*i+r[2]*n,c=-r[1]*i+r[3]*n;return r[0]=o,r[1]=l,r[2]=s,r[3]=c,[e*r[0]+t*r[2]+r[4],e*r[1]+t*r[3]+r[5]]}const P=e=>e.toArray(),H=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.some((e=>e))};function K(e,t){if(H(0===e.length,e.some((e=>{let{x:t,y:a}=e;return H(null==t,null==a)})),!t.hasZ))throw new Error("Input pixels must have x, y and camera location must have z value")}function W(e,t){if(e.some((e=>null==e.z))||null==t.z)throw new Error("Input points and camera location must have z value")}function j(e){if(9!==e?.length)throw new Error("Rotation matrix is not provided or is not a valid 3x3 matrix")}function q(e,t){return(0,v.K8)(t)?1/Math.cos(Math.PI/2-2*Math.atan(Math.exp(-1*e/m.$O.radius))):1}const $=e=>t=>new d.default(t,e),J=e=>null!=e&&"queryExtent"in e;function Y(e,t,a,n){return[[-t,-t],[+t,-t],[+t,+t],[-t,+t]].map((t=>{let[i,r]=t;return A((0,y.a)((0,c.Ul)(),a,[i,r,0]),n,e)}))}function B(e,t){if(null==e)return null;const a=parseFloat(`${e}`);return isNaN(a)?null:a}function G(e,t,a){const{cameraHeight:n,cameraPitch:i,cameraRoll:r,elevation:o,farDistance:l,horizontalFieldOfView:s,location:c,verticalFieldOfView:u}=e,h=o??(c.z??0)-n;return{...ee(e,t,a),averageElevation:h,cameraPitch:i,cameraRoll:r??0,farDistance:l,horizontalFieldOfView:s,verticalFieldOfView:u}}function Q(e,t,a,n){return le(n)?function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return D(e,L.OPK,t)}([n.omega,n.phi,n.kappa]):se(n)?I([n.heading,n.pitch,n.roll]):I([e,t,a??0])}function X(e,t,a){const{cameraHeading:n,cameraHeight:i,elevation:r,farDistance:o,horizontalFieldOfView:l,location:s,verticalFieldOfView:c}=e;return{averageElevation:r??(s.z??0)-i,cameraLocation:s,cameraHeading:n,farDistance:o,horizontalFieldOfView:l,imageHeight:a,imageWidth:t,verticalFieldOfView:c}}function ee(e,t,a){const{a0:n,a1:i,a2:r,b0:o,b1:l,b2:s,cameraHeading:c,cameraOrientation:u,cameraPitch:h,cameraRoll:f,focalLength:d,horizontalFieldOfView:p,location:m,matrix:v,principalX:y,principalY:g,radial:w,tangential:M,verticalFieldOfView:b}=e,{affines:A,focalLength:x}=function(e,t,a,n){let{a0:i,a1:r,a2:o,b0:l,b1:s,b2:c}=e;const u=[i??t/2-.5,r,o??0,l??a/2-.5,s??0,c].map(B);return null!=n&&function(e){return null!=e[1]&&null!=e[5]}(u)?{affines:u,focalLength:n}:{affines:[t/2-.5,1,0,a/2-.5,0,-1]}}({a0:n,a1:i,a2:r,b0:o,b1:l,b2:s},t,a,d),T=v??Q(c,h,f,u),_=null!=y&&null!=g?[y,g]:void 0;return{affineTransformations:u?.affineTransformations??A,cameraLocation:m.clone(),focalLength:u?.focalLength??x,horizontalFieldOfView:p,imageHeight:a,imageWidth:t,principalOffsetPoint:u?.principalOffsetPoint??_,radialDistortionCoefficients:u?.radialDistortionCoefficients??w,rotationMatrix:T,tangentialDistortionCoefficients:u?.tangentialDistortionCoefficients??M,verticalFieldOfView:b}}const te=e=>null!=e&&"elevationSample"in e&&null!=e.elevationSample,ae=e=>(0,g.jV)(e?.elevationSource)&&null!=e?.extent,ne=async(e,t)=>null!=t&&(te(t)||(e=>(0,g.E1)(e?.elevationSource))(t))?t:ae(t)?{elevationSample:await(0,w.gm)({...i.A.isSerializable(t.elevationSource)?t.elevationSource.toJSON():t.elevationSource,extent:t.extent}),elevationSource:new g.Mr({constantElevation:e})}:{elevationSource:new g.Mr({constantElevation:e})},ie=e=>(0,M.Et)(e?.heading)&&(0,M.Et)(e?.pitch),re=(e,t)=>[[-e,-t],[e,-t],[e,t],[-e,t]];function oe(e){const{cameraLocation:t,farDistance:a,horizontalFieldOfView:n,rotationMatrix:i,scalingFactor:l,verticalFieldOfView:s}=e,h=(0,o.vt)();(0,u.mg)(h,i);const d=2*Math.tan((0,r.kU)(s)/2)*a*l,p=2*Math.tan((0,r.kU)(n)/2)*a*l,m=E([0,0,-1],h),v=_([t.x,t.y,t.z],m,e.farDistance*l,l),y=E([0,1,0],h),g=E([1,0,0],h),w=O(y,d/2,l),M=O(g,p/2,l),b=(0,f.a)((0,c.Ul)(),w,M),A=(0,f.g)((0,c.Ul)(),w,M);return[(0,f.g)((0,c.Ul)(),v,b),(0,f.g)((0,c.Ul)(),v,A),(0,f.a)((0,c.Ul)(),v,b),(0,f.a)((0,c.Ul)(),v,A)]}const le=e=>2===e?.type,se=e=>1===e?.type;function ce(e){const t=e%360;return t<-180?t+360:t}function ue(e,t,a){if("panoramic"===e){const[e,n]=a;return R({x:t.x,y:t.y,z:t.z},e,n)}return{x:t.x+.5,y:.5-t.y}}var he;!function(e){e[e.CLOCKWISE=-1]="CLOCKWISE",e[e.COUNTERCLOCKWISE=1]="COUNTERCLOCKWISE"}(he||(he={}))}}]);
//# sourceMappingURL=85367.cd306fa5.chunk.js.map