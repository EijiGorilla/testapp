"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[75166,76281,84689,85685,87990],{770:(e,i,a)=>{a.d(i,{bG:()=>l,Ty:()=>o,YJ:()=>u,Fq:()=>c,vt:()=>s});var n=a(53084),t=a(42633);class r{constructor(e){const{name:i,label:a,description:n,schemes:r}=e;this.name=i,this.label=a,this.description=n,this.schemes=r;const l=e.basemapGroups||t.Np;let s=[];Object.keys(l).forEach((e=>{s=s.concat(l[e])})),this.supportedBasemaps=s,this.basemapGroups=l}isBasemapSupported(e){const i=(0,t.T1)(e,this.supportedBasemaps);return!(!i||!this.supportedBasemaps.includes(i))}getRawSchemes(e){const{basemapId:i,basemapTheme:a}=function(e,i,a){let n=null,r=null;if(i&&(n=(0,t.T1)(i,e,!1),n)){const e=(0,t.BV)(n);null!=e&&(r=e)}return!n&&a&&(n="dark"===a?"dark-gray":"gray",r=a),n||r||(n="gray",r="light"),{basemapId:n,basemapTheme:r}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let r=a;if(i){const e=(0,t.BV)(i,this.basemapGroups);null!=e&&(r=e)}let l=e.geometryType;"multipoint"===l?l="point":"mesh"===l&&(l="polygon");const s=this.schemes[l]||this.schemes.default;return{schemesInfo:(0,n.clone)(s[r]),basemapId:i,basemapTheme:a}}}function l(e){const i=e.themeDictionary,a=new Map;for(const n in i){const e=i[n];a.set(n,new r(e))}return a}function s(e,i){const a=[];return e.forEach((e=>{e.isBasemapSupported(i)&&a.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),a}function o(e,i){if(!e)return;if(!i)return;let a=null;const n=[i.primaryScheme,...i.secondarySchemes];for(const t of n)if(t.name?.toLowerCase()===e.toLowerCase()){a=t;break}return a}function u(e,i,a){if(!e&&!i)return[];if(!a)return[];const n=!e?.length,t=!i?.length,r=[a.primaryScheme,...a.secondarySchemes],l=[];for(const s of r){const a=!!n||e.some((e=>s.tags.includes(e))),r=!t&&i.some((e=>s.tags.includes(e)));a&&!r&&l.push(s)}return l}function c(e){const i=e.theme;if(i)return i.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},17237:(e,i,a)=>{a.d(i,{A:()=>s});var n=a(50076),t=a(84171),r=a(27208),l=a(42633);async function s(e){const i="days",a={...e,outStatisticTypes:l.XR,unit:i},s=await(0,t.default)(a);if(null==s.avg)throw new n.default("age-unit:insufficient-info","'avg' statistics is invalid");const o=function(e){const i=Math.abs(e.avg);let a=null;return r.supportedAgeUnits.some((e=>{const n=l.SO[e];return i>2*n&&(a=e),!!a})),a}({...s,avg:s.avg});if(o===i)return{unit:o,statistics:s};a.unit=o;const u=await(0,t.default)(a);if(null==u.avg)throw new n.default("age-unit:insufficient-info","'avg' statistics is invalid");return{unit:o,statistics:u}}},29857:(e,i,a)=>{a.r(i),a.d(i,{default:()=>v});var n=a(50076),t=a(68002),r=a(16525),l=a(90494),s=a(11563);const o=500,u=1e8,c=1280,d=12,m=30,p=15;async function f(e){const{view:i,sampleSize:a}=e;if(!e||!e.layer)throw new n.default("scale-range:missing-parameters","'layer' parameter is required");if(e.snapToLOD&&!i)throw new n.default("scale-range:missing-parameters","'view' parameter is required when 'snapToLOD' is true");e.forBinning&&(0,l.p)(e,"scale-range");const{layer:t,...r}=e,u=e.forBinning?s.Mi:s.J4,c=(0,s.Jg)(t,u,e.forBinning);if(!c)throw new n.default("scale-range:invalid-parameters","'layer' must be one of these types: "+(0,s.Ho)(u).join(", "));const d={layerAdapter:c,...r};d.sampleSize=a||o,await(i?.when());const m=null!=d.signal?{signal:d.signal}:null;return await c.load(m),d}function y(e,i,a){const n=function(e,i){const a=d,n=c/4,t=m,r=c/4,l=p,s=c/2;let o=0,u=0,f=0,y=0;switch(e){case"point":case"multipoint":{const e=i;o=e.avgMinDistance??0,u=a,f=e.minDistance??0,y=n;break}case"polyline":{const e=i;o=e.avgLength??0,u=t,f=e.minLength??0,y=r;break}case"polygon":{const e=i;o=e.avgSize??0,u=l,f=e.minSize??0,y=s;break}}return{resolutionForMinScale:o>0?o/u:null,resolutionForMaxScale:f>0?f/y:null}}(e.geometryType,i),r=a?.spatialReference||e.layer.spatialReference;return{minScale:(0,t.gB)(n.resolutionForMinScale??0,r),maxScale:(0,t.gB)(n.resolutionForMaxScale??0,r)}}function h(e,i){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.constraints&&"effectiveLODs"in e.constraints){const n=e.constraints.effectiveLODs,t=a?n:n.slice().reverse();let r=null;for(const e of t)if(!(a?e.scale>i:e.scale<i)){r=e;break}return r}}function w(e,i,a,t){const{view:r,snapToLOD:l,layerAdapter:s}=e;if(l&&r){const e=h(r,i),n=h(r,a,!1);i=e?e.scale:i,a=n?n.scale:a}if(i<a)throw new n.default("scale-range:invalid","calculated minScale is less than maxScale.");return a>i/2&&(a=Math.floor(a/2)),i>u&&(i=0),"polygon"!==s.geometryType&&(a=0),{minScale:Math.ceil(i),maxScale:Math.floor(a),spatialStatistics:t}}async function v(e){const i=await f(e),{view:a,sampleSize:t,layerAdapter:l,signal:s,filter:o}=i,u=await l.getSampleFeatures({view:a,sampleSize:t,returnGeometry:!0,filter:o,signal:s},"json");if(!u?.length)throw new n.default("scale-range:insufficient-info","No features are available to calculate statistics");const c=await(0,r.A)({features:u,geometryType:l.geometryType}),{minScale:d,maxScale:m}=y(l,c,a);return w(i,d,m,c)}},31650:(e,i,a)=>{a.r(i),a.d(i,{default:()=>S});a(81806);var n=a(50076),t=a(76931),r=a(68002),l=a(43996),s=a(63040),o=a(29857),u=a(90494),c=a(11563);const d=1e8,m=1128.497176,p=591657527.591555,f=[10,8,4,2],y=[100,100,60,30],h=[2,1,.75,.5],w=[32,18,12,6],v=[{level:0,resolution:156543.03392800014,scale:591657527.591555},{level:1,resolution:78271.51696399994,scale:295828763.795777},{level:2,resolution:39135.75848200009,scale:147914381.897889},{level:3,resolution:19567.87924099992,scale:73957190.948944},{level:4,resolution:9783.93962049996,scale:36978595.474472},{level:5,resolution:4891.96981024998,scale:18489297.737236},{level:6,resolution:2445.98490512499,scale:9244648.868618},{level:7,resolution:1222.992452562495,scale:4622324.434309},{level:8,resolution:611.4962262813797,scale:2311162.217155},{level:9,resolution:305.74811314055756,scale:1155581.108577},{level:10,resolution:152.87405657041106,scale:577790.554289},{level:11,resolution:76.43702828507324,scale:288895.277144},{level:12,resolution:38.21851414253662,scale:144447.638572},{level:13,resolution:19.10925707126831,scale:72223.819286},{level:14,resolution:9.554628535634155,scale:36111.909643},{level:15,resolution:4.77731426794937,scale:18055.954822},{level:16,resolution:2.388657133974685,scale:9027.977411},{level:17,resolution:1.1943285668550503,scale:4513.988705},{level:18,resolution:.5971642835598172,scale:2256.994353},{level:19,resolution:.29858214164761665,scale:1128.497176}];function z(e,i){const{view:a}=e;if(!a)throw new n.default("scale-range:invalid-parameters","'view' is required");const t=i.minScale||d,r=a.constraints&&"effectiveLODs"in a.constraints&&a.constraints.effectiveLODs||v,l=[];for(let n=0;n<r.length;n++){if(r[n].scale>t)continue;const e=Number(n),i=[e-3,e,e+3,e+6];for(const a of i)a>-1&&a<r.length&&l.push(r[a].scale);break}return l.sort(((e,i)=>e-i))}function g(e,i){const{view:a,layerAdapter:t}=e;if(!a)throw new n.default("scale-range:invalid-parameters","'view' is required");const l=t.fullExtent,s=t.minScale||m,o=t.maxScale||p,u=i.minScale||0,c=i.maxScale||0;let d=null!=l?(0,r.X_)(a,l):0;return d=d<s&&d>o?d:0,{scales:[s,o,u,c,d].map(Math.round).sort(((e,i)=>e-i)).filter(((e,i,a)=>!!e&&a.indexOf(e)===i)).filter(((e,i,a)=>!i||Math.abs(e-a[i-1])>5)),fullExtentScale:d}}function b(e,i){const{spatialStatistics:a,minScale:r,maxScale:o}=i;if(!("avgSize"in a)||!a.avgSize)throw new n.default("size-range:insufficient-info","average polygon size is invalid");const u=a.avgSize,{view:c}=e;if(!c)throw new n.default("scale-range:invalid-parameters","'view' is required");const{resolution:d,scale:m}=c,p=d/m,{scales:f,fullExtentScale:y}=g(e,{minScale:r,maxScale:o}),h=[],w=[];return f.forEach(((e,i)=>{const{min:a,max:n}=function(e,i){const a=Math.ceil(e/i);let n=Math.ceil(a/4);n<4?n=4:n>16&&(n=16);const t=5*n;return{min:n,max:t<50?50:t}}(u,p*e),r=f.indexOf(y),l=r>-1&&i>r?2:1;h.push(new s.default({value:e,size:(0,t.PN)(a/l)})),w.push(new s.default({value:e,size:(0,t.PN)(n/l)}))})),{minSize:new l.default({valueExpression:"$view.scale",stops:h}),maxSize:new l.default({valueExpression:"$view.scale",stops:w})}}async function S(e){const i=await async function(e){const{view:i}=e;if(!(e&&i&&e.layer))throw new n.default("size-range:missing-parameters","'view' and 'layer' parameters are required");e.forBinning&&(0,u.p)(e,"size-range");const{layer:a,...t}=e,r=e.forBinning?c.Mi:c.J4,l=(0,c.Jg)(a,r,e.forBinning);if(!l)throw new n.default("size-range:invalid-parameters","'layer' must be one of these types: "+(0,c.Ho)(r).join(", "));const s={layerAdapter:l,...t,view:i};await i.when();const o=null!=s.signal?{signal:s.signal}:null;await l.load(o);const d=l.geometryType;if("point"!==d&&"multipoint"!==d&&"polyline"!==d&&"polygon"!==d)throw new n.default("size-range:not-supported",`sizeRange is not supported for geometryType: ${d}`);return s}(e),{view:a,layerAdapter:r,signal:d,filter:m}=i,p=await(0,o.default)({layer:r,view:a,signal:d,filter:m});switch(r.geometryType){case"point":case"multipoint":return function(e,i){const{minScale:a,maxScale:r}=i,o=z(e,{minScale:a,maxScale:r});if(!o.length)throw new n.default("scale-range:insufficient-info","not enough scale values");return{minSize:new l.default({valueExpression:"$view.scale",stops:o.map(((e,i)=>new s.default({value:e,size:(0,t.PN)(f[i])})))}),maxSize:new l.default({valueExpression:"$view.scale",stops:o.map(((e,i)=>new s.default({value:e,size:(0,t.PN)(y[i])})))})}}(i,p);case"polyline":return function(e,i){const{minScale:a,maxScale:r}=i,o=z(e,{minScale:a,maxScale:r});if(!o.length)throw new n.default("scale-range:insufficient-info","not enough scale values");return{minSize:new l.default({valueExpression:"$view.scale",stops:o.map(((e,i)=>new s.default({value:e,size:(0,t.PN)(h[i])})))}),maxSize:new l.default({valueExpression:"$view.scale",stops:o.map(((e,i)=>new s.default({value:e,size:(0,t.PN)(w[i])})))})}}(i,p);case"polygon":return b(i,p);case"mesh":case"multipatch":return null}return null}},76281:(e,i,a)=>{a.r(i),a.d(i,{cloneScheme:()=>v,getSchemes:()=>w,getThemes:()=>h});var n=a(69539),t=a(770),r=a(80791);const l=[128,128,128,1],s=[128,128,128,1],o="4px",u="40px",c={primary:{color:[227,139,79,1],noDataColor:l,outline:{color:[255,255,255,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8},secondary:[{color:[128,128,128,1],noDataColor:l,outline:{color:[255,255,255,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8},{color:[255,255,255,1],noDataColor:l,outline:{color:[128,128,128,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8}]},d={primary:{color:[227,139,79,1],noDataColor:s,outline:{color:[92,92,92,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8},secondary:[{color:[178,178,178,1],noDataColor:s,outline:{color:[92,92,92,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8},{color:[26,26,26,1],noDataColor:s,outline:{color:[128,128,128,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:o,maxSize:u,opacity:.8}]},m=[0,0,0,0],p={color:m,outline:{color:[166,166,166,.25],width:"1px"}},f={color:m,outline:{color:[153,153,153,.25],width:"1px"}},y=(0,t.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features by varying their size to show data.",schemes:{point:{light:c,dark:d},polyline:{light:{primary:{color:[226,119,40,1],noDataColor:l,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[77,77,77,1],noDataColor:l,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:l,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]},dark:{primary:{color:[226,119,40,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[255,255,255,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]}},polygon:{light:{primary:{marker:c.primary,background:f,opacity:c.primary.opacity},secondary:[{marker:c.secondary[0],background:f,opacity:c.secondary[0].opacity},{marker:c.secondary[1],background:f,opacity:c.secondary[1].opacity}]},dark:{primary:{marker:d.primary,background:p,opacity:d.primary.opacity},secondary:[{marker:d.secondary[0],background:p,opacity:d.secondary[0].opacity},{marker:d.secondary[1],background:p,opacity:d.secondary[1].opacity}]}}}}}});function h(e){return(0,t.vt)(y,e)}function w(e){if("mesh"===e.geometryType)return null;const i=(0,t.Fq)({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:y.get("default")});if(!i)return;const{schemesInfo:a,basemapId:n,basemapTheme:r}=i;return{primaryScheme:z(e,a.primary),secondarySchemes:a.secondary.map((i=>z(e,i))).filter(Boolean),basemapId:n,basemapTheme:r}}function v(e){if(!e)return;const i={...e};return"color"in i&&i.color&&(i.color=new n.default(i.color)),"noDataColor"in i&&i.noDataColor&&(i.noDataColor=new n.default(i.noDataColor)),"outline"in i&&i.outline&&(i.outline={color:i.outline.color&&new n.default(i.outline.color),width:i.outline.width}),"marker"in i&&i.marker&&(i.marker=v(i.marker)),"background"in i&&i.background&&(i.background=v(i.background)),i}function z(e,i){const a="mesh"!==e.geometryType&&e.worldScale?e.view:null;switch(e.geometryType){case"point":case"multipoint":{const e=i;return g({color:e.color,noDataColor:e.noDataColor,outline:e.outline,size:e.size,noDataSize:e.noDataSize,minSize:e.minSize,maxSize:e.maxSize,opacity:e.opacity||1},a)}case"polyline":{const e=i;return function(e,i){return{color:new n.default(e.color),noDataColor:new n.default(e.noDataColor),width:i?(0,r._J)(e.width,i):e.width,noDataWidth:i?(0,r._J)(e.noDataWidth,i):e.noDataWidth,minWidth:i?(0,r._J)(e.minWidth,i):e.minWidth,maxWidth:i?(0,r._J)(e.maxWidth,i):e.maxWidth,opacity:1}}({color:e.color,noDataColor:e.noDataColor,width:e.width,noDataWidth:e.noDataWidth,minWidth:e.minWidth,maxWidth:e.maxWidth},a)}case"polygon":{const e=i,t=e.marker;return delete t.opacity,function(e,i){const a=g(e.marker,i);return delete a.opacity,{marker:a,background:{color:new n.default(e.background.color),outline:{color:new n.default(e.background.outline.color),width:e.background.outline.width}},opacity:e.opacity}}({marker:t,background:e.background,opacity:e.opacity||1},a)}}}function g(e,i){return{color:new n.default(e.color),noDataColor:new n.default(e.noDataColor),outline:{color:new n.default(e.outline.color),width:e.outline.width},size:i?(0,r._J)(e.size,i):e.size,noDataSize:i?(0,r._J)(e.noDataSize,i):e.noDataSize,minSize:i?(0,r._J)(e.minSize,i):e.minSize,maxSize:i?(0,r._J)(e.maxSize,i):e.maxSize,opacity:e.opacity}}},80791:(e,i,a)=>{a.d(i,{_J:()=>u,_t:()=>o});var n=a(76931),t=a(42633);const r=t.Np.light,l=t.Np.dark;function s(e,i){return e.r===i.r&&e.g===i.g&&e.b===i.b}function o(e,i){let a=0;if(e.length===i.length){let n=e.every(((e,a)=>s(e,i[a])));n?a=1:(n=e.slice().reverse().every(((e,a)=>s(e,i[a]))),n&&(a=-1))}return a}function u(e,i){return Math.ceil(function(e){const i=e.width,a=e.height;let t=e.pixelSizeAt(e.toMap((0,n.tc)(.5*i,.5*a),{exclude:[]}));if(t<=0&&(t=e.pixelSizeAt(e.toMap((0,n.tc)(.5*i,.95*a),{exclude:[]})),t<=0&&"camera"in e)){const i=e.camera.position.clone();i.z=0,t=2*e.pixelSizeAt(i)}return t}(i)*(0,n.Lz)((0,n.cr)(e)))}},84171:(e,i,a)=>{a.r(i),a.d(i,{default:()=>s});var n=a(50076),t=a(46481),r=a(27208),l=a(11563);async function s(e){const{layerAdapter:i,...a}=await async function(e){if(!(e&&e.layer&&e.startTime&&e.endTime&&e.unit))throw new n.default("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");const{layer:i,...a}=e,t=(0,l.Jg)(i,l.J4);if(!t)throw new n.default("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+(0,l.Ho)(l.J4).join(", "));const s={layerAdapter:t,...a},o=s.view,u=null!=s.signal?{signal:s.signal}:null;await Promise.all([o?.when(),t.load(u)]);const c=(0,r.verifyDates)(t,s.startTime,s.endTime,"summary-statistics-for-age:invalid-parameters");if(c)throw c;if(!s.unit||!r.supportedAgeUnits.includes(s.unit))throw new n.default("summary-statistics-for-age:invalid-parameters",`Supported units are: ${r.supportedAgeUnits.join(", ")}`);return s}(e),{view:s,startTime:o,endTime:u,unit:c,minValue:d,maxValue:m,signal:p,filter:f,outStatisticTypes:y}=a,{valueExpression:h,statisticsQuery:w}=(0,r.getAgeExpressions)({layer:i,startTime:o,endTime:u,unit:c}),v={layer:i,valueExpression:h,...w,minValue:d,maxValue:m,outStatisticTypes:y,view:s,filter:f,signal:p};return(0,t.default)(v)}},87990:(e,i,a)=>{a.r(i),a.d(i,{createAgeRenderer:()=>oe,createClassBreaksRenderer:()=>le,createContinuousRenderer:()=>ne,createVisualVariables:()=>ie,regenerateAgeRenderer:()=>ue,regenerateClassBreaksRenderer:()=>se,regenerateContinuousRenderer:()=>te,regenerateVisualVariables:()=>ae,updateRendererWithReferenceSize:()=>re});var n=a(59784),t=a(50076),r=a(76931),l=a(40565),s=a(63860),o=a(63844),u=a(9922),c=a(30839),d=a(45430),m=a(23994),p=a(43996),f=a(32695),y=a(43327),h=a(4815),w=a(17237),v=a(33766),z=a(27084),g=a(16525),b=a(90494),S=a(11563);const x=.1,T=.25,E=.1,V=.1;function k(e){let i=0;for(const a of e)i+=a;return i/e.length}function D(e,i){const a=i??k(e),n=e.reduce(((e,i)=>e+(i-a)**2),0);return Math.sqrt(n/e.length)}async function B(e,i){const{view:a}=i;if(i.forBinning){const i=e[Math.floor(e.length/2)].geometry,n=(0,z.HA)(i);if(!n)throw new t.default("reference-size:insufficient-info","Extent is invalid");const l=Math.abs(n.xmax-n.xmin),s=Math.abs(n.ymax-n.ymin),o=Math.min(l,s);return{size:(0,r.PN)(o/a.resolution),isGrid:!0}}const{isGrid:n,avgSize:l}=await async function(e,i){const a=await(0,g.A)({features:e,geometryType:i});if(!(a&&"avgSize"in a&&a.avgSize))throw new t.default("reference-size:insufficient-info","average polygon size is invalid");const n=a.avgSize,r=[],l=[];for(const t of e){const e=(0,z.HA)(t.geometry);if(!e){r.push(0),l.push(0);continue}const i=Math.abs(e.xmax-e.xmin),a=Math.abs(e.ymax-e.ymin);r.push(i/a),l.push(Math.sqrt(i*a))}const s=Number(k(r).toFixed(2)),o=Number(D(r,s).toFixed(2)),u=D(l),c=Number((u/n).toFixed(2));return{isGrid:o<=E&&s>=1-T&&s<=1+T&&c<=V,avgSize:n}}(e,i.layerAdapter.geometryType);return{size:(0,r.PN)((n?l*(1-x):.75*l)/a.resolution),isGrid:n}}async function O(e){const i=await async function(e){const{view:i}=e;if(!(e&&i&&e.layer))throw new t.default("reference-size:missing-parameters","'view' and 'layer' parameters are required");e.forBinning&&(0,b.p)(e,"reference-size");const{layer:a,...n}=e,r=e.forBinning?S.Mi:S.J4,l=(0,S.Jg)(a,r,e.forBinning);if(!l)throw new t.default("reference-size:invalid-parameters","'reference-size' must be one of these types: "+(0,S.Ho)(r).join(", "));const s={layerAdapter:l,...n,view:i};await i.when();const o=null!=s.signal?{signal:s.signal}:null;if(await l.load(o),!e.forBinning&&"polygon"!==l.geometryType)throw new t.default("reference-size:not-supported",`reference-size is not supported for geometryType: ${l.geometryType}`);return s}(e),a=await i.layerAdapter.getSampleFeatures({sampleSize:-1,returnGeometry:!0,...i},"json");if(!a?.length)throw new t.default("reference-size:insufficient-info","No features are available to calculate statistics");return B(a,i)}var I=a(31650),F=a(99738),M=a(53680),q=a(51006),W=a(27208),A=a(42633),C=a(76281),R=a(94439);const J=2**53-1;async function G(e){if(!(e&&e.layer&&(e.field||e.valueExpression||e.sqlExpression)))throw new t.default("size-visual-variable:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.sqlExpression&&!e.view)throw new t.default("size-visual-variable:missing-parameters","View is required when 'valueExpression' is specified");if("reference-size"===e.theme&&!e.view&&!e.field)throw new t.default("size-visual-variable:missing-parameters","'view' and 'field' are required when 'theme' is 'reference-size'");if("reference-size"===e.theme&&e.valueExpression)throw new t.default("size-visual-variable:missing-parameters","'valueExpression' is not supported when 'theme' is 'reference-size'");e.forBinning&&(0,b.p)(e,"size-visual-variable");const i={...e},a=e.forBinning?S.Mi:S.J4,n=(0,S.Jg)(i.layer,a,e.forBinning);if(!n)throw new t.default("size-visual-variable:invalid-parameters","'layer' must be one of these types: "+(0,S.Ho)(a).join(", "));"height"===i.axis&&(i.sizeOptimizationEnabled=!1);const r=null!=i.signal?{signal:i.signal}:null;await n.load(r);const l=n.geometryType;if("mesh"===l)throw new t.default("size-visual-variable:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(i.worldScale){if("polyline"===l||"polygon"===l)throw new t.default("size-visual-variable:not-supported","'worldScale' sizing is not supported for polyline and polygon layers");if(!i.view||"3d"!==i.view.type)throw new t.default("size-visual-variable:invalid-parameters","'view' parameter should be an instance of SceneView when 'worldScale' parameter is true")}if("reference-size"===i.theme&&!e.forBinning&&"polygon"!==l)throw new t.default("size-visual-variable:invalid-parameters","Reference size is only supported for polygon layers");const s=await(0,A.EG)({field:i.field,normalizationField:i.normalizationField,valueExpression:i.valueExpression}),o=(0,q.MH)(n,s,"size-visual-variable:invalid-parameters");if(o)throw o;return await N(i),{...i,layer:n}}async function P(e){if(!(e&&e.layer&&(e.field||e.valueExpression||e.sqlExpression)))throw new t.default("size-continuous-renderer:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.sqlExpression&&!e.view)throw new t.default("size-continuous-renderer:missing-parameters","View is required when 'valueExpression' is specified");e.forBinning&&(0,b.p)(e,"size-continuous-renderer");const i={...e};i.symbolType=i.symbolType||"2d",i.defaultSymbolEnabled??=!0;const a=e.forBinning?S.Mi:S.J4,n=(0,S.Jg)(i.layer,a,e.forBinning);if(!n)throw new t.default("size-continuous-renderer:invalid-parameters","'layer' must be one of these types: "+(0,S.Ho)(a).join(", "));const r=null!=i.signal?{signal:i.signal}:null;await n.load(r);const l=n.geometryType,s=i.symbolType.includes("3d");if(i.outlineOptimizationEnabled="reference-size"!==i.theme&&"polygon"===l&&i.outlineOptimizationEnabled,"mesh"===l)throw new t.default("size-continuous-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(s&&("polyline"===l||"polygon"===l))throw new t.default("size-continuous-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(i.symbolType.includes("3d-volumetric")&&(!i.view||"3d"!==i.view.type))throw new t.default("size-continuous-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");if("reference-size"===i.theme&&!e.forBinning&&"polygon"!==l)throw new t.default("size-continuous-renderer:invalid-parameters","Reference size is only supported for polygon layers");const o=await(0,A.EG)({field:i.field,normalizationField:i.normalizationField,valueExpression:i.valueExpression}),u=(0,q.MH)(n,o,"size-continuous-renderer:invalid-parameters");if(u)throw u;return await N(i),{...i,layer:n}}async function N(e){const i=e.layer;if(("polygon"===i.geometryType||e.forBinning)&&e.view&&e.field&&!e.valueExpression&&(!e.theme||"reference-size"===e.theme)){try{e.referenceSizeResult=e.referenceSizeResult??await O({layer:i,view:e.view,filter:e.filter,forBinning:e.forBinning,signal:e.signal})}catch{}!e.theme&&e.referenceSizeResult?.isGrid&&(e.theme="reference-size"),e.referenceSizeOptions?.symbolStyle||(e.referenceSizeOptions?e.referenceSizeOptions.symbolStyle="circle":e.referenceSizeOptions={symbolStyle:"circle"})}}async function U(e){if(!e||!(e.layer&&e.view&&e.sizeStops))throw new t.default("update-renderer-with-reference-size:missing-parameters","'layer', 'view and 'sizeStops' parameters are required");const{view:i,forBinning:a}=e,n=e.forBinning?S.Mi:S.J4,r=(0,S.Jg)(e.layer,n,e.forBinning);if(!r)throw new t.default("update-renderer-with-reference-size:invalid-parameters","'layer' must be one of these types: "+(0,S.Ho)(n).join(", "));const l=r.layer;let s=e.renderer;if(!s)if(e.forBinning){if(!("featureReduction"in l&&l.featureReduction&&"renderer"in l.featureReduction&&l.featureReduction.renderer)||"class-breaks"!==l.featureReduction.renderer.type&&"unique-value"!==l.featureReduction.renderer.type)throw new t.default("update-renderer-with-reference-size:invalid-parameters","Feature reduction renderer is not supported");s=l.featureReduction.renderer}else{if(!("renderer"in l)||!l.renderer||"class-breaks"!==l.renderer.type&&"unique-value"!==l.renderer.type)throw new t.default("update-renderer-with-reference-size:invalid-parameters","Renderer is not supported");s=l.renderer}const o=s.authoringInfo;if(!o||!o?.visualVariables?.some((e=>"reference-size"===e.theme)))throw new t.default("update-renderer-with-reference-size:invalid-parameters","'renderer.authoringInfo.visualVariables' should have an authoringInfoVisualVariable with 'theme' set to 'reference-size'");const u=e.isGrid??(await O({view:i,layer:l,forBinning:a}))?.isGrid;return{...e,isGrid:u,renderer:s,layer:r}}async function L(e){if(!e||!e.layer||!e.field&&!e.valueExpression)throw new t.default("size-class-breaks-renderer:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");if(e.valueExpression&&!e.view)throw new t.default("size-class-breaks-renderer:missing-parameters","View is required when 'valueExpression' is specified");e.forBinning&&(0,b.p)(e,"size-class-breaks-renderer");const i={...e};i.symbolType=i.symbolType||"2d",i.defaultSymbolEnabled??=!0,i.classificationMethod??="equal-interval",i.normalizationType=(0,A.Wy)(i);const a=e.forBinning?S.Mi:S.J4,n=(0,S.Jg)(i.layer,a,e.forBinning);if(!n)throw new t.default("size-class-breaks-renderer:invalid-parameters","'layer' must be one of these types: "+(0,S.Ho)(a).join(", "));if((null==i.minValue||null==i.maxValue)&&(null!=i.minValue||null!=i.maxValue))throw new t.default("size-class-breaks-renderer:missing-parameters","Both 'minValue' and 'maxValue' are required when specifying custom data range");const r=null!=i.signal?{signal:i.signal}:null;await n.load(r);const l=n.geometryType,s=i.symbolType.includes("3d");if(i.outlineOptimizationEnabled="polygon"===l&&i.outlineOptimizationEnabled,"mesh"===l)throw new t.default("size-class-breaks-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(s&&("polyline"===l||"polygon"===l))throw new t.default("size-class-breaks-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(i.symbolType.includes("3d-volumetric")&&(!i.view||"3d"!==i.view.type))throw new t.default("size-class-breaks-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");const o=await(0,A.EG)({field:i.field,normalizationField:i.normalizationField}),u=(0,q.MH)(n,o,"size-class-breaks-renderer:invalid-parameters");if(u)throw u;return{...i,layer:n}}function $(e){const i={...e};delete i.basemap,delete i.sizeScheme,delete i.legendOptions,delete i.symbolType,delete i.defaultSymbolEnabled;const a=i;return a.analyzeData=!(null!=i.minValue&&null!=i.maxValue),a}function j(e){const i={...e},a=!!i.symbolType?.includes("3d-volumetric"),n=i;return n.worldScale=a,a&&(n.axis="3d-volumetric-uniform"===i.symbolType?"all":"height"),delete i.symbolType,delete i.defaultSymbolEnabled,n}async function H(e){if(!(e&&e.layer&&e.view&&e.startTime&&e.endTime))throw new t.default("size-age-renderer:missing-parameters","'layer', 'view', 'startTime', 'endTime' parameters are required");const i={...e};i.symbolType??="2d",i.defaultSymbolEnabled??=!0;const a=(0,S.Jg)(i.layer,S.J4);if(!a)throw new t.default("size-age-renderer:invalid-parameters","'layer' must be one of these types: "+(0,S.Ho)(S.J4).join(", "));const n=null!=i.signal?{signal:i.signal}:null;await a.load(n);const r=a.geometryType,l=i.symbolType.includes("3d");if(i.outlineOptimizationEnabled="polygon"===r&&i.outlineOptimizationEnabled,"mesh"===r)throw new t.default("size-age-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(l&&("polyline"===r||"polygon"===r))throw new t.default("size-age-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(i.symbolType.includes("3d-volumetric")&&(!i.view||"3d"!==i.view.type))throw new t.default("size-age-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");const s=(0,W.verifyDates)(a,i.startTime,i.endTime,"size-age-renderer:invalid-parameters");if(s)throw s;if(i.unit&&!W.supportedAgeUnits.includes(i.unit))throw new t.default("size-age-renderer:invalid-unit",`Supported units are: ${W.supportedAgeUnits.join(", ")}`);return{...i,layer:a}}async function _(e){let i=e.sizeScheme,a=null,n=null;const t=await(0,q.Ib)(e.basemap,e.view);if(a=null!=t.basemapId?t.basemapId:null,n=null!=t.basemapTheme?t.basemapTheme:null,i)return{scheme:(0,C.cloneScheme)(i),basemapId:a,basemapTheme:n};const r=(0,C.getSchemes)({basemapTheme:n,geometryType:e.geometryType,worldScale:e.worldScale,view:e.view});return r&&(i=r.primaryScheme,a=r.basemapId,n=r.basemapTheme),{scheme:i,basemapId:a,basemapTheme:n}}function X(e,i){switch(i){case"point":case"multipoint":{const i=e;return[(0,f.o)(i.minSize),(0,f.o)(i.maxSize)]}case"polyline":{const i=e;return[(0,f.o)(i.minWidth),(0,f.o)(i.maxWidth)]}case"polygon":{const i=e;return[(0,f.o)(i.marker.minSize),(0,f.o)(i.marker.maxSize)]}}}function Q(e,i){e.transformationType===h._w.ClampedLinear&&"below"===i&&e.flipSizes()}function Y(e,i){if("reference-size"===i.theme&&null!=e.min&&null!=e.max&&null!=e.avg&&null!=e.stddev){const i=100,a=0,n=0,t=1,r=e.avg,l=e.min,s=e.max,o=e.stddev,u=0!==r?o/r:0,c=l>n&&l<t&&s<2*t&&u<.5,d=l>a&&l<i&&s<2*i&&u<.5;return{minDataValue:c?n:d?a:l,maxDataValue:c?t:d?i:r+2*o,defaultValuesUsed:!1}}const{theme:a,field:n}=i,t=i.layer,r=n&&"function"!=typeof n?t.getField(n):null,l=(0,A.fs)(r);return(0,q.Gc)(e,a,l,"above"===a||"below"===a)}async function Z(e,i,a,n){const{theme:r,field:s,normalizationField:o,minValue:m,maxValue:f,axis:h}=e,w=e.layer.geometryType,v=await _({basemap:e.basemap,geometryType:w,sizeScheme:e.sizeScheme,worldScale:e.worldScale,view:e.view}),z=v.scheme;if(!z)throw new t.default("size-visual-variable:insufficient-info","Unable to find size scheme");const g=await async function(e,i,a,n,t){return"reference-size"===a&&i?[1,i.size]:e?[e.minSize,e.maxSize]:X(n,t)}(a,n,r,z,w),{minDataValue:b,maxDataValue:S,defaultValuesUsed:x}=Y(i,e),T=[],E="height"===h,V=E?h:void 0,k=g[0];let D=g[1];if(E&&"number"==typeof k&&"number"==typeof D){const e=(0,q.Nl)({minSize:k,maxSize:D},V);T.push(new p.default({axis:"width-and-depth",minSize:e.minSize})),D=e.maxSize}const B=new p.default({field:s??void 0,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle,valueUnit:"unknown",normalizationField:o,axis:V,minSize:k,maxSize:D,minDataValue:b,maxDataValue:S,legendOptions:(0,l.PZ)(y.A,e.legendOptions)});Q(B,r),T.unshift(B);const O=new d.default("reference-size"===r?{type:"size",field:e.field,normalizationField:e.normalizationField,sizeStops:(0,F.SB)(B).map((e=>{let{label:i,size:a,value:n}=e;return new c.A({label:i,size:a,value:n})})),theme:r,referenceSizeScale:n?.isGrid||e.sizeOptimizationEnabled?e?.view?.scale:void 0,referenceSizeSymbolStyle:e.referenceSizeOptions?.symbolStyle,minSliderValue:null!=m?m:i.min,maxSliderValue:null!=f?f:i.max}:{type:"size",theme:r,minSliderValue:null!=m?m:i.min,maxSliderValue:null!=f?f:i.max}),I=new u.default({visualVariables:[O]});return{basemapId:v.basemapId,basemapTheme:v.basemapTheme,visualVariables:T,statistics:i,isGrid:n?.isGrid,defaultValuesUsed:x,sizeScheme:(0,C.cloneScheme)(z),authoringInfo:I}}async function K(e,i,a,n,t){const r=await(0,s.ud)("esri/smartMapping/t9n/smartMapping"),l=t.layer,u=t.field,c=l.geometryType,d=t.defaultSymbolEnabled,m=(0,C.cloneScheme)(e.sizeScheme),p="polygon"===c,f=p?m.marker:m,y=p?m.background:null,h=p?"point":c,w=i?.opacity,v=e.isGrid,z="reference-size"===t.theme,g=z?[]:e.visualVariables.map((e=>e.clone()));i?.visualVariables?.length&&g.push(...i.visualVariables.map((e=>e.clone())));const b=z?(0,F.D8)({view:t.view,field:u,normalizationField:n,sizeStops:(0,F.SB)(e.visualVariables[0]),sizeByScaleEnabled:v||!!t.sizeOptimizationEnabled}):null;return{renderer:new o.default({backgroundFillSymbol:!v&&y?(0,q.v5)(c,{type:t.symbolType,color:y.color,outline:(0,q.qc)(y,c,w)}):null,classBreakInfos:[{minValue:-9007199254740991,maxValue:J,symbol:b?(0,F.zm)({type:t.referenceSizeOptions?.symbolStyle||"circle",color:f.color,primitiveOverrides:b}):(0,q.v5)(h,{type:t.symbolType,color:f.color,size:(0,q.N6)(f,h),outline:(0,q.qc)(f,h,w)})}],defaultLabel:d?r.other:null,defaultSymbol:d&&!z?(0,q.v5)(h,{type:t.symbolType,color:f.noDataColor,size:(0,q.N6)(f,h,!0),outline:(0,q.qc)(f,h,w)}):null,field:u,normalizationField:n,normalizationType:a,valueExpression:t.valueExpression,valueExpressionTitle:t.valueExpressionTitle,visualVariables:g,authoringInfo:e.authoringInfo?.clone()}),visualVariables:e.visualVariables.map((e=>e.clone())),statistics:e.statistics,defaultValuesUsed:e.defaultValuesUsed,isGrid:v,sizeScheme:(0,C.cloneScheme)(e.sizeScheme),basemapId:e.basemapId,basemapTheme:e.basemapTheme}}async function ee(e,i){const a=await(0,s.ud)("esri/smartMapping/t9n/smartMapping"),n=e.layer,t=e.defaultSymbolEnabled,l=n.geometryType,c="polygon"===l,d=e.symbolType?.includes("3d-volumetric"),p=await _({basemap:e.basemap,geometryType:l,sizeScheme:e.sizeScheme,worldScale:d,view:e.view}),f=p.scheme,{result:y,outlineResult:h}=i,w=y?.classBreakInfos??[],v=e.classificationMethod,z=e.normalizationType,g=c?f.marker:f,b=c?f.background:null,S=c?"point":l,x=X(g,S),T=d?(0,q.Nl)({minSize:x[0],maxSize:x[1]},"height"):null,E=function(e,i){const a=(0,r.cr)(e.minSize),n=((0,r.cr)(e.maxSize)-a)/(i>=4?i-1:i),t=[];for(let r=0;r<i;r++)t.push(a+n*r);return t}({minSize:x[0],maxSize:T?T.maxSize:x[1]},w.length),V=h?.opacity,k=new o.default({backgroundFillSymbol:b&&(0,q.v5)(l,{type:e.symbolType,color:b.color,outline:(0,q.qc)(b,l,V)}),classBreakInfos:w.map(((i,a)=>({minValue:i.minValue,maxValue:i.maxValue,symbol:(0,q.v5)(S,{type:e.symbolType,color:g.color,size:E[a],widthAndDepth:T?.minSize,outline:(0,q.qc)(g,S,V)}),label:i.label}))),defaultLabel:t?a.other:null,defaultSymbol:t?(0,q.v5)(S,{type:e.symbolType,color:g.noDataColor,size:(0,q.N6)(g,S,!0),widthAndDepth:T?.minSize,outline:(0,q.qc)(g,S,V)}):null,field:e.field,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle,normalizationType:z,normalizationField:e.normalizationField,normalizationTotal:"percent-of-total"===z?y?.normalizationTotal:void 0,legendOptions:e.legendOptions,authoringInfo:new u.default({type:"class-breaks-size",classificationMethod:v,standardDeviationInterval:e.standardDeviationInterval})});return"standard-deviation"!==v&&(0,m.setLabelsForClassBreaks)({classBreakInfos:k.classBreakInfos,classificationMethod:v,normalizationType:z,round:!0}),h?.visualVariables?.length&&(k.visualVariables=h.visualVariables.map((e=>e.clone()))),{renderer:k,sizeScheme:(0,C.cloneScheme)(f),classBreaksResult:y,defaultValuesUsed:!!i.defaultValuesUsed,basemapId:p.basemapId,basemapTheme:p.basemapTheme}}async function ie(e){const i=await G(e),{view:a,field:n,valueExpression:t,minValue:r,maxValue:l,layer:s,normalizationField:o,signal:u,statistics:c,filter:d}=i,m=o?"field":void 0,[p,f]=await Promise.all([c??(0,q.g2)({layer:s,field:n,valueExpression:t,sqlExpression:i.sqlExpression,sqlWhere:i.sqlWhere,normalizationType:m,normalizationField:o,filter:d,minValue:r,maxValue:l,view:a,signal:u}),i.sizeOptimizationEnabled?(0,I.default)({view:a,layer:s,signal:u,filter:d}).catch(q.ou):null]);return Z(i,p,f,i.referenceSizeResult)}async function ae(e){const{view:i,filter:a,renderer:n,signal:r,creatorParameters:l}=await async function(e){const i="regenerate-size-visual-variables";(0,M.AC)(e,i);const a=await(0,M.mE)(e),n=(0,M.UJ)(a);if(!n||!["size-continuous","univariate-color-size","color-size","relationship-size","type-size"].includes(n))throw new t.default(`${i}:invalid-parameters`,"Renderer is invalid");const r=(0,M.wx)(a,"size");if(!r)throw new t.default(`${i}:invalid-parameters`,"Renderer does not have a size visual variable authoringInfo");const l=r.theme,s="reference-size"===l,o=a.visualVariables?.find(M.OW);if(!o&&!s)throw new t.default(`${i}:invalid-parameters`,"Renderer does not have a size visual variable");let u=r.field,c=r.normalizationField,d=null,m=null;u||(o?.field?(u=o.field,c=o.normalizationField):a.field?(u=a.field,c=a.normalizationField):(d=o?.valueExpression??a.valueExpression,m=o?.valueExpressionTitle??a.valueExpressionTitle));const{layer:p,forBinning:f,filter:y,view:h,signal:w}=e,v=(0,M.Rv)(a),z=await G({layer:p,field:u,valueExpression:d,valueExpressionTitle:m,normalizationField:c,theme:l,sizeOptimizationEnabled:v,forBinning:f,filter:y,view:h,signal:w});return{...e,creatorParameters:z,renderer:a}}(e),{field:s,normalizationField:o,valueExpression:u,theme:d,layer:m,sizeOptimizationEnabled:f,referenceSizeResult:y,valueExpressionTitle:h}=l,w=o?"field":void 0,[v,z]=await Promise.all([(0,q.g2)({layer:m,field:s,valueExpression:u,normalizationField:o,normalizationType:w,filter:a,view:i,signal:r}),f?(0,I.default)({view:i,layer:m,signal:r,filter:a}).catch(q.ou):null]),g=function(e,i,a){return"reference-size"===a&&i?[1,i.size]:e?[e.minSize,e.maxSize]:null}(z,y,d),{minDataValue:b,maxDataValue:S}=Y(v,{theme:d,layer:m,field:s}),x=n.visualVariables?.find(M.OW),T=(x?.stops?null:x)??new p.default({field:s??void 0,valueExpression:u,valueExpressionTitle:h,valueUnit:"unknown",normalizationField:o});g&&(T.minSize=g[0],T.maxSize=g[1]),T.minDataValue=b,T.maxDataValue=S,Q(T,d);const E=(0,M.wx)(n,"size");return E.minSliderValue=v.min,E.maxSliderValue=v.max,"reference-size"===d&&(E.sizeStops=(0,F.SB)(T).map((e=>{let{label:i,size:a,value:n}=e;return new c.A({label:i,size:a,value:n})})),E.referenceSizeScale=y?.isGrid||f?i?.scale:void 0),{visualVariables:"reference-size"===d?[]:[T],isGrid:!!y?.isGrid,authoringInfo:n.authoringInfo?.clone(),statistics:v}}async function ne(e){const i=await P(e),a={layer:i.layer,view:i.view,filter:i.filter,signal:i.signal},[n,t]=await Promise.all([ie(j(i)),i.outlineOptimizationEnabled?(0,v.A)(a).catch(q.ou):null]),r=i.normalizationField;return K(n,t,r?"field":void 0,r,i)}async function te(e){const{renderer:i,view:a,signal:n,filter:r,creatorParameters:l,forBinning:s}=await async function(e){const i="regenerate-size-continuous-renderer";(0,M.AC)(e,i);const a=await(0,M.mE)(e),n=(0,M.UJ)(a);if(!n||!["size-continuous","univariate-color-size"].includes(n))throw new t.default(`${i}:invalid-parameters`,"Renderer is invalid");const{authoringInfo:r,field:l,normalizationField:s,valueExpression:o,valueExpressionTitle:u}=a,c=r?.visualVariables.find((e=>"size"===e.type)),d=c.theme,{layer:m,forBinning:p,filter:f,view:y,signal:h}=e,w=(0,M.DW)(a),v=(0,M.Rv)(a),z=await P({layer:m,field:l,valueExpression:o,valueExpressionTitle:u,normalizationField:s,theme:d,outlineOptimizationEnabled:w,sizeOptimizationEnabled:v,forBinning:p,filter:f,view:y,signal:h});return{...e,creatorParameters:z,renderer:a}}(e),{layer:o,outlineOptimizationEnabled:u,theme:c,referenceSizeResult:d}=l,[m,p]=await Promise.all([ae({...e,referenceSizeResult:d}),u?(0,v.A)({layer:o,view:a,filter:r,signal:n}).catch(q.ou):null]),f=m.isGrid,y="reference-size"===c;(0,M.ke)(i,m.visualVariables,M.Jy),(0,M.ke)(i,p?.visualVariables,M._i),(0,M.Hj)(i,m.authoringInfo,"size");const h=m.statistics;return y?{renderer:await re({layer:o,renderer:i,view:a,forBinning:s,sizeStops:(0,M.wx)(i,"size","reference-size")?.sizeStops,isGrid:f}),isGrid:f,statistics:h}:{renderer:i,statistics:h}}async function re(e){const{layer:i,referenceSizeOptions:a,renderer:r,sizeScheme:l,sizeStops:s,typeScheme:o,view:d,isGrid:m}=await U(e),p=r.clone();p.authoringInfo??=new u.default;const f=p.authoringInfo.visualVariables.find((e=>"reference-size"===e.theme)),y=e.field??f?.field,h=e.normalizationField??f?.normalizationField;if(!y)throw new t.default("update-renderer-with-reference-size:invalid-parameters","'field' parameter or authoring info with 'field' is required.");const w=(0,F.D8)({view:d,field:y,normalizationField:h,sizeStops:s,sizeByScaleEnabled:m||!!e.sizeOptimizationEnabled}),v=a?.symbolStyle||f?.referenceSizeSymbolStyle||"circle";if("class-breaks"===p.type){const e="polygon"===("geometryType"in i?i.geometryType:null)&&l&&"marker"in l?l.marker:null;p.classBreakInfos.forEach((i=>{const a=e?.color??(0,R.Sx)(i.symbol,1);"cim"===i.symbol.type?(0,F.oz)(i.symbol,{type:v,color:a,primitiveOverrides:w}):a&&(i.symbol=(0,F.zm)({type:v,color:a,primitiveOverrides:w}))}))}else if("unique-value"===p.type){const e=p.uniqueValueGroups,a="polygon"===("geometryType"in i?i.geometryType:null)&&o&&"colors"in o?o.colors:null,t=a?(0,n.Iy)(a,p.uniqueValueInfos?.length??0):null;let r=0;if(e){for(const i of e)for(const e of i.classes??[]){const i=t?t[r]:(0,R.Sx)(e.symbol,1);"cim"===e.symbol?.type?(0,F.oz)(e.symbol,{type:v,color:i,primitiveOverrides:w}):i&&(e.symbol=(0,F.zm)({type:v,color:i,primitiveOverrides:w})),r++}p.uniqueValueGroups=e}}return f&&(f.field=y,f.normalizationField=h,f.sizeStops=s.map((e=>{let{label:i,size:a,value:n}=e;return new c.A({label:i,size:a,value:n})})),f.referenceSizeScale=m||e.sizeOptimizationEnabled?d.scale:void 0,f.referenceSizeSymbolStyle=v),p}async function le(e){const i=await L(e);return ee(i,await(0,q.Pv)($(i),i.outlineOptimizationEnabled))}async function se(e){const{renderer:i,creatorParameters:a}=await async function(e){const i="regenerate-size-class-breaks-renderer";await(0,M.AC)(e,i);const a=await(0,M.mE)(e);if("size-class-breaks"!==(0,M.UJ)(a))throw new t.default(`${i}:invalid-parameters`,"Renderer is invalid");const{authoringInfo:n,field:r,normalizationField:l,normalizationType:s,normalizationTotal:o,valueExpression:u,valueExpressionTitle:c}=a,{classificationMethod:d,standardDeviationInterval:m}=n,p=a.classBreakInfos.length,{layer:f,forBinning:y,filter:h,view:w,signal:v}=e,z=(0,M.DW)(a),g=await L({layer:f,field:r,valueExpression:u,valueExpressionTitle:c,normalizationType:s,normalizationField:l,normalizationTotal:o,classificationMethod:d,standardDeviationInterval:m,numClasses:p,outlineOptimizationEnabled:z,forBinning:y,filter:h,view:w,signal:v});return{...e,creatorParameters:g,renderer:a}}(e),{outlineOptimizationEnabled:n,normalizationType:r,classificationMethod:l}=a,{result:s,outlineResult:o}=await(0,q.Pv)($(a),n),u=s.classBreakInfos;if(a.numClasses!==u.length)throw new t.default("regenerate-class-breaks-renderer:invalid-parameters","The number of class breaks generated does not match the number of class breaks in the renderer.");return i.classBreakInfos.forEach(((e,i)=>{e.minValue=u[i].minValue,e.maxValue=u[i].maxValue,e.label=u[i].label})),i.normalizationTotal="percent-of-total"===r?s.normalizationTotal:void 0,"standard-deviation"!==l&&(0,m.setLabelsForClassBreaks)({classBreakInfos:i.classBreakInfos,classificationMethod:l,normalizationType:r,round:!0}),(0,M.ke)(i,o?.visualVariables,M._i),{renderer:i}}async function oe(e){const i=await H(e),{defaultSymbolEnabled:a,view:n,startTime:t,endTime:r,symbolType:l,minValue:s,maxValue:o,signal:u,filter:c,layer:d}=i,[m,p]=await Promise.all([i.unit?{unit:i.unit,statistics:null,valueExpression:null}:await(0,w.A)({view:n,layer:d,startTime:t,endTime:r,minValue:s,maxValue:o,signal:u,filter:c}),i.outlineOptimizationEnabled?(0,v.A)({layer:d,view:n,filter:c,signal:u}).catch(q.ou):null]),{unit:f,statistics:y}=m,{valueExpression:h,title:z}=await(0,q.l7)(i,f),g=await ie(j({layer:d,basemap:i.basemap,valueExpression:h,symbolType:l,statistics:y,legendOptions:{title:z},theme:i.theme,sizeScheme:i.sizeScheme,sizeOptimizationEnabled:i.sizeOptimizationEnabled,view:i.view,minValue:s,maxValue:o,filter:c,signal:u})),b={layer:d,valueExpression:h,defaultSymbolEnabled:a,symbolType:l},S=await K(g,p,null,null,b),x=S.renderer.authoringInfo?.visualVariables;return x?.forEach((e=>(0,q.f3)(e,t,r,f))),{...S,unit:f}}async function ue(e){const{renderer:i,creatorParameters:a}=await async function(e){const i="regenerate-size-age-renderer";await(0,M.AC)(e,i);const a=await(0,M.mE)(e);if("size-age"!==(0,M.UJ)(a))throw new t.default(`${i}:invalid-parameters`,"Renderer is invalid");const{authoringInfo:n}=a,r=n?.visualVariables.find((e=>"size"===e.type)),l=r.startTime,s=r.endTime,o=r.units,u=r.theme,{layer:c,filter:d,view:m,signal:p}=e,f=(0,M.DW)(a),y=(0,M.Rv)(a),h=await H({layer:c,startTime:l,endTime:s,unit:o,theme:u,outlineOptimizationEnabled:f,sizeOptimizationEnabled:y,filter:d,view:m,signal:p});return{...e,creatorParameters:h,renderer:a}}(e),{layer:n,outlineOptimizationEnabled:r,sizeOptimizationEnabled:l,startTime:s,endTime:o,theme:u,view:c,signal:d,filter:m}=a,[p,f]=await Promise.all([(0,w.A)({view:c,layer:n,startTime:s,endTime:o,signal:d,filter:m}),r?(0,v.A)({layer:n,view:c,filter:m,signal:d}).catch(q.ou):null]),{unit:y,statistics:h}=p,{valueExpression:z,title:g}=await(0,q.l7)(a,y),b=await ie(j({layer:n,valueExpression:z,statistics:h,legendOptions:{title:g},sizeOptimizationEnabled:l,theme:u,view:c,filter:m,signal:d}));(0,M.ke)(i,b.visualVariables,M.Jy),(0,M.ke)(i,f?.visualVariables,M._i),i.authoringInfo=b.authoringInfo.clone();const S=i.authoringInfo?.visualVariables;return S?.forEach((e=>(0,q.f3)(e,s,o,y))),{renderer:i}}}}]);
//# sourceMappingURL=87990.88977492.chunk.js.map