"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[91505,95401],{770:(e,t,a)=>{a.d(t,{bG:()=>s,Ty:()=>o,YJ:()=>u,Fq:()=>c,vt:()=>l});var n=a(53084),i=a(42633);class r{constructor(e){const{name:t,label:a,description:n,schemes:r}=e;this.name=t,this.label=a,this.description=n,this.schemes=r;const s=e.basemapGroups||i.Np;let l=[];Object.keys(s).forEach((e=>{l=l.concat(s[e])})),this.supportedBasemaps=l,this.basemapGroups=s}isBasemapSupported(e){const t=(0,i.T1)(e,this.supportedBasemaps);return!(!t||!this.supportedBasemaps.includes(t))}getRawSchemes(e){const{basemapId:t,basemapTheme:a}=function(e,t,a){let n=null,r=null;if(t&&(n=(0,i.T1)(t,e,!1),n)){const e=(0,i.BV)(n);null!=e&&(r=e)}return!n&&a&&(n="dark"===a?"dark-gray":"gray",r=a),n||r||(n="gray",r="light"),{basemapId:n,basemapTheme:r}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let r=a;if(t){const e=(0,i.BV)(t,this.basemapGroups);null!=e&&(r=e)}let s=e.geometryType;"multipoint"===s?s="point":"mesh"===s&&(s="polygon");const l=this.schemes[s]||this.schemes.default;return{schemesInfo:(0,n.clone)(l[r]),basemapId:t,basemapTheme:a}}}function s(e){const t=e.themeDictionary,a=new Map;for(const n in t){const e=t[n];a.set(n,new r(e))}return a}function l(e,t){const a=[];return e.forEach((e=>{e.isBasemapSupported(t)&&a.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),a}function o(e,t){if(!e)return;if(!t)return;let a=null;const n=[t.primaryScheme,...t.secondarySchemes];for(const i of n)if(i.name?.toLowerCase()===e.toLowerCase()){a=i;break}return a}function u(e,t,a){if(!e&&!t)return[];if(!a)return[];const n=!e?.length,i=!t?.length,r=[a.primaryScheme,...a.secondarySchemes],s=[];for(const l of r){const a=!!n||e.some((e=>l.tags.includes(e))),r=!i&&t.some((e=>l.tags.includes(e)));a&&!r&&s.push(l)}return s}function c(e){const t=e.theme;if(t)return t.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},17782:(e,t,a)=>{a.r(t),a.d(t,{createRenderer:()=>I,regenerateRenderer:()=>D});var n=a(59784),i=a(50076),r=a(68002),s=a(47662),l=a(9922),o=a(33766);function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=Math.round(e);if(a<=1)return 1;const n=a.toString().length;for(let i=n-1>=3?3:n-1;i>=0;i--){const n=10**i,r=Math.floor(e/n)*n,s=Math.ceil(e/n)*n,l=Math.round((r+s)/2),o=Math.abs(e-r)/e*100,u=Math.abs(e-s)/e*100,c=Math.abs(e-l)/e*100,m=Math.min(o,u,c);if(m<=t){if(m===o){a=r;break}if(m===u){a=s;break}if(m===c){a=l;break}}}return a}var c=a(53680),m=a(51006),d=a(16525),p=a(28383),f=a(90494),y=a(42633),h=a(11563);async function b(e){const{layerAdapter:t,...a}=await async function(e){if(!(e&&e.layer&&e.attributes))throw new i.default("summary-statistics-for-attributes:missing-parameters","'layer' and 'attributes' parameters are required");if(e.attributes.some((e=>!!e.valueExpression))&&!e.view)throw new i.default("summary-statistics-for-attributes:missing-parameters","View is required when 'valueExpression' is specified in attributes");e.forBinning&&(0,f.p)(e,"summary-statistics-for-attributes");const{layer:t,...a}=e,n=[h.mb.CSVLayer,h.mb.FeatureLayer,h.mb.OGCFeatureLayer,h.mb.GeoJSONLayer,h.mb.KnowledgeGraphSublayer,h.mb.ParquetLayer,h.mb.WFSLayer],r=e.forBinning?h.Mi:n,s=(0,h.Jg)(t,r,e.forBinning);if(!s)throw new i.default("summary-statistics-for-attributes:invalid-parameters","'layer' must be one of these types: "+(0,h.Ho)(r).join(", "));const l={layerAdapter:s,...a};l.includeZeros=null==l.includeZeros||l.includeZeros,l.includeNegatives=null==l.includeNegatives||l.includeNegatives;const o=l.view,u=null!=l.signal?{signal:l.signal}:null;await Promise.all([o?.when(),s.load(u)]);const c=[];for(const i of l.attributes){const e=await(0,y.EG)({field:i.field,valueExpression:i.valueExpression});Array.prototype.push.apply(c,e)}const m=(0,p.MH)(s,c,"summary-statistics-for-attributes:invalid-parameters");if(m)throw m;return l}(e),n=(0,p.D9)(a.attributes,a.includeZeros,a.includeNegatives);return t.summaryStatistics({valueExpression:n.valueExpression,sqlExpression:n.sqlExpression,sqlWhere:n.sqlWhere,view:a.view,filter:a.filter,outStatisticTypes:y.XR,signal:a.signal})}var g=a(98976);function w(e,t,a){return null!=e&&isFinite(e)&&((t??!0)||0!==e)&&((a??!0)||e>=0)}async function v(e){const{features:t,attributes:a,includeZeros:n,includeNegatives:i,view:r}=e;let s=0,l=0,o=1/0,u=-1/0,c=null;const m=new Map;for(let p=0;p<a.length;p++){const{valueExpression:e}=a[p];if(e){if(!c){const{arcadeUtils:e}=await(0,g.lw)();c=e}m.set(p,c.createFunction(e))}}const d=r?c?.getViewInfo({viewingMode:"2d"===r.type?"map":r.viewingMode,scale:r.scale,spatialReference:r.spatialReference}):null;for(const p of t){const e=p.geometry,t=p.attributes;if(e){const f=e.extent;if(f){const e=f.width*f.height;if(e>0){let f=0;const y=c?.createExecContext(p,d,r?.timeZone);for(let e=0;e<a.length;e++){const{field:r,valueExpression:s}=a[e];let l=null;if(r)l=t[r];else if(s){const t=m.get(e);l=c.executeFunction(t,y)}w(l,n,i)&&(f+=l||0)}if(w(f,n,i)){const t=f/e;++s,l+=t,t<o&&(o=t),t>u&&(u=t)}}}}}return{minDensity:o!==1/0?o:null,maxDensity:u!==-1/0?u:null,avgDensity:s?l/s:null}}var S=a(91505);const E=500;async function x(e){const t=e.view;if(!(e?.layer&&t&&e.attributes?.length))throw new i.default("dot-density-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>8)throw new i.default("dot-density-renderer:invalid-parameters","Dot density renderer does not support more than 8 attributes");e.forBinning&&(0,f.p)(e,"dot-density-renderer");const a={...e,view:t,layer:e.layer,attributes:e.attributes},n=[h.mb.FeatureLayer,h.mb.ParquetLayer,h.mb.KnowledgeGraphSublayer,h.mb.OGCFeatureLayer,h.mb.GeoJSONLayer,h.mb.WFSLayer],r=e.forBinning?h.Mi:n,s=(0,h.Jg)(a.layer,r,e.forBinning);if(!s)throw new i.default("dot-density-renderer:invalid-parameters","'layer' must be one of these types: "+(0,h.Ho)(r).join(", "));a.dotBlendingEnabled??=!0,a.dotValueOptimizationEnabled??=!0;const l=null!=a.signal?{signal:a.signal}:null;if(await Promise.all([t.when(),s.load(l)]),"polygon"!==s.geometryType)throw new i.default("dot-density-renderer:not-supported","Dot density renderer is supported for polygon layers only");const o=[],u=a.attributes;for(const i of u){const e=await(0,y.EG)({field:i.field,valueExpression:i.valueExpression});o.push(...e)}const c=(0,m.MH)(s,o.filter(Boolean),"dot-density-renderer:invalid-parameters");if(c)throw c;return{...a,layer:s}}function T(e){return{dotValue:1,referenceScale:e.scale,minSliderValue:1,maxSliderValue:100}}async function V(e){const{view:t,layer:a,attributes:n,signal:i,filter:s}=e,l=await a.getSampleFeatures({view:t,sampleSize:E,returnGeometry:!0,filter:s,signal:i},"json"),[o,c]=await Promise.all([(0,d.A)({features:l,geometryType:a.geometryType}),b({layer:a,attributes:n,filter:s,includeZeros:!1,includeNegatives:!1,view:t,signal:i})]),m=null!=o&&"avgSize"in o&&o.avgSize,p=c.avg;if(!m||!p)return T(t);const f=(0,r.i1)(t.scale,t.spatialReference);return{dotValue:u(p/(m*m/(f*f)*.1))||1,referenceScale:t.scale,minSliderValue:1,maxSliderValue:u(p)}}async function B(e){const{view:t,layer:a,attributes:n,signal:i,filter:s}=e,l=[];for(const r of n){const e=await(0,y.EG)({field:r.field,valueExpression:r.valueExpression});l.push(...e)}const o=await a.getSampleFeatures({view:t,sampleSize:E,requiredFields:l,filter:s,returnGeometry:!0,signal:i},"json"),{minDensity:c,maxDensity:m,avgDensity:d}=await v({features:o,attributes:n,includeZeros:!1,includeNegatives:!1,view:t});if(!d||!c||!m)return T(t);const p=(0,r.i1)(t.scale,t.spatialReference),f=p*p,h=u(c*f),b=u(m*f);let g=u(d*f*10)||1;return g>b&&(g=b),{dotValue:g,referenceScale:t.scale,minSliderValue:h,maxSliderValue:b}}async function I(e){const t=await x(e),a=t.layer,r=a.geometryType,u=await async function(e){let t=e.dotDensityScheme,a=null,n=null;const i=await(0,m.Ib)(e.basemap,e.view);if(a=null!=i.basemapId?i.basemapId:null,n=null!=i.basemapTheme?i.basemapTheme:null,t)return{scheme:(0,S.cloneScheme)(t),basemapId:a,basemapTheme:n};const r=(0,S.getSchemes)({numColors:e.attributes.length,basemapTheme:n});return r&&(t=r.primaryScheme,a=r.basemapId,n=r.basemapTheme),{scheme:t,basemapId:a,basemapTheme:n}}(t),c=u?.scheme;if(!c)throw new i.default("dot-density-renderer:insufficient-info","Unable to find dot-density scheme");const d=t.view,p=t.filter,f={layer:a,view:d,filter:p,attributes:t.attributes,signal:t.signal},y={layer:t.layer,view:d,filter:p,signal:t.signal},[h,b]=await Promise.all([t.trueDensity?B(f):V(f),t.outlineOptimizationEnabled?(0,o.A)(y).catch(m.ou):null]),{dotValue:g,referenceScale:w,minSliderValue:v,maxSliderValue:E}=h,T=(0,n.Iy)(c.colors,t.attributes.length),I=t.attributes.map(((e,t)=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle,color:T[t]}))),D=new s.default({attributes:I,dotBlendingEnabled:t.dotBlendingEnabled,outline:b?(0,m.qc)(c,r,b.opacity):null,dotValue:g,referenceScale:t.dotValueOptimizationEnabled?w:null,legendOptions:t.legendOptions});return b?.visualVariables.length&&(D.visualVariables=b.visualVariables.map((e=>e.clone()))),D.authoringInfo=new l.default({type:"dot-density",minSliderValue:v,maxSliderValue:E}),{renderer:D,dotDensityScheme:c,basemapId:u.basemapId,basemapTheme:u.basemapTheme}}async function D(e){const{creatorParameters:t,renderer:a}=await async function(e){const t="regenerate-dot-density-renderer";await(0,c.AC)(e,t);const a=await(0,c.mE)(e);if("dot-density"!==(0,c.UJ)(a))throw new i.default(`${t}:invalid-parameters`,"Renderer is invalid");const{layer:n,forBinning:r,filter:s,view:l,signal:o}=e,u=(0,c.DW)(a),m=a.attributes.map((e=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle}))),d=await x({layer:n,attributes:m,dotValueOptimizationEnabled:null!=a.referenceScale,outlineOptimizationEnabled:u,forBinning:r,filter:s,view:l,signal:o});return{...e,creatorParameters:d,renderer:a}}(e),{layer:n,attributes:r,outlineOptimizationEnabled:s,view:l,signal:u,filter:d}=t,p={layer:n,view:l,filter:d,attributes:r,signal:u},[f,y]=await Promise.all([t.trueDensity?B(p):V(p),s?(0,o.A)({layer:n,view:l,signal:u,filter:d}).catch(m.ou):null]),{dotValue:h,referenceScale:b,minSliderValue:g,maxSliderValue:w}=f;return a.dotValue=h,a.referenceScale=t.dotValueOptimizationEnabled?b:null,a.authoringInfo&&(a.authoringInfo.minSliderValue=g,a.authoringInfo.maxSliderValue=w),(0,c.ke)(a,y?.visualVariables,c._i),{renderer:a}}},91505:(e,t,a)=>{a.r(t),a.d(t,{cloneScheme:()=>y,getSchemeByName:()=>p,getSchemes:()=>d,getSchemesByTag:()=>f,getThemes:()=>m});var n=a(69539),i=a(18690),r=a(59784),s=a(89132),l=a(770);const o={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"}},u=["vibrant-rainbow","cat-dark","predominant-v2","predominant-v1","predominance-race","desert-blooms","tropical-bliss","under-the-sea","ocean-bay","cat-light","predominant-v4","predominance-money","predominant-v3","predominance-race-ethnic","pastel-chalk","predominance-rainbow","predominance-sequence","cat-popup-olympic-sunset"],c=(0,l.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features using the density of randomly placed dots.",schemes:{default:{light:{primary:"predominant-v5",secondary:u,common:{outline:o.light,fillOpacity:.8}},dark:{primary:"predominant-v5",secondary:u,common:{outline:o.dark,fillOpacity:.8}}}}}}});function m(e){return(0,l.vt)(c,e)}function d(e){const t=(0,l.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,theme:c.get("default")});if(!t)return;const{schemesInfo:a,basemapId:n,basemapTheme:r}=t,s=a.common,o=e.numColors;return{primaryScheme:h(a.primary,s,o),secondarySchemes:a.secondary.map((e=>h(e,s,o))).filter(i.Ru),basemapId:n,basemapTheme:r}}function p(e){return(0,l.Ty)(e.name,d(e))}function f(e){return(0,l.YJ)(e.includedTags,e.excludedTags,d(e))}function y(e){if(!e)return;const t={...e};return t.tags=[...t.tags],t.colors&&(t.colors=t.colors.map((e=>new n.default(e)))),t.outline&&(t.outline={color:t.outline.color&&new n.default(t.outline.color),width:t.outline.width}),t}function h(e,t,a){const i=s.A[e];if(i)return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new n.default(e))),outline:{color:new n.default(e.outline.color),width:e.outline.width},opacity:e.opacity}}({name:i.name,tags:i.tags,colors:i[a]||(0,r.Iy)(i.stops,a),opacity:t.fillOpacity,outline:t.outline})}}}]);
//# sourceMappingURL=95401.e3fcd89d.chunk.js.map