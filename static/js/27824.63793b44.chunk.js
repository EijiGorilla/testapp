"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[27824],{27824:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var i=n(35143),r=n(69539),o=n(54901),s=n(56002),l=n(68134),a=n(41289),u=n(31633),c=n(46053),p=(n(81806),n(76460),n(47249),n(85842)),d=n(20664),v=n(9392),y=n(34111),h=n(95925),_=n(18722),f=n(88220),w=n(29808),m=n(3112),D=n(30310),g=n(84174);let I=class extends g.default{constructor(e){super(e),this.type="view",this.color=new r.default("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=(0,s.B)(((e,t,n,i,r,o,s)=>({inputGraphicUid:null!=e?x(e):null,visibleLayers:t,maxIntersectionDistance:n,intersectOptions:i,view:r,stationary:o,spatialReference:s}))),this._vecA=(0,v.vt)(),this._vecB=(0,v.vt)(),this._ray=(0,h.vt)()}get minDemResolution(){const e=this._viewModel?.view;if(null==e||"3d"!==e.type)return null;const t=e.pointsOfInterest?.focus?.worldUnitsPerContentPixel;return null==t?null:t*(0,u.G9)(e.spatialReference)}get queryElevationDependencies(){const e=this._view;return e?this._getQueryElevationDependencies(this._viewModel?.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,e,e.stationary,e.spatialReference):null}get _visibleLayers(){return this._view?.map?.allLayers?.filter((e=>e.visible)).toArray()??[]}get _intersectOptions(){const e=this._view;if(null==e||e.destroyed)return{};const t=(0,f.ZD)(e,{include:this.include,exclude:this.exclude}),n=(0,f.ZD)(e,{exclude:this._pointCloudLayers});return t.exclude=(0,a.KC)(t.exclude,n.exclude),t}get _pointCloudLayers(){const e=this._view;return null==e?[]:e.allLayerViews.toArray().filter((e=>"point-cloud"===e.layer?.type)).map((e=>e.layer))}get _view(){const e=this._viewModel?.view;return null!=e&&"3d"===e.type?e:null}get _maxIntersectionDistance(){const e=this._view;return e?.renderCoordsHelper?(0,y.tO)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(null==e)return null;const t=(0,w.hz)(e.state.viewingMode),n=t.options;return n.hud=!1,n.invisibleTerrain=!1,n.backfacesTerrain=!1,n.selectionMode=!1,n.store=m.oH.ALL,t}async queryElevation(e,t){let{noDataValue:n,signal:i}=t;const r=this.queryElevationDependencies;if(null==r)throw new Error("ElevationProfileLineInput: no dependencies");const o=this._intersector;if(null==o)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:s,view:l,spatialReference:a}=r,u=l.renderCoordsHelper,c=l.sceneIntersectionHelper,p=this._vecA,v=this._vecA,y=this._vecB,f=this._ray;if(!a)return{geometry:e,noDataValue:n};const w=await _.GeometryDescriptor.fromGeometry(e).project(a,i);if(!w)return{geometry:e,noDataValue:n};const m=w.coordinates,D=m.length;for(let _=0;_<D;++_){const e=m[_];(0,d.i)(y,e.x,e.y,e.z??0),u.toRenderCoords(y,a,y),u.setAltitude(p,2e5,y);const t=(0,h.Cr)(p,y,f);c.computeIntersection(t,o,s,!0);const i=M(r,o.results.all);i?(i.getIntersectionPoint(v),u.fromRenderCoords(v,v,a),e.z=v[2]):e.z=n}return{geometry:w.export(),noDataValue:n}}attach(e){const t=()=>this._onChange();return(0,o.vE)([super.attach(e),(0,l.watch)((()=>this.queryElevationDependencies),t),(0,l.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};function M(e,t){let{view:n,inputGraphicUid:i,maxIntersectionDistance:r}=e;for(const o of t){if(!o.withinDistance(r))continue;const e=(0,D.Gy)(o,n);if(null==e||x(e)!==i)return o}return null}function x(e){if(e.layer&&"objectIdField"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return`o-${e.layer.id}-${t}`}return`u-${e.uid}`}(0,i._)([(0,c.MZ)({type:r.default,nonNullable:!0})],I.prototype,"color",void 0),(0,i._)([(0,c.MZ)()],I.prototype,"viewVisualizationEnabled",void 0),(0,i._)([(0,c.MZ)()],I.prototype,"include",void 0),(0,i._)([(0,c.MZ)()],I.prototype,"exclude",void 0),(0,i._)([(0,c.MZ)({readOnly:!0})],I.prototype,"minDemResolution",null),(0,i._)([(0,c.MZ)()],I.prototype,"queryElevationDependencies",null),(0,i._)([(0,c.MZ)()],I.prototype,"_visibleLayers",null),(0,i._)([(0,c.MZ)()],I.prototype,"_intersectOptions",null),(0,i._)([(0,c.MZ)()],I.prototype,"_pointCloudLayers",null),(0,i._)([(0,c.MZ)()],I.prototype,"_view",null),(0,i._)([(0,c.MZ)()],I.prototype,"_maxIntersectionDistance",null),(0,i._)([(0,c.MZ)()],I.prototype,"_intersector",null),I=(0,i._)([(0,p.$)("esri.widgets.ElevationProfile.ElevationProfileLineView")],I);const E=I}}]);
//# sourceMappingURL=27824.63793b44.chunk.js.map