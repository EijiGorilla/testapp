"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[17483],{17483:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var s=i(35143),r=i(39356),a=i(18690),n=i(50076),o=i(76460),l=i(50346),u=i(60767),c=i(68134),h=i(46053),d=(i(81806),i(85842)),p=i(19247),g=i(9624),f=i(13312),w=i(86100),y=i(45417),v=i(3569),_=i(86875),m=i(8503),b=i(36693),F=i(90992),C=i(51007),M=i(85012),P=i(61640),E=i(68999),Z=i(79535);const A="location-scale-handle";let L=null;let V=class extends((0,Z.A)(E.A)){constructor(e){super(e),this._pendingPromises=new u.A,this._fetchFeaturesController=null,this._highlightPromises={"highlight-active-feature":null,"highlight-selected-feature":null},this._selectedClusterFeature=null,this.actions=new M.E$,this.activeFeature=null,this.autoCloseEnabled=!1,this.browseClusterEnabled=!1,this.content=null,this.defaultPopupTemplateEnabled=!1,this.featurePage=null,this.featuresPerPage=20,this.featureMenuOpen=!1,this.featureMenuTitle=null,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.initialDisplayMode="feature",this.selectedClusterBoundaryFeature=new r.default({symbol:new _.default({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null,this._debouncedLocationUpdate=(0,l.debounce)((async e=>{const{spatialReference:t}=this,s=this.selectedFeature?.geometry?.type,r=this.location??e;if(s&&"mesh"!==s&&t&&r&&this.selectedFeature)if("point"!==s)try{const e=this.selectedFeature;let s=e.geometry;const a=this._getHighlightLayer(e),n=e.getObjectId();if(!a||!this.view)return;if(n){const e=this.view?.allLayerViews.find((e=>e.layer.uid===a.uid));if(!e||!("queryFeatures"in e))return;const i=e.createQuery();i.outSpatialReference=t,i.objectIds=[n],i.returnGeometry=!0;const{features:r}=await e.queryFeatures(i);s=r[0]?.geometry}if(!s||"mesh"===s.type)return;if(s=(0,g.project)(s,t),L||(L=await i.e(56203).then(i.bind(i,56203))),!await L.intersects(s,r)){const t=(await L.nearestCoordinate(s,r)).coordinate??r;this.selectedFeature===e&&(this.location=t)}}catch(a){(0,l.isAbortError)(a)||o.A.getLogger(this).error(a)}else this.location=(0,w.z8)(this.selectedFeature.geometry)??r}))}initialize(){this.addHandles([this.on("view-change",(()=>this._autoClose())),(0,c.watch)((()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view]),(()=>this._highlightSelectedFeature())),(0,c.watch)((()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view]),(()=>this._highlightActiveFeature())),(0,c.watch)((()=>this.view?.animation?.state),(e=>this._animationStateChange(e))),(0,c.watch)((()=>this.location),(e=>this._locationChange(e))),(0,c.watch)((()=>this.selectedFeature),(e=>this._selectedFeatureChange(e))),(0,c.watch)((()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage]),(()=>this._selectedFeatureIndexChange())),(0,c.watch)((()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels]),(()=>this._setGraphicOnFeatureViewModels())),(0,c.watch)((()=>this.featureViewModels),(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>(0,P.DX)({event:e,viewModel:this,view:this.view}))),(0,c.when)((()=>!this.waitingForResult),(()=>this._waitingForResultChange()),c.sync),(0,c.watch)((()=>[this.features,this.map,this.spatialReference,this.timeZone]),(()=>this._updateFeatureVMs())),(0,c.watch)((()=>this.view?.scale),(()=>this._viewScaleChange())),(0,c.when)((()=>!this.visible),(()=>this.browseClusterEnabled=!1)),(0,c.watch)((()=>this.browseClusterEnabled),(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))])}destroy(){this._cancelFetchingFeatures(),this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null,this.map=null,this.spatialReference=null,this.timeZone=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new M.E$;e.removeAll();const{actions:t,defaultActions:i,defaultPopupTemplateEnabled:s,includeDefaultActions:r,selectedFeature:a}=this,n=r?i.concat(t):t,o=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(s)||a.popupTemplate),l=o?.actions,u=o?.overwriteActions?l:l?.concat(n)??n;return u?.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){const e=this._get("defaultActions")||new M.E$;return e.removeAll(),e.addMany((0,P.B_)(this.selectedFeature)?[M.HZ.clone(),M.po.clone()]:[M.RP.clone()]),e}get featureCount(){return this.features.length}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:i,promiseCount:s,selectedFeatureIndex:r}=this,a=s&&t.length;"list"!==this.initialDisplayMode?a&&i&&-1===r?this.selectedFeatureIndex=0:a&&-1!==r||(this.selectedFeatureIndex=t.length?0:-1):(!a||a&&i===s)&&(this.selectedFeatureIndex=-1)}set location(e){let t=e;const i=this.spatialReference?.isWebMercator,s=e?.spatialReference?.isWGS84;s&&i&&(t=(0,y.geographicToWebMercator)(e)),this._set("location",t)}get map(){return this.view?.map??null}set map(e){this._override("map",e)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){this._pendingPromises.clear(),this.features=[],Array.isArray(e)&&e.length?(this._set("promises",e),(e=e.slice()).forEach((e=>this._pendingPromises.add(e))),e.reduce(((e,t)=>e.finally((()=>t.then((e=>{this._pendingPromises.has(t)&&this._updateFeatures(e)})).finally((()=>this._pendingPromises.delete(t))).catch((()=>{}))))),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return-1===t?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;(isNaN(e)||e<0||!t)&&(e=-1),this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{view:e,map:t}=this;return e?e.ready?"ready":"disabled":t?"ready":"disabled"}get timeZone(){return this.view?.timeZone??b.qU}set timeZone(e){this._overrideIfSome("timeZone",e)}get waitingForContents(){return this.featureViewModels.some((e=>e.waitingForContent))}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}centerAtLocation(){const{view:e}=this,t=(0,P.V5)(this);return t&&e?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new n.default("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:i}=this;if(!i||!e)throw new n.default("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:i});return i.fetchPopupFeatures(e,{pointerType:t?.event?.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t?.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:i}=t;delete t.fetchFeatures,i&&this._setFetchFeaturesPromises(t.location);const s=["actionsMenuOpen","collapsed"];for(const r of s)delete t[r];this.set(t)}triggerAction(e){const t=this.allActions.at(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex+1,this.featureCount),this}previous(){return this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex-1,this.featureCount),this}disableClusterBrowsing(){(0,P.H2)(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;"2d"===e?.type?(0,P.B_)(t)?(await(0,P.xA)(this),await(0,P.d4)(this)):o.A.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):o.A.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}handleViewClick(e){this._fetchFeaturesAndOpen(e)}_getRoundRobinIndex(e,t){return(e+t)%t}_animationStateChange(e){this.zoomToLocation||(M.RP.disabled="waiting-for-target"===e)}_clearBrowsedClusterGraphics(){const e=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(a.Ru);this.view?.graphics?.removeMany(e),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if((0,P.B_)(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:i,view:s}=this;s&&i&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>0?Math.floor((this.selectedFeatureIndex+1)/this.featuresPerPage):null}_featureViewModelsChange(){this.featurePage=this.featureCount>0?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:i,featuresPerPage:s,featureViewModels:r}=this;if(null==i)return;const a=((i-1)*s+t)%t,n=a+s;r.slice(a,n).forEach(((t,i)=>{t&&(t.graphic??=e[a+i])}))}async _selectedFeatureChange(e){const{location:t,updateLocationEnabled:i,view:s}=this;if(!e||!s)return;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(s.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),(0,P.B_)(e))return;return e.symbol=await(0,m.getDisplayedSymbol)(e),this._selectedClusterFeature=e,void s.graphics.add(this._selectedClusterFeature)}const r=e.sourceLayer?.type;if("map-image"!==r&&"imagery"!==r&&"imagery-tile"!==r||(e.symbol=await(0,m.getDisplayedSymbol)(e)),!i&&t||!e.geometry){if(i&&!e.geometry){await this.centerAtLocation();const e=s.center?.clone();e&&(this.location=e)}}else this.location=(0,w.z8)(e.geometry)}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(e){const{pendingFeatures:t}=await this._fetchFeaturesWithController({mapPoint:e});this.promises=t}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:i,view:s,spatialReference:r,map:a,timeZone:n,location:o}=this;if((0,P.B_)(t[0])||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t?.length)return;const l=i.slice(),u=[];t.forEach(((t,i)=>{if(!t)return;let c=null;if(l.some(((e,i)=>(e&&e.graphic===t&&(c=e,l.splice(i,1)),!!c))),c)u[i]=c;else{const l=new C.default({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:r,graphic:t===e?t:null,location:o,map:a,view:s,timeZone:n});u[i]=l}})),l.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",u)}async _getScreenPoint(e,t){const{spatialReference:i,view:s}=this;if(!s)return null;await(s?.when());const r=e?.spatialReference;return r&&i?(await(0,g.initializeProjection)(r,i,null,t),s.toScreen(e)):null}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures(e){let{mapPoint:t,screenPoint:i,event:s,signal:r}=e;return this.fetchFeatures(i??await this._getScreenPoint(t??this.location,{signal:r}),{signal:r,event:s})}_fetchFeaturesWithController(e){let{mapPoint:t,screenPoint:i,event:s}=e;this._cancelFetchingFeatures();const r=new AbortController,{signal:a}=r;this._fetchFeaturesController=r;const n=this._projectScreenPointAndFetchFeatures({mapPoint:t,screenPoint:i,signal:a,event:s});return n.catch((()=>{})).then((()=>{this._fetchFeaturesController=null})),n}async _fetchFeaturesAndOpen(e){const{mapPoint:t,screenPoint:i}=e,{view:s}=this;this.removeHandles(A),this.addHandles([(0,c.watch)((()=>this.view?.scale),(()=>this._debouncedLocationUpdate(t).catch((e=>{(0,l.isAbortError)(e)||o.A.getLogger(this).error(e)})))),(0,c.when)((()=>!this.visible),(()=>{this.removeHandles(A)}),{once:!0})],A);const{pendingFeatures:r}=await this._fetchFeaturesWithController({mapPoint:t,screenPoint:i,event:e});s?.popup&&"open"in s.popup&&s.popup.open({location:t??void 0,promises:r})}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:i}=e;return i&&"layer"in i&&i.layer?i.layer:"map-notes"===i?.type||"subtype-group"===i?.type?i:t}_getHighlightLayerView(e,t){return"subtype-sublayer"===t.type&&t.parent&&this._mapIncludesLayer(t.parent)?this._getLayerView(e,t.parent):t&&this._mapIncludesLayer(t)?this._getLayerView(e,t):null}_getHighlightTarget(e,t,i){if(function(e,t){return"building-scene"===e||"2d"===t&&("map-image"===e||"tile"===e||"imagery"===e||"imagery-tile"===e)}(t.type,i))return e;const s=e.getObjectId();if(null!=s)return s;const r="imagery"===t.type?void 0:"objectIdField"in t?t.objectIdField||v.r:null,a=e.attributes;return a&&r&&a[r]||e}_mapIncludesLayer(e){return!!this.map?.allLayers?.includes(e)}async _highlightFeature(e,t){this.removeHandles(e);const i=this[t];if(!i)return;const{highlightEnabled:s,view:r,visible:a}=this;if(!r||!s||!a)return;const n=this._getHighlightLayer(i);if(!n)return;const o=this._getHighlightLayerView(r,n);if(!o)return;this._highlightPromises[e]=o;const l=await o;if(!(l&&(0,F.Of)(l)&&this._highlightPromises[e]===o&&this[t]&&this.highlightEnabled))return;const u=l.highlight(this._getHighlightTarget(i,n,r.type));this.addHandles(u,e)}async _highlightActiveFeature(){return this._highlightFeature("highlight-active-feature","activeFeature")}async _highlightSelectedFeature(){return this._highlightFeature("highlight-selected-feature","selectedFeature")}_updateFeatures(e){const{features:t}=this,i=e.filter((e=>!t.includes(e)));i?.length&&(this.features=t.concat(i))}};(0,s._)([(0,h.MZ)()],V.prototype,"_fetchFeaturesController",void 0),(0,s._)([(0,h.MZ)({type:M.E$})],V.prototype,"actions",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"active",null),(0,s._)([(0,h.MZ)()],V.prototype,"activeFeature",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"allActions",null),(0,s._)([(0,h.MZ)()],V.prototype,"autoCloseEnabled",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"browseClusterEnabled",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"content",void 0),(0,s._)([(0,h.MZ)({type:M.E$,readOnly:!0})],V.prototype,"defaultActions",null),(0,s._)([(0,h.MZ)({type:Boolean})],V.prototype,"defaultPopupTemplateEnabled",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"featureCount",null),(0,s._)([(0,h.MZ)()],V.prototype,"featurePage",void 0),(0,s._)([(0,h.MZ)({value:[]})],V.prototype,"features",null),(0,s._)([(0,h.MZ)()],V.prototype,"featuresPerPage",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"featureMenuOpen",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"featureMenuTitle",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"featureViewModelAbilities",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"featureViewModels",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"highlightEnabled",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"includeDefaultActions",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"initialDisplayMode",void 0),(0,s._)([(0,h.MZ)({type:p.default})],V.prototype,"location",null),(0,s._)([(0,h.MZ)()],V.prototype,"map",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"pendingPromisesCount",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"promiseCount",null),(0,s._)([(0,h.MZ)()],V.prototype,"promises",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"selectedClusterBoundaryFeature",void 0),(0,s._)([(0,h.MZ)({value:null,readOnly:!0})],V.prototype,"selectedFeature",null),(0,s._)([(0,h.MZ)({value:-1})],V.prototype,"selectedFeatureIndex",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"selectedFeatureViewModel",null),(0,s._)([(0,h.MZ)({type:f.default})],V.prototype,"spatialReference",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"state",null),(0,s._)([(0,h.MZ)()],V.prototype,"timeZone",null),(0,s._)([(0,h.MZ)()],V.prototype,"title",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"updateLocationEnabled",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"view",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"visible",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"waitingForContents",null),(0,s._)([(0,h.MZ)({readOnly:!0})],V.prototype,"waitingForResult",null),(0,s._)([(0,h.MZ)()],V.prototype,"zoomFactor",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"zoomToLocation",void 0),(0,s._)([(0,h.MZ)()],V.prototype,"centerAtLocation",null),V=(0,s._)([(0,d.$)("esri.widgets.Features.FeaturesViewModel")],V);const x=V},60767:(e,t,i)=>{i.d(t,{A:()=>a});var s=i(99486),r=i(99702);class a{constructor(e){this._observable=new r.I,this._set=new Set(e)}get size(){return(0,s.gc)(this._observable),this._set.size}add(e){const t=this._set.size;return this._set.add(e),this._set.size!==t&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const t=this._set.delete(e);return t&&this._observable.notify(),t}entries(){return(0,s.gc)(this._observable),this._set.entries()}forEach(e,t){(0,s.gc)(this._observable),this._set.forEach(((i,s)=>e.call(t,i,s,this)),t)}has(e){return(0,s.gc)(this._observable),this._set.has(e)}keys(){return(0,s.gc)(this._observable),this._set.keys()}values(){return(0,s.gc)(this._observable),this._set.values()}[Symbol.iterator](){return(0,s.gc)(this._observable),this._set[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}},61640:(e,t,i)=>{i.d(t,{B_:()=>c,DX:()=>l,H2:()=>w,Qb:()=>h,V5:()=>u,d4:()=>g,xA:()=>p});var s=i(50076),r=i(76460),a=i(50346),n=i(85012);const o=()=>r.A.getLogger("esri.widgets.Popup.PopupViewModel"),l=e=>{const{event:t,view:i,viewModel:r}=e,{action:o}=t;if(!o)return Promise.reject(new s.default("trigger-action:missing-arguments","Event has no action"));const{disabled:l,id:u}=o;if(!u)return Promise.reject(new s.default("trigger-action:invalid-action","action.id is missing"));if(l)return Promise.reject(new s.default("trigger-action:invalid-action","Action is disabled"));if(u===n.RP.id)return h(r).catch(a.throwIfNotAbortError);if(u===n.HZ.id)return d(r);if(u===n.po.id)return r.browseClusterEnabled=!r.browseClusterEnabled,r.featureMenuOpen=r.browseClusterEnabled,Promise.resolve();if(u===n.oq.id){r.visible=!1;const{selectedFeature:e}=r;if(!e)return Promise.reject(new s.default(`trigger-action:${n.oq.id}`,"selectedFeature is required",{selectedFeature:e}));const{sourceLayer:t}=e;return t?t.remove(e):i?.graphics.remove(e),Promise.resolve()}return Promise.resolve()};function u(e){const{selectedFeature:t,location:i,view:s}=e;return s?t??i??null:null}function c(e){return!!e&&e.isAggregate&&"cluster"===e.sourceLayer?.featureReduction?.type}async function h(e,t){const{location:i,selectedFeature:r,view:l,zoomFactor:c}=e;await(t?.viewModel?.updateGeometry());const h=t?.graphic,d=h?.geometry?h:u(e);if(!l||!d){const e=new s.default("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:d,view:l});throw o().error(e),e}const p=l.scale/c,f=h?.geometry??e.selectedFeature?.geometry??i,w=null!=f&&"point"===f.type&&await async function(e,t){if("3d"!==t?.type||!e||"esri.Graphic"!==e.declaredClass)return!0;const i=t.getViewForGraphic(e);if(i&&"whenGraphicBounds"in i){let t=null;try{t=await i.whenGraphicBounds(e,{useViewElevation:!0})}catch(s){}return!t||!t.boundingBox||t.boundingBox[0]===t.boundingBox[3]&&t.boundingBox[1]===t.boundingBox[4]&&t.boundingBox[2]===t.boundingBox[5]}return!0}(h??r,l);n.RP.active=!0,n.RP.disabled=!0;try{await e.zoomTo({target:{target:d,scale:w?p:void 0}})}catch(g){if((0,a.isAbortError)(g))return;const t=new s.default("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:h??r});o().error(t)}finally{n.RP.active=!1,n.RP.disabled=!1,e.zoomToLocation=null,w&&(e.location=f)}}async function d(e){const{selectedFeature:t,view:i}=e;if("2d"!==i?.type){const e=new s.default("zoomToCluster:invalid-view","View must be 2d MapView.",{view:i});throw o().error(e),e}if(!t||!c(t)){const e=new s.default("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:t});throw o().error(e),e}const[r,a]=await f(i,t);n.HZ.active=!0,n.HZ.disabled=!0;const{extent:l}=await r.queryExtent(a);l&&await e.zoomTo({target:l}),n.HZ.active=!1,n.HZ.disabled=!1}async function p(e){const{view:t,selectedFeature:i}=e;if(!t||!i)return;const[s,r]=await f(t,i),{extent:a}=await s.queryExtent(r);e.selectedClusterBoundaryFeature.geometry=a,t.graphics.add(e.selectedClusterBoundaryFeature)}async function g(e){const{selectedFeature:t,view:i}=e;if(!i||!t)return;const[s,r]=await f(i,t);n.po.active=!0,n.po.disabled=!0;const{features:a}=await s.queryFeatures(r);n.po.active=!1,n.po.disabled=!1,n.po.value=!0;const o={features:[t].concat(a)};"feature"===e?.initialDisplayMode&&(o.featureMenuOpen=!0),e?.open(o)}async function f(e,t){const i=await e.whenLayerView(t.sourceLayer),s=i.createQuery(),r=t.getObjectId();return s.aggregateIds=null!=r?[r]:[],[i,s]}function w(e){n.po.value=!1;const t=e.features.filter((e=>c(e)));t.length&&(e.features=t)}},68999:(e,t,i)=>{i.d(t,{A:()=>c});var s=i(35143),r=i(54099),a=i(68134),n=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),l=i(9624);let u=class extends r.A.EventedAccessor{constructor(e){super(e),this.location=null,this.screenLocationEnabled=!1,this.view=null,this.addHandles([(0,a.when)((()=>{const e=this.screenLocationEnabled?this.view:null;return e?[e.size,"3d"===e.type?e.camera:e.viewpoint]:null}),(()=>this.notifyChange("screenLocation"))),(0,a.watch)((()=>this.screenLocation),((e,t)=>{null!=e&&null!=t&&this.emit("view-change")}))])}destroy(){this.view=null}get screenLocation(){const{location:e,view:t,screenLocationEnabled:i}=this,s=t?.spatialReference,r=s?(0,l.projectOrLoad)(e,s).geometry:null;return i&&r&&t?.ready?t.toScreen(r):null}};(0,s._)([(0,n.MZ)()],u.prototype,"location",void 0),(0,s._)([(0,n.MZ)()],u.prototype,"screenLocation",null),(0,s._)([(0,n.MZ)()],u.prototype,"screenLocationEnabled",void 0),(0,s._)([(0,n.MZ)()],u.prototype,"view",void 0),u=(0,s._)([(0,o.$)("esri.widgets.support.AnchorElementViewModel")],u);const c=u},85012:(e,t,i)=>{i.d(t,{E$:()=>l,HZ:()=>h,RP:()=>u,oq:()=>c,po:()=>d});var s=i(19276),r=i(50037),a=i(16700),n=i(76192),o=i(15062);const l=s.default.ofType({key:"type",defaultKeyValue:"button",base:r.default,typeMap:{button:a.default,toggle:n.default}}),u=new a.default({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:o.T.zoomInMagnifyingGlass}),c=new a.default({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:o.T.trash}),h=new a.default({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:o.T.zoomInMagnifyingGlass}),d=new n.default({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:o.T.table,value:!1})}}]);
//# sourceMappingURL=17483.074c32ab.chunk.js.map