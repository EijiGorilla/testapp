"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[26964],{4583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var i=a(35143),s=a(91967),d=a(19276),r=a(67993),n=a(46053),o=(a(81806),a(76460),a(47249),a(85842)),l=a(99464),c=a(33377);let h=class extends((0,c.U)(s.default)){constructor(e){super(e),this.savedGraphics=new d.default,this.type="data-capture",this.pendingGraphics=new r.A}get collectionId(){return this.viewModel.collectionId}handleCreate(e){const{state:t,graphic:a,tool:i}=e,s=a?.geometry;if("complete"!==t||!a||!s)return;const{collectionId:r,viewModel:{dataCaptureLayer:n,currentBestFeature:o,imageGeometryField:c,oiObjectIdField:h,activeViewer:p,mode:u},pendingGraphics:v}=this,y=p?.imageSize;o&&c&&r&&h&&n&&y&&"none"!==u&&(function(e,t,a,i,s,r,n,o,c,h){e.sourceLayer=h,e.attributes=e.attributes??{},e.attributes[a]=btoa(JSON.stringify({geometry:(0,l.zT)(t.clone(),c,o).toJSON()})),e.attributes[i]=s.attributes.objectId,r.has(n)||r.set(n,new d.default),r.get(n).add(e)}(a,s,c,h,o,v,r,y,u,n),this.viewModel.emit("after-data-capture-complete",{pendingGraphics:v.get(r)?.toArray()??null}),this.viewModel.sketch?.create(i))}handleDelete(e){const{dataCaptureLayer:t}=this.viewModel;if(!t)return;const{graphics:a}=e;this.pendingGraphics.get(t.id)?.removeMany(a),this.savedGraphics.removeMany(a),this.viewModel.deleteDataCaptureFeatures(function(e,t){return e.map((e=>{let{attributes:a}=e;return t?a[t]:null})).filter(Boolean)}(a,t.objectIdField))}handleDestroy(){const{dataCaptureLayer:e}=this.viewModel;e&&(this.viewModel.stopDataCapture(),this.savedGraphics.removeAll(),this.pendingGraphics=null)}handleUpdate(e){const{toolEventInfo:t,state:a,graphics:i}=e;if(t)this.viewModel.sketch?.undo();else switch(a){case"complete":this.viewModel.emit("deselect-data-capture-features",{graphics:i});break;case"start":this.viewModel.emit("select-data-capture-features",{graphics:i})}}};(0,i._)([(0,n.MZ)()],h.prototype,"collectionId",null),(0,i._)([(0,n.MZ)()],h.prototype,"savedGraphics",void 0),(0,i._)([(0,n.MZ)()],h.prototype,"type",void 0),(0,i._)([(0,n.MZ)()],h.prototype,"pendingGraphics",void 0),h=(0,i._)([(0,o.$)("esri.widgets.OrientedImageryViewer.adapters.sketch.DataCaptureAdapter")],h);const p=h},33377:(e,t,a)=>{a.d(t,{U:()=>o});var i=a(35143),s=a(68134),d=a(46053),r=(a(81806),a(76460),a(47249),a(85842));const n="sketch-handles",o=e=>{let t=class extends e{initialize(){this.addHandles((0,s.watch)((()=>this.viewModel?.sketch),(e=>{this.removeHandles(n),e&&this.addHandles([e.on("create",(e=>this.handleCreate(e))),e.on("update",(e=>this.handleUpdate(e))),e.on("undo",(e=>this.handleUndo(e))),e.on("redo",(e=>this.handleRedo(e))),e.on("delete",(e=>this.handleDelete(e))),e.on("destroy",(()=>this.handleDestroy())),e.on("duplicate",(e=>this.handleDuplicate(e))),(0,s.watch)((()=>e.activeComponent),(e=>{"draw-2d"!==e?.type&&"draw-3d"!==e?.type||(e.elevationLockOnVertexAddDisabled=!0)}),s.syncAndInitial)],n)}),s.syncAndInitial))}handleCreate(e){}handleUpdate(e){}handleUndo(e){}handleRedo(e){}handleDelete(e){}handleDestroy(){}handleDuplicate(e){}};return(0,i._)([(0,d.MZ)()],t.prototype,"type",void 0),(0,i._)([(0,d.MZ)()],t.prototype,"viewModel",void 0),t=(0,i._)([(0,r.$)("esri.widgets.OrientedImageryViewer.mixins.SketchHandlerMixin")],t),t}}}]);
//# sourceMappingURL=26964.ced66cc9.chunk.js.map