"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[56166],{3320:(e,t,n)=>{n.d(t,{Au:()=>v,CU:()=>C,Et:()=>_,Gq:()=>M,H1:()=>k,HG:()=>N,Iy:()=>E,Kl:()=>K,Kn:()=>G,LZ:()=>V,TN:()=>w,U3:()=>Q,Ve:()=>z,XI:()=>F,bx:()=>T,cU:()=>Z,k_:()=>x,lB:()=>q,l_:()=>j,n4:()=>H,nT:()=>b,oc:()=>R,qG:()=>$,rf:()=>g,s9:()=>L,t6:()=>P,tM:()=>D,vp:()=>S,wr:()=>O});n(11265);var i=n(18690),r=n(4212),s=n(53084),l=n(76460),o=n(88685),a=n(71764),u=n(15142),d=n(53430),c=n(31933),m=n(42633),p=n(20639),f=n(23301),h=n(26547),y=n(39348);const g=e=>"field"===e?.type,_=e=>"group"===e?.type,b=e=>"relationship"===e?.type,x=e=>"text"===e.type,v=e=>"utilityNetworkAssociations"===e.type,T=e=>!_(e)&&null!=e.group,O=e=>e.reduce(((e,t)=>_(t)?[...e,...t.inputs]:[...e,t]),[]),E=e=>O(e).filter(g),Z=e=>O(e).filter(b),w=e=>O(e).filter(v),F=e=>null!=e&&(N(e,"combo-box")||N(e,"radio-buttons")),N=(e,t)=>null!=e&&e.input?.type===t,M=e=>{let{domain:t,inputType:n="text-box",dataType:i}=e;return"number"===i&&"text-box"===n&&(!t||"coded-value"!==t.type)};function S(e,t){const{title:n,feature:i}=e??{};return n||(i?(0,h.R)(i):null)||t||""}function V(e){const{attributes:t,fieldsIndex:n,label:r,timeZone:s}=e;if(!t||"object"!=typeof t)return r;const l=Object.keys(t).filter((e=>(0,o.mk)(r,e))),a=l.map((e=>t[e])),u=l.map((e=>n.get(e))).filter(i.Ru);return function(e,t){return(0,o.HC)((0,o.HC)(e,(e=>`{${e.toLowerCase()}}`)),Object.fromEntries(Object.entries(t).map((e=>{let[t,n]=e;return[t.toLowerCase(),n]}))))}(r,z({values:a,fields:u,timeZone:s}))}const A="expression/",I="expr/",U="field/";function R(e){const[t,n]=e.split(A);return""===t&&n?n:(l.A.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${A}/expressionName'`),"")}function P(e){return`${A}${e}`}function k(e){return`${U}${e}`}function L(e){return e.startsWith(A)}function $(e){return e.startsWith(I)}function z(e){const{fields:t,values:n}=e,i=e.timeZone??void 0,r=t.map(((e,t)=>{let r=n[t];if(e.domain&&"coded-value"===e.domain.type){const t=e.domain.codedValues.find((e=>e.code===r));t?.name&&(r=t.name)}return((0,m.fs)(e)||(0,d.isTimeOnlyField)(e))&&(r=(0,p.ZP)(e,r,{timeZone:i,...(0,p.ZT)(e)})),[e.name,r]}));return Object.fromEntries(r)}const C=e=>{const t={typeFieldName:null,types:[]};return e?((0,c.Sv)(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):"subtype-group"===e.type||"feature"===e.type&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map((e=>{let{id:t,name:n,domains:i}=e;return{code:t,name:n,domains:i}}))),null!=t.typeFieldName&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName),t):t},D=(e,t,n)=>{const{dataType:i,error:r,minLength:s}=e,l=t?.validationErrors;if(!l||!r)return null;if(r===f.gK.CANNOT_BE_EMPTY)return l.cannotBeNull;if(r===u.Mh.VALUE_OUT_OF_RANGE||r===d.NumericRangeValidationError.OUT_OF_RANGE){const{field:t,range:r}=e,s={type:"date",intlOptions:{timeZone:"date"===t.type&&n?n:void 0,...(0,p.ZT)(t)}},o=(0,f.hQ)(r,l);return(0,y.V)(o,r,{format:{max:"date"===i?s:null!=r.max&&(0,f.qn)(r.max)?f.Qv:f.PA,min:"date"===i?s:null!=r.min&&(0,f.qn)(r.min)?f.Qv:f.PA}})}return r===u.Mh.INVALID_CODED_VALUE?l.invalidCodedValue:r===d.TypeValidationError.INVALID_TYPE?l.invalidType:r===f.gK.TOO_SHORT?(0,y.V)(l.tooShort,{min:s}):(f.gK.TOO_LONG,null)},j=e=>{if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return"polyline"===i||"polyline"===n?"line":"mesh"===i||"mesh"===n||"multipatch"===n?"cube":"multipoint"===i||"multipoint"===n?"point":i||n||"table"},H=e=>{const t=[];if(e.formTemplate){const{description:n,title:i}=e.formTemplate;e.fields?.forEach((e=>{const r=i&&(0,o.mk)(i,e.name),s=n&&(0,o.mk)(n,e.name);(r||s)&&t.push(e.name)}))}return t};function q(e,t){const n=t??("formTemplate"in e&&e.formTemplate);return!!n&&(n.elements?.filter(a.jt)??[]).some((t=>{let{fieldName:n}=t;return!e.fieldsIndex.get(n)}))}function G(e,t){return null==e||t.onValue!==e&&t.offValue!==e}function K(e,t){switch(t.objectType){case"any":return!0;case"null":return null==e;case"code":return e===t.codedValue?.code;case"range":return null!=e&&null!=t.minValue&&null!=t.maxValue&&+e>=t.minValue&&+e<=t.maxValue;default:return(0,r.Xb)(t.objectType),!1}}function Q(e,t,n){const i=(0,c.fV)(e),r=i?.find((e=>e.code===n));if(!r)return!1;const l=i?.find((e=>e.code===t));return!(0,s.equalsShallow)(r.defaultValues,l?.defaultValues)&&Object.values(r.defaultValues).some((e=>null!=e))}},20639:(e,t,n)=>{n.d(t,{Ng:()=>O,OM:()=>g,Q0:()=>x,T8:()=>b,ZP:()=>T,ZT:()=>v,eX:()=>w,fD:()=>M,fb:()=>f,fl:()=>p,iP:()=>N,oh:()=>E,rX:()=>S,sH:()=>h,yk:()=>V});n(11265),n(81806);var i=n(50076),r=n(15941),s=n(65256),l=n(96017),o=n(85632),a=n(36693),u=n(24241),d=n(38042);const c=a.n$,m={date:null,time:null,timeZoneOffset:null},p=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]),f="latn",h=new Set(["date-only","time-only","timestamp-offset"]),y=e=>"valueAsDate"in e;function g(e){return{locale:(0,d.JK)(),numberingSystem:f,zone:e??c}}function _(e,t){return null==e?null:u.c9.fromMillis(e,g(t))}function b(e,t){if(null==e||!(0,o.Kg)(e)||""===e){if(t){const e=u.c9.local({zone:t});return{date:null,time:null,timeZoneOffset:e.isValid?e.offset.toString():null}}return m}const n=u.c9.fromISO(e,{setZone:!0});return{date:n.toFormat(l.mo,g()),time:n.toFormat(l.Uq.HMS_MS,g()),timeZoneOffset:n.offset.toString()}}function x(e,t){if(null==e||!(0,o.Et)(e)||isNaN(e))return m;const n=_(e,t);return n?{date:n.toFormat(l.mo,g(t)),time:n.toFormat(l.Fj,g(t))}:m}function v(e){switch(e.type){case"date":default:return(0,s.J2)("short-date-short-time");case"date-only":return(0,s.J2)("short-date");case"time-only":return(0,s.J2)("short-time");case"timestamp-offset":return{...(0,s.J2)("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function T(e,t,n){if(!e||null==t)return null;switch(e.type){case"date":return(0,s.Yq)(t,n);case"date-only":return(0,s.iS)(t,n);case"time-only":return(0,s.F8)(t,n);case"timestamp-offset":return(0,s.Ey)(t,n);default:return null}}function O(e){const{dateComponent:t,defaultTimeZone:n,timeComponent:i,timeZoneComponent:r,oldValue:s}=e;if(!t?.value)return null;const{year:o,month:d,day:c}=u.c9.fromFormat(t.value,l.mo),{hour:m,minute:p,second:f,millisecond:h}=Z(i,a.n$)??u.c9.now(),y=b(s,n),g=r?.value?parseInt(r.value,10):null!=y.timeZoneOffset?parseInt(y.timeZoneOffset,10):(new Date).getTimezoneOffset(),_=u.mQ.instance(g),x=u.c9.fromObject({year:o,month:d,day:c,hour:m,minute:p,second:f,millisecond:h},{zone:_});return x.isValid?x.toISO({includeOffset:!0}):null}function E(e){const{dateComponent:t,timeComponent:n,timeZone:i,max:r,min:s,oldValue:l}=e,o=Z(t,i);let a=!!e.applyRange;if(!o)return null;let d=null;if(null!=n?.value){const e=Z(n,i),t=Date.now(),s=null!=r&&r<t?r:t,l=u.c9.fromMillis(s,g(i)),a=o||l,{year:c,month:m,day:p}=a,{hour:f,minute:h,second:y,millisecond:_}=e||l;d=a.set({year:c,month:m,day:p,hour:f,minute:h,second:y,millisecond:_})}else{const e=_(F({value:l??Date.now(),max:r,min:s}),i),{year:t,month:n,day:u}=o,{hour:c,minute:m,second:p,millisecond:f}=e;a=!0,d=o.set({year:t,month:n,day:u,hour:c,minute:m,second:p,millisecond:f})}if(!d.isValid)return null;const c=d.toMillis();return a?F({value:c,max:r,min:s}):c}function Z(e,t){if(null==e?.value||Array.isArray(e.value))return null;let n=null;return n=y(e)?u.c9.fromFormat(e.value,l.mo,g(t)):(0,l.UE)(e.value),n?.isValid?n:null}function w(e){const{max:t,min:n,value:i}=e;return!isNaN(i)&&!(null!=t&&i>t)&&!(null!=n&&i<n)}function F(e){const{max:t,min:n,value:i}=e;return null!=t&&null!=n?(0,r.qE)(i,n,t):null!=t&&i>t?t:null!=n&&i<n?n:i}function N(e){if(!e)return"";const t=e.split(".").at(0);if(!t||t.length<1)throw new i.default("invalid time-only field",`Cannot parse valid time-only field value from ${e}`);const n=t.split(":"),r=new Array(3);for(let i=0;i<3;i++){const e=n.at(i)??"";r[i]=e.padStart(2,"0")}return r.join(":")}function M(e,t){switch(t){case"date":return e.getTime();case"date-only":return e.toISODate();case"time-only":return N(e.toISOTime(!0,!1));case"timestamp-offset":return e.toISOString(!1);default:return null}}function S(e){return!!e&&"object"==typeof e&&"getTime"in e&&"toISOString"in e&&"timeZone"in e}function V(e){const{type:t,range:n,value:i}=e;if(null==i||!n||i===n.min||i===n.max)return!0;if("date"===t)return w({value:i,min:n.min,max:n.max});const{rawMax:r,rawMin:s}=n;let o=null,a=null,u=null;switch(t){case"date-only":o=(0,l.Xi)(r),a=(0,l.Xi)(s),u=(0,l.Xi)(i);break;case"time-only":o=(0,l.UE)(r),a=(0,l.UE)(s),u=(0,l.UE)(i);break;case"timestamp-offset":o=(0,l.gz)(r),a=(0,l.gz)(s),u=(0,l.gz)(i)}return!u||w({value:u.valueOf(),min:a?.valueOf(),max:o?.valueOf()})}},23301:(e,t,n)=>{n.d(t,{$$:()=>v,D_:()=>m,Gd:()=>c,Kx:()=>i,PA:()=>g,Po:()=>p,Qv:()=>_,gK:()=>r,hQ:()=>x,jl:()=>h,of:()=>d,qn:()=>b,zU:()=>f});var i,r,s,l=n(71764),o=n(15142),a=n(53430),u=n(20639);(s=i||(i={})).Text="text",s.Number="number",s.Date="date",s.Unsupported="unsupported",function(e){e.CANNOT_BE_EMPTY="input-validation-error::cannot-be-empty",e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"}(r||(r={}));const d=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function c(e,t){const{dataType:n,domain:i,field:s,maxLength:l,minLength:d,range:c,required:m}=t;if(null==e)return m?r.CANNOT_BE_EMPTY:null;if("text"===n&&"string"==typeof e){if(d>-1&&e.length<d)return r.TOO_SHORT;if(l>-1&&e.length>l)return r.TOO_LONG}return"date"!==n||(0,u.yk)({type:s.type,range:c,value:e})?i?(0,o.wb)(s,e,i):(0,a.validateFieldValue)(s,e)??(0,o.wb)(s,e):a.NumericRangeValidationError.OUT_OF_RANGE}function m(e,t){return!(!p(e)||!p(t))||e===t}function p(e){return null==e||""===e}function f(e){let{dataType:t,field:n,input:r}=e;if(t===i.Date)return-1;const s=y(n.length);if(!r||!(0,l.AI)(r))return s;const o=y(r.maxLength);return-1===o?s:-1===s?o:Math.min(s,o)}function h(e){let{dataType:t,field:n,input:r}=e;if(t===i.Date)return-1;if(!r||!(0,l.AI)(r))return-1;const s=y(r.minLength);if(s<0)return-1;const o=y(n.length);return o>-1&&o<s?-1:s}function y(e){return"number"==typeof e&&e>-1?e:-1}const g={type:"number"},_={type:"number",intlOptions:{notation:"scientific"}};function b(e){return e>=1e7||e<=-1e7}function x(e,t){return null!=e.max&&null!=e.min?t.outsideRange:null!=e.max?t.outsideRangeMax:t.outsideRangeMin}const v=e=>e&&!Number.isNaN(e.valueOf())},26547:(e,t,n)=>{function i(e){const{attributes:t,sourceLayer:n}=e??{},i=n&&"displayField"in n?n.displayField:null,r=i?t?.[i]:null,s=null!=r?JSON.stringify(r):null,l=e?.getObjectId()?.toString();return s||l||""}n.d(t,{R:()=>i})},56166:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var i=n(35143),r=n(19276),s=n(67993),l=n(60767),o=n(90632),a=n(46053),u=(n(81806),n(76460),n(47249),n(85842)),d=n(19451),c=n(53430),m=n(3320),p=n(84668);let f;const h=["blockquote","html","hr","checkbox","table","tablerow","tablecell","image"];async function y(){const{Marked:e}=await n.e(20096).then(n.bind(n,20096)),t=()=>"",i={};for(const n of h)i[n]=t;f=new e({renderer:{del:function(e){let{text:t}=e;return`<span style="text-decoration:line-through;">${t}</span>`},link:function(e){let{href:t,text:n,title:i}=e;return`<a${null!=t?` href="${t}"`:""}${null!=i?` title="${i}"`:""} target="_blank">${n??""}</a>`},...i}})}var g=n(76099);let _=class extends p.A{constructor(e){super(e),this.group=null,this.id=`TextElementInput-${(0,o.c)()}`,this.type="text",this._expressionReferences=new s.A,this._expressionsUsed=new l.A,this._fieldsUsed=new l.A,this._literalParts=new r.default,this._templateParts=new r.default,this._updatingHandles=new d.U}initialize(){const{rawText:e}=this;e?"markdown"===this.textFormat?this._updatingHandles.addPromise(async function(e){return f||await y(),f.parse(e)}(e).then((e=>this._initializeTextParts(e)))):this._initializeTextParts(e):this._literalParts.push("")}get expressionsUsed(){return Array.from(this._expressionsUsed)}get fieldsIndex(){return this.layer.fieldsIndex}set fieldsIndex(e){this._overrideIfSome("fieldsIndex",e)}get fieldsUsed(){return Array.from(this._fieldsUsed)}get rawText(){return this.element.text}get text(){const e=this._templateParts.map((e=>`${this._expressionReferences.get(e)?.lastEvaluatedValue??""}`));return g.W5.sanitize(function(e,t){return t.reduce(((t,n,i)=>t.concat(e.at(i),n)),"").concat(e.at(-1))}(this._literalParts,e))}get textFormat(){return this.element.textFormat}get updating(){return this._updatingHandles.updating||Array.from(this._expressionReferences.values()).some((e=>e?.updating))}setExpressionExecutor(e,t){this._expressionReferences.set((0,m.t6)(e),t)}setFieldExecutor(e,t){this._expressionReferences.set((0,m.H1)(e),t)}_initializeTextParts(e){const{fieldsIndex:t}=this,{literals:n,templates:i}=function(e){const t=[...e.matchAll(/{[^{]+?}/g)];let n=0;const i=[],r=[];for(const s of t){const t=s[0];i.push(e.slice(n,s.index)),r.push(t),n=s.index+t.length}return i.push(e.slice(n)),{literals:i,templates:r}}(e),r=[],s=[];for(let l=0;l<i.length;l++){const e=n[l],o=(0,c.extractSubstitutionTemplatesFromString)(i[l])[0];if((0,m.s9)(o))this._expressionsUsed.add((0,m.oc)(o)),this._expressionReferences.set(o,null),r.push(e),s.push(o);else if((0,m.qG)(o)){this._expressionsUsed.add(o);const t=(0,m.t6)(o);this._expressionReferences.set(t,null),r.push(e),s.push(t)}else if(t?.has(o)){const n=t.normalizeFieldName(o);this._fieldsUsed.add(n);const i=(0,m.H1)(n);this._expressionReferences.set(i,null),r.push(e),s.push(i)}else n[l+1]=e.concat(o,n[l+1])}r.push(n.at(-1)),this._literalParts.addMany(r),this._templateParts.addMany(s)}};(0,i._)([(0,a.MZ)()],_.prototype,"expressionsUsed",null),(0,i._)([(0,a.MZ)()],_.prototype,"fieldsIndex",null),(0,i._)([(0,a.MZ)()],_.prototype,"fieldsUsed",null),(0,i._)([(0,a.MZ)()],_.prototype,"group",void 0),(0,i._)([(0,a.MZ)()],_.prototype,"id",void 0),(0,i._)([(0,a.MZ)()],_.prototype,"rawText",null),(0,i._)([(0,a.MZ)()],_.prototype,"text",null),(0,i._)([(0,a.MZ)()],_.prototype,"textFormat",null),(0,i._)([(0,a.MZ)()],_.prototype,"type",void 0),(0,i._)([(0,a.MZ)()],_.prototype,"updating",null),_=(0,i._)([(0,u.$)("esri.widgets.FeatureForm.TextElementInput")],_);const b=_},60767:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(99486),r=n(99702);class s{constructor(e){this._observable=new r.I,this._set=new Set(e)}get size(){return(0,i.gc)(this._observable),this._set.size}add(e){const t=this._set.size;return this._set.add(e),this._set.size!==t&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(e){const t=this._set.delete(e);return t&&this._observable.notify(),t}entries(){return(0,i.gc)(this._observable),this._set.entries()}forEach(e,t){(0,i.gc)(this._observable),this._set.forEach(((n,i)=>e.call(t,n,i,this)),t)}has(e){return(0,i.gc)(this._observable),this._set.has(e)}keys(){return(0,i.gc)(this._observable),this._set.keys()}values(){return(0,i.gc)(this._observable),this._set.values()}[Symbol.iterator](){return(0,i.gc)(this._observable),this._set[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}},84668:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(35143),r=n(91967),s=n(46053),l=(n(81806),n(76460),n(47249),n(85842)),o=n(3320);let a=class extends r.default{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(e){const{feature:t,layer:n,timeZone:i}=this;return null==n||null==e?e:(0,o.LZ)({label:e,attributes:t.attributes,fieldsIndex:n.fieldsIndex,timeZone:i})}};(0,i._)([(0,s.MZ)({readOnly:!0})],a.prototype,"description",null),(0,i._)([(0,s.MZ)({constructOnly:!0})],a.prototype,"element",void 0),(0,i._)([(0,s.MZ)()],a.prototype,"evaluatedVisibilityExpression",null),(0,i._)([(0,s.MZ)()],a.prototype,"feature",void 0),(0,i._)([(0,s.MZ)()],a.prototype,"label",null),(0,i._)([(0,s.MZ)()],a.prototype,"layer",void 0),(0,i._)([(0,s.MZ)()],a.prototype,"timeZone",void 0),(0,i._)([(0,s.MZ)()],a.prototype,"type",void 0),(0,i._)([(0,s.MZ)()],a.prototype,"updating",null),(0,i._)([(0,s.MZ)()],a.prototype,"visible",null),(0,i._)([(0,s.MZ)()],a.prototype,"visibilityExpressionExecutor",void 0),a=(0,i._)([(0,l.$)("esri.widgets.FeatureForm.InputBase")],a);const u=a}}]);
//# sourceMappingURL=56166.95e7f2c0.chunk.js.map