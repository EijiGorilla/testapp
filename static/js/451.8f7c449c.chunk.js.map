{"version":3,"file":"static/js/451.8f7c449c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/widgets/UtilityNetworkValidateTopology/UtilityNetworkValidateTopologyViewModel.js","../node_modules/@arcgis/core/portal/support/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../intl.js\";import i from\"../../core/Accessor.js\";import e from\"../../core/Collection.js\";import r from\"../../core/Error.js\";import s from\"../../core/Logger.js\";import{watch as o,initial as a,on as n}from\"../../core/reactiveUtils.js\";import{property as l}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/RandomLCG.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{UpdatingHandles as c}from\"../../core/support/UpdatingHandles.js\";import{isFeatureLayer as h,getOwningPortalUrl as p}from\"../../layers/support/layerUtils.js\";import y from\"../../portal/Portal.js\";import{hasUserTypeExtension as u}from\"../../portal/support/utils.js\";import{onLocaleChange as w}from\"../../intl/locale.js\";import{fetchMessageBundle as g}from\"../../intl/messages.js\";const v={noDirtyAreasInExtent:-2147208940,noUtilityNetworkExtension:-2147208474,cannotAcquireVersionLock_v10:-2147217146,cannotAcquireVersionLock_v11:-2147220947};let m=class extends i{constructor(t){super(t),this._activeOperationDidSucceed=!1,this._initialValidationsFinished=!1,this._dirtyAreasLayer=null,this._serverVersion=null,this._updatingHandles=new c,this._validConstructProperties=!1,this.executionError=\"\",this.extentToValidate=\"current\",this.loadErrors=new e}initialize(){const t=async()=>{this.messages||(this.messages=await g(\"esri/widgets/UtilityNetworkValidateTopology/t9n/UtilityNetworkValidateTopology\"))};t().then((()=>{this.view||(this.view=null),this.utilityNetwork||(this.utilityNetwork=null),this.addHandles([o((()=>[this.view,this.utilityNetwork]),(async()=>{const{loadErrors:t,messages:{info:{noUtilityNetwork:i,noView:e}}}=this;this._initialValidationsFinished=!1,t.removeAll(),this._validConstructProperties=!0,this._dirtyAreasLayer=null,this._serverVersion=null,\"utility\"!==this.utilityNetwork?.type&&(this.loadErrors.push(i),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-property\",i)),this._validConstructProperties=!1),\"2d\"!==this.view?.type&&(this.loadErrors.push(e),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-property\",e)),this._validConstructProperties=!1),this._validConstructProperties&&(this.utilityNetwork.loaded||await this.utilityNetwork.load().catch((t=>{s.getLogger(this).error(t),this._validConstructProperties=!1})),await this._setDirtyAreasLayer()),this._validConstructProperties&&await this._validateNetworkExtension()}),a),n((()=>this.view?.map?.layers),\"change\",(async()=>{const{loadErrors:t,messages:{info:{noUtilityNetwork:i}}}=this,e=t.find((t=>t===i));this._initialValidationsFinished=!1,e||(t.removeAll(),await this._validateNetworkExtension(),await this._setDirtyAreasLayer()),this._initialValidationsFinished=!0})),w(t)])}))}destroy(){this._updatingHandles.destroy()}get state(){return this.loadErrors.length||!this._validConstructProperties?\"disabled\":this.executionError?\"failed\":this._updatingHandles.updating?\"executing\":this._activeOperationDidSucceed?\"success\":this._initialValidationsFinished?\"ready\":\"loading\"}set utilityNetwork(t){this._get(\"utilityNetwork\")!==t&&this._set(\"utilityNetwork\",t)}set view(t){this._get(\"view\")!==t&&this._set(\"view\",t)}async validateTopology(){const{messages:{info:{cannotAcquireVersionLock:t,noDirtyAreasInExtent:i}},utilityNetwork:e,view:s}=this;if(!this.loadErrors.length){this._activeOperationDidSucceed=!1,this._set(\"executionError\",\"\");const o={gdbVersion:e?.gdbVersion,outSpatialReference:s.spatialReference?.clone()||null,validateArea:\"current\"===this.extentToValidate?s.extent.clone():e.fullExtent.clone()};this._updatingHandles.addPromise(e?.validateTopology(o).then((()=>{this._activeOperationDidSucceed=!0}),(e=>{let s=\"Error: \"+e;if(e instanceof r&&e.details?.raw)switch(e.details.raw.extendedCode){case v.noDirtyAreasInExtent:s=i;break;case v.cannotAcquireVersionLock_v10:case v.cannotAcquireVersionLock_v11:s=t;break;default:s=e.details.message}this._set(\"executionError\",s)})))}}async _setDirtyAreasLayer(){const{messages:{info:{noDirtyAreasLayer:t}}}=this,i=this.view?.map.allLayers.items.filter((t=>h(t))).find((t=>t.parsedUrl?.path===this.utilityNetwork?.networkSystemLayers.dirtyAreasLayerUrl));i?(this._dirtyAreasLayer=i,await this._dirtyAreasLayer.load(),this._serverVersion=this._dirtyAreasLayer.version??0,this._validConstructProperties=!0):(this.loadErrors.includes(t)||(this.loadErrors.push(t),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-layer\",t))),this._validConstructProperties=!1)}async _validateNetworkExtension(){const{messages:{info:{noAdvancedEditingUserTypeExtension:t,noUtilityNetworkServiceUserTypeExtension:i}}}=this,e=await p(this.utilityNetwork.layerUrl),o=new y({url:e});await o.load();const a=o.user?.username??\"\",n=Number(this._serverVersion)<=11.1?\"utilityNetwork\":\"advediting\";if(!await u(o,a,n)){const e=Number(this._serverVersion)<=11.1?i:t;this.loadErrors.push(e),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:no-user-type-extension\",e)),this._validConstructProperties=!1}this._initialValidationsFinished=!0}};t([l()],m.prototype,\"_initialValidationsFinished\",void 0),t([l()],m.prototype,\"_dirtyAreasLayer\",void 0),t([l()],m.prototype,\"_validConstructProperties\",void 0),t([l({readOnly:!0})],m.prototype,\"executionError\",void 0),t([l()],m.prototype,\"extentToValidate\",void 0),t([l()],m.prototype,\"loadErrors\",void 0),t([l()],m.prototype,\"messages\",void 0),t([l({readOnly:!0})],m.prototype,\"state\",null),t([l()],m.prototype,\"utilityNetwork\",null),t([l()],m.prototype,\"view\",null),m=t([d(\"esri.widgets.UtilityNetworkValidateTopology.UtilityNetworkValidateTopologyViewModel\")],m);const _=m;export{_ as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{id as e}from\"../../kernel.js\";import n from\"../../request.js\";async function r(r,t,s){const u=e?.findCredential(r.restUrl);if(!u)return null;if(\"loaded\"===r.loadStatus&&\"\"===t&&r.user?.sourceJSON&&!1===s)return r.user.sourceJSON;const o={responseType:\"json\",query:{f:\"json\"}};if(s&&(o.query.returnUserLicenseTypeExtensions=!0),\"\"===t){const e=await n(r.restUrl+\"/community/self\",o);if(e.data){const n=e.data;if(n?.username)return n}return null}const i=await n(r.restUrl+\"/community/users/\"+t,o);if(i.data){const e=i.data;return e.error?null:e}return null}async function t(e,n,t){const s=await r(e,n,!0);return s?.privileges?.includes(t)??!1}async function s(e,n,t){const s=await r(e,n,!0);return s?.userLicenseTypeExtensions?.includes(t)??!1}export{t as hasPrivilege,s as hasUserTypeExtension,r as lookupUser};\n"],"names":["v","m","i","constructor","t","super","this","_activeOperationDidSucceed","_initialValidationsFinished","_dirtyAreasLayer","_serverVersion","_updatingHandles","c","_validConstructProperties","executionError","extentToValidate","loadErrors","e","initialize","async","messages","g","then","view","utilityNetwork","addHandles","o","info","noUtilityNetwork","noView","removeAll","type","push","s","getLogger","error","r","loaded","load","catch","_setDirtyAreasLayer","_validateNetworkExtension","a","n","map","layers","find","w","destroy","state","length","updating","_get","_set","validateTopology","cannotAcquireVersionLock","noDirtyAreasInExtent","gdbVersion","outSpatialReference","spatialReference","clone","validateArea","extent","fullExtent","addPromise","details","raw","extendedCode","message","noDirtyAreasLayer","allLayers","items","filter","h","parsedUrl","path","networkSystemLayers","dirtyAreasLayerUrl","version","includes","noAdvancedEditingUserTypeExtension","noUtilityNetworkServiceUserTypeExtension","p","layerUrl","y","url","user","username","Number","u","l","prototype","readOnly","d","_","findCredential","restUrl","loadStatus","sourceJSON","responseType","query","f","returnUserLicenseTypeExtensions","data","privileges","userLicenseTypeExtensions"],"sourceRoot":""}