"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[91043],{90806:(e,t,i)=>{i.d(t,{M:()=>h,b:()=>d});var n=i(3799),s=i(58350),a=i(21390),r=i(86955),o=i(66470),l=i(2687),c=i(75569);function d(e){const t=new l.N5,{vertex:i,fragment:d}=t;(0,n.NB)(i,e),i.uniforms.add(new a.m("width",(e=>e.width))),t.attributes.add(o.r.POSITION,"vec3"),t.attributes.add(o.r.NORMAL,"vec3"),t.attributes.add(o.r.UV0,"vec2"),t.attributes.add(o.r.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add(r.H`vec3 bitangent = normal;
vtc = uv0;
vlength = length;
vradius = 0.5 * width;
vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);
gl_Position = proj * pos;`),d.uniforms.add(new a.m("outlineSize",(e=>e.outlineSize)),new s.E("outlineColor",(e=>e.outlineColor)),new a.m("stripeLength",(e=>e.stripeLength)),new s.E("stripeEvenColor",(e=>e.stripeEvenColor)),new s.E("stripeOddColor",(e=>e.stripeOddColor)));const h=1/Math.sqrt(2);return d.code.add(r.H`
    const float INV_SQRT2 = ${r.H.float(h)};

    vec4 arrowColor(vec2 tc, float len) {
      float d = INV_SQRT2 * (tc.x - abs(tc.y));
      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));
      d = min(d, 1.0 - abs(tc.y));

      if (d < 0.0) {
        return vec4(0.0);
      }
      if (d < outlineSize) {
        return outlineColor;
      }
      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;
    }`),d.main.add(r.H`
    vec2 ntc = vec2(vtc.x / vradius, vtc.y);
    vec4 color = arrowColor(ntc, vlength / vradius);
    if (color.a < ${r.H.float(c.Q)}) {
      discard;
    }
    fragColor = color;`),t}const h=Object.freeze(Object.defineProperty({__proto__:null,build:d},Symbol.toStringTag,{value:"Module"}))},91043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ve});var n=i(35143),s=i(91967),a=(i(81806),i(30726)),r=i(46053),o=i(76460),l=(i(47249),i(85842)),c=i(16159),d=i(2522),h=i(87562),u=i(24648),g=i(68134),_=i(31633),p=i(17430),v=i(29772),m=i(23739);let w=class extends s.default{constructor(e){super(e)}initialize(){this.addHandles([(0,g.watch)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),g.syncAndInitial),(0,g.watch)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),g.syncAndInitial),(0,g.watch)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),g.syncAndInitial)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view;return(0,p.B)(e,t,i)??((0,p.V)(this.analysis,e.spatialReference,o.A.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i,unit:n}=this.viewData;if(null==e||null==t)return null;const s=(0,v.NH)(e,t),a=(0,m.Og)(e,t);if(null==s)return null;let r,o;switch(i){case h.G.Auto:o=null!=a?"geodesic":"euclidean",r=a??s.horizontal;break;case h.G.Geodesic:if(null==a)return null;o="geodesic",r=a;break;case h.G.Euclidean:o="euclidean",r=s.horizontal}let l=s.direct,c=s.vertical;const d=(0,_.Vs)(l.value,l.unit,n),g=(0,_.Vs)(r.value,r.unit,n),p=(0,_.jE)(c.value,c.unit,n);return l=(0,u.kM)(l,d),r=(0,u.kM)(r,g),c=(0,u.kM)(c,p),{mode:o,directDistance:l,horizontalDistance:r,verticalDistance:c}}};(0,n._)([(0,r.MZ)()],w.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"viewData",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"_computedResult",null),w=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],w);i(11265);var y=i(59784),b=i(15941),L=i(11113),M=i(76931),f=i(19555),C=i(20664),A=i(9392),E=i(57612),O=i(4244),P=i(66747),S=i(7256),V=i(88321),z=i(13191),T=i(43047),D=i(55855),x=i(75762),R=i(32314),G=i(81923),Z=i(71372),H=i(62577),k=i(45463),N=i(48549),j=i(34981),I=i(59696),Q=i(77730),W=i(66470),U=i(16506),q=i(59246),B=i(60322),$=i(90806),F=i(93345),J=i(57162);class X extends q.w{constructor(e,t){super(e,t,new U.$($.M,(()=>i.e(59492).then(i.bind(i,59492)))),Y),this.primitiveType=F.WR.TRIANGLE_STRIP}initializePipeline(e){return(0,J.Ey)({blending:e.transparent?(0,B.Yf)(e.oitPass):null,polygonOffset:e.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:F.MT.LESS},depthWrite:J.Uy,colorWrite:J.kn})}}const Y=new Map([[W.r.POSITION,0],[W.r.NORMAL,1],[W.r.UV0,2],[W.r.LENGTH,3]]);var K=i(6485),ee=i(94570);class te extends ee.E{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}(0,n._)([(0,K.W)()],te.prototype,"polygonOffsetEnabled",void 0),(0,n._)([(0,K.W)()],te.prototype,"transparent",void 0);var ie=i(75569);class ne extends k.im{constructor(e){super(e,ae),this._configuration=new te,this.vertexAttributeLocations=Y,this.produces=new Map([[Q.N.OPAQUE_MATERIAL,e=>!this._transparent&&(0,j.RN)(e)],[Q.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>this._transparent&&(0,j.RN)(e)]])}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=t.oitPass,this._configuration}get visible(){const{outlineColor:e,stripeEvenColor:t,stripeOddColor:i}=this.parameters;return e[3]>=ie.Q||t[3]>=ie.Q||i[3]>=ie.Q}intersect(){}createGLMaterial(e){return new se(e)}createBufferWriter(){return new ue}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class se extends I.A{beginSlot(e){return this.getTechnique(X,e)}}class ae extends k.qA{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,D.fA)(1,.5,0,1),this.stripeEvenColor=(0,D.fA)(1,1,1,1),this.stripeOddColor=(0,D.fA)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const re=(0,N.BP)().vec3f(W.r.POSITION).vec3f(W.r.NORMAL).vec2f(W.r.UV0).f32(W.r.LENGTH),oe=(0,A.vt)(),le=(0,A.vt)(),ce=(0,A.vt)(),de=(0,A.vt)(),he=(0,A.vt)();class ue{constructor(){this.vertexBufferLayout=re}elementCount(e){return 2*(e.get(W.r.POSITION).indices.length/2+1)}write(e,t,i,n,s,a){const{data:r,indices:o}=i.get(W.r.POSITION),l=i.get(W.r.NORMAL).data,c=r.length/3;o&&o.length!==2*(c-1)&&console.warn("MeasurementArrowMaterial does not support indices");const d=oe,h=le,u=ce,g=de,_=he,p=s.position,v=s.normal,m=s.uv0;let w=0;for(let b=0;b<c;++b){const i=3*b;if((0,C.i)(d,r[i],r[i+1],r[i+2]),b<c-1){const e=3*(b+1);(0,C.i)(h,r[e],r[e+1],r[e+2]),(0,C.i)(_,l[e],l[e+1],l[e+2]),(0,C.n)(_,_),(0,C.d)(u,h,d),(0,C.n)(u,u),(0,C.e)(g,_,u),(0,C.n)(g,g)}const n=(0,C.j)(d,h);e&&t&&((0,C.t)(d,d,e),(0,C.t)(h,h,e),(0,C.t)(g,g,t));const s=a+2*b,o=s+1;p.setVec(s,d),p.setVec(o,d),v.setVec(s,g),v.setVec(o,g),m.set(s,0,w),m.set(s,1,-1),m.set(o,0,w),m.set(o,1,1),b<c-1&&(w+=n)}const y=s.length;for(let b=0;b<2*c;++b)y.set(a+b,w)}}class ge extends R.X{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,A.vt)(),this._originTransform=(0,z.vt)(),this._arrowCenter=(0,A.vt)(),this._renderOccluded=k.m$.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,D.vt)(),this._contrastColor=(0,D.vt)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial?.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,y.we)(e,this._color)||((0,T.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,y.we)(e,this._color)||((0,T.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new ne({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new V.default,this._handles.add((0,g.watch)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,a.pR)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(null==this._geometry?.startRenderSpace||null==this._geometry.endRenderSpace)return;const t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);t.transformation=this._originTransform,e.addGeometry(t),this._viewChanged()}_createArrowGeometry(e,t,i,n){const s=this.view,a=s.renderCoordsHelper,r=[],o=[],l=(e,t)=>{const n=x.rq.get();(0,C.d)(n,e,i),r.push(n),o.push(t)};if("euclidean"===n.type){n.eval(.5,this._arrowCenter);const i=x.rq.get();if(a.worldUpAtPosition(this._arrowCenter,i),function(e,t,i){const n=(0,C.a)(_e,t,e),s=(0,C.e)(_e,n,i);return 0===(0,C.H)(s)}(e,t,i)){const{heading:t,tilt:n}=s.camera,{direction:a}=(0,G.ZC)(s,e,t,n,pe);(0,C.c)(i,a)}l(e,i),l(t,i)}else{n.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),s=x.rq.get(),r=x.rq.get();n.eval(i,s),a.worldUpAtPosition(s,r),l(s,r)}}return(0,H.Z8)(this._arrowMaterial,r,o)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,n=e,s=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:n,stripeOddColor:s})}}const _e=(0,A.vt)(),pe=(0,Z.NP)();var ve=i(47996),me=i(25191),we=i(35925),ye=i(90659),be=i(38042),Le=i(63860);let Me=class extends s.default{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,n=(0,y.QP)(t),s=(0,y.f6)(t,.75),a=(0,y.QP)((0,y.bJ)(t)),r=(0,y.bJ)(i,y.pW.Low);return{accentColor:n,contrastColor:a,translucentAccentColor:s,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,y._L)(r,.6),textCalloutColor:(0,y._L)(r,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return E.n.None;const i=this.analysisView.result;if(null==i)return E.n.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?E.n.ProjectedGeodesic:E.n.Direct;const{verticalDistance:n,horizontalDistance:s}=i,a=(0,u.kM)(n,"meters").value,r=(0,u.kM)(s,"meters").value;return Math.min(a/r,r/a)<this.triangleCollapseRatioThreshold?E.n.Direct:E.n.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case h.G.Auto:return null!=t&&(0,u.kM)(t.horizontalDistance,"meters").value>ye.U7?"geodesic":"euclidean";case h.G.Euclidean:return"euclidean";case h.G.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,A.vt)(),this._endPosition=(0,A.vt)(),this._cornerPosition=(0,A.vt)(),this._startPositionAtSeaLevel=(0,A.vt)(),this._endPositionAtSeaLevel=(0,A.vt)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=E.f.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:n,triangleLineWidth:s,geodesicProjectionLineWidth:a,directLabelFontSize:r,verticalLabelFontSize:o,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new ge({...t,geometry:null,renderOccluded:k.m$.OccludeAndTransparent}),this._triangleVisualElement=new S.t({...t,width:s,renderOccluded:k.m$.OccludeAndTransparent}),this._rightAngleQuad=new ve.n({...t,renderOccluded:k.m$.OccludeAndTransparent});const c={...t,polygonOffset:!0,renderOccluded:k.m$.OccludeAndTransparent};this._projectedGeodesicLine=new S.t({...c,width:a,stipplePattern:(0,we.wk)(n)}),this._geodesicStartHint=new S.t({...c,width:i,stipplePattern:(0,we.wk)(n)}),this._geodesicEndHint=new S.t({...c,width:i,stipplePattern:(0,we.wk)(n)}),this._segmentLabel=new P.N({...t,fontSize:r}),this._verticalLabel=new P.N({...t,fontSize:o}),this._horizontalLabel=new P.N({...t,fontSize:l}),this.addHandles([(0,g.watch)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),g.syncAndInitial),(0,g.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),g.syncAndInitial),(0,g.watch)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),g.syncAndInitial),(0,g.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),g.syncAndInitial),(0,g.watch)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),g.syncAndInitial),(0,be.oQ)((async()=>this._updateMessageBundle())),(0,g.watch)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:n,translucentAccentColor:s,accentColor:a,contrastColor:r}=e;const{_segmentLabel:o,_verticalLabel:l,_horizontalLabel:c,_triangleVisualElement:d,_rightAngleQuad:h,_projectedGeodesicLine:u,_geodesicStartHint:g,_geodesicEndHint:_,_segmentVisualElement:p}=this;o.backgroundColor=t,o.calloutColor=i,o.textColor=n,l.backgroundColor=t,l.calloutColor=i,l.textColor=n,c.backgroundColor=t,c.calloutColor=i,c.textColor=n,d.color=s,h.color=s,u.color=s,g.color=s,_.color=s,p.color=a,p.contrastColor=r}),g.initial)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,a.pR)(this._segmentVisualElement),this._triangleVisualElement=(0,a.pR)(this._triangleVisualElement),this._rightAngleQuad=(0,a.pR)(this._rightAngleQuad),this._projectedGeodesicLine=(0,a.pR)(this._projectedGeodesicLine),this._geodesicStartHint=(0,a.pR)(this._geodesicStartHint),this._geodesicEndHint=(0,a.pR)(this._geodesicEndHint),this._segmentLabel=(0,a.pR)(this._segmentLabel),this._verticalLabel=(0,a.pR)(this._verticalLabel),this._horizontalLabel=(0,a.pR)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case E.n.None:break;case E.n.Direct:this._segmentVisualElement.visible=!0;break;case E.n.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case E.n.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:n,elevationAlignedStartPoint:s,elevationAlignedEndPoint:a,orientation:r,visualizedMeasurement:o,stripeLength:l}=e;const c=t.renderCoordsHelper;if(null==c||null==s||null==a||s.equals(a))return;let d=this._startPosition,h=this._endPosition;c.toRenderCoords(s,d),c.toRenderCoords(a,h);const u=r===E.f.AboveSegment?1:-1,g=u*(c.getAltitude(h)-c.getAltitude(d));g<0&&(d=this._endPosition,h=this._startPosition);const _="geodesic"===o?new me.J(this._startPosition,this._endPosition,c.spatialReference):new me.C(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=_,this._updateSegmentStripeLength(l),n){case E.n.Direct:this._updateSegment(_,r);break;case E.n.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:_,orientation:r,startPosition:d,endPosition:h,deltaSign:u,altitudeDelta:g});break;case E.n.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:r,startPosition:d,endPosition:h})}}_updateSegment(e,t){this._segmentLabel.anchor=t===E.f.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:n,orientation:s,startPosition:a,endPosition:r,deltaSign:o,altitudeDelta:l}=e;const c=this._cornerPosition;t.worldUpAtPosition(a,c),(0,C.h)(c,c,o*Math.abs(l)),(0,C.g)(c,c,a),this._triangleVisualElement.geometry=[[[a[0],a[1],a[2]],[c[0],c[1],c[2]],[r[0],r[1],r[2]]]],this._rightAngleQuad.geometry={previous:a,center:c,next:r};const d=new me.C(a,c),h=new me.C(c,r),u=function(e,t,i,n,s){const a=Ce,r=Ae;s.projectToRenderScreen(i,a),s.projectToRenderScreen(t,r);const o={segment:"bottom",horizontal:"top",vertical:a[0]<r[0]?"left":"right"};{const n=Ee,a=Oe;if((0,O.Q)(e,i,s,n),(0,O.Q)(e,t,s,a),(0,f.Om)(n,a)>=fe){const e=Math.sign(n[1])===Math.sign(a[1]);o.segment=e?(0,P.R)(o.vertical):o.vertical}else{const e=Pe;(0,O.Q)(i,t,s,e),(0,f.Om)(e,a)>=fe&&(o.segment=Math.sign(e[0])===Math.sign(a[0])?(0,P.R)(o.horizontal):o.horizontal)}}if(n===E.f.BelowSegment){const e=e=>"top"===e?"bottom":"top";o.segment=e(o.segment),o.horizontal=e(o.horizontal),o.vertical=e(o.vertical)}return o}(a,r,c,s,i);this._segmentLabel.anchor=u.segment,this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:d,sampleLocation:"center"},this._verticalLabel.anchor=u.vertical,this._horizontalLabel.geometry={type:"segment",segment:h,sampleLocation:"center"},this._horizontalLabel.anchor=u.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:n,endPosition:s}=e;t.setAltitude(this._startPositionAtSeaLevel,0,n),t.setAltitude(this._endPositionAtSeaLevel,0,s);const a=new me.J(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(a),this._geodesicStartHint.setGeometryFromSegment(new me.C(this._startPositionAtSeaLevel,n)),this._geodesicEndHint.setGeometryFromSegment(new me.C(this._endPositionAtSeaLevel,s)),this._segmentLabel.geometry={type:"segment",segment:a,sampleLocation:"center"},this._segmentLabel.anchor=i===E.f.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const n=this._segmentLabel,s=this._horizontalLabel,a=this._verticalLabel;if(n.visible=!1,s.visible=!1,a.visible=!1,t)switch(i){case E.n.Direct:n.visible=!0;break;case E.n.Triangle:n.visible=!0,s.visible=!0,a.visible=!0;break;case E.n.ProjectedGeodesic:n.visible=!0;case E.n.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:n,verticalDistance:s}=t,a=this.analysisView.unit,r=e=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(a){case"metric":return r({directDistance:i&&(0,L.Ee)(e,i),horizontalDistance:n&&(0,L.Ee)(e,n),verticalDistance:s&&(0,L.W4)(e,s)});case"imperial":return r({directDistance:i&&(0,L.tr)(e,i),horizontalDistance:n&&(0,L.tr)(e,n),verticalDistance:s&&(0,L.t_)(e,s)});default:return r({directDistance:i&&(0,L.zJ)(e,i,a),horizontalDistance:n&&(0,L.zJ)(e,n,a),verticalDistance:s&&(0,L.zJ)(e,s,a)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===E.f.Auto?this.view.state.camera.aboveGround?E.f.AboveSegment:E.f.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(!t?.state)return!1;const i=t.state.camera,n=t.renderCoordsHelper;if(!n)return!1;const s=i.computeScreenPixelSizeAt(e);return n.getAltitude(e)/s>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const n=e.directDistance;switch(t){case"metric":i=n&&(0,u.kM)(n,"meters");break;case"imperial":i=n&&(0,u.kM)(n,(0,_.OU)(n.value,n.unit));break;default:i=n&&(0,u.kM)(n,t)}return null==i?null:(0,b.Vr)(i.value/30)*(0,_.oU)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,Le.ud)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){}};(0,n._)([(0,r.MZ)()],Me.prototype,"_parameters",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_triangleOrientationOverride",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"messages",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"analysisView",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"loadingMessages",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"visible",null),(0,n._)([(0,r.MZ)()],Me.prototype,"viewMode",null),(0,n._)([(0,r.MZ)()],Me.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],Me.prototype,"visualElementOrientation",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"triangleCollapseRatioThreshold",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],Me.prototype,"labels",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_labelsText",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_actualVisualElementsOrientation",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_measurementArrowStripeLength",null),Me=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Me);const fe=Math.cos((0,b.kU)(12)),Ce=(0,M.r_)(),Ae=(0,M.r_)(),Ee=(0,M.QG)(),Oe=(0,M.QG)(),Pe=(0,M.QG)();let Se=class extends((0,d.P)(s.default)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=h.G.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Me({view:e,analysis:t,analysisView:this}),this._analysisController=new w({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,a.pR)(this._analysisController),this._analysisVisualization=(0,a.pR)(this._analysisVisualization)}get updating(){return!!this._analysisVisualization?.loadingMessages}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisVisualization.labels.direct?.text??""}get horizontalLabelText(){return this._analysisVisualization.labels.horizontal?.text??""}get verticalLabelText(){return this._analysisVisualization.labels.vertical?.text??""}get unit(){return this.analysis.unit??this._defaultUnit}get testData(){}};(0,n._)([(0,r.MZ)()],Se.prototype,"updating",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"type",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],Se.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"result",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"measurementMode",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"elevationAlignedStartPoint",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"elevationAlignedEndPoint",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"viewMode",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],Se.prototype,"visualElementOrientation",null),(0,n._)([(0,r.MZ)()],Se.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],Se.prototype,"triangleCollapseRatioThreshold",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"directLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"horizontalLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Se.prototype,"verticalLabelText",null),(0,n._)([(0,r.MZ)()],Se.prototype,"_analysisVisualization",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"_analysisController",void 0),(0,n._)([(0,r.MZ)()],Se.prototype,"unit",null),(0,n._)([(0,r.MZ)(c.q)],Se.prototype,"_defaultUnit",void 0),Se=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Se);const Ve=Se}}]);
//# sourceMappingURL=91043.34d3bda2.chunk.js.map