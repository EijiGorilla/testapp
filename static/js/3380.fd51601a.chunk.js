"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[3380,60831],{3380:(e,t,i)=>{i.r(t),i.d(t,{default:()=>y});var r=i(35143),n=i(63241),s=i(76460),a=i(68134),l=i(76931),o=i(46053),c=(i(81806),i(47249),i(85842)),d=i(50265),u=i(16159),p=i(25329);const h="esri-scale-bar",_={base:h,labelContainer:`${h}__label-container`,rulerLabelContainer:`${h}__label-container--ruler`,lineLabelContainer:`${h}__label-container--line`,topLabelContainer:`${h}__label-container--top`,bottomLabelContainer:`${h}__label-container--bottom`,label:`${h}__label`,line:`${h}__line`,topLine:`${h}__line--top`,bottomLine:`${h}__line--bottom`,ruler:`${h}__ruler`,rulerBlock:`${h}__ruler-block`,barContainer:`${h}__bar-container`,rulerBarContainer:`${h}__bar-container--ruler`,lineBarContainer:`${h}__bar-container--line`};var m=i(60831),b=i(98108),v=(i(76099),i(63582)),w=i(54761);function f(e,t){return(0,d.ZV)(e,{style:"unit",unit:t,unitDisplay:"short"})}let g=class extends p.default{constructor(e,t){super(e,t),this.messages=null,this.style="line",this.viewModel=new m.default,(0,n.ED)(s.A.getLogger(this),"Scale Bar","arcgis-scale-bar",{version:"4.32"})}initialize(){this.addHandles((0,a.watch)((()=>{const{view:e}=this;return[e?.stationary,e?.center,e?.scale,e?.zoom]}),(e=>{let[t]=e;t&&this.scheduleRender()})))}get icon(){return"actual-size"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this._defaultUnit}set unit(e){this._overrideIfSome("unit",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="disabled"===this.viewModel.state,t={[b.D.disabled]:e};let i,r;if(!e){const{unit:e,style:t}=this,n="metric"===e||"dual"===e,s=100,a="dual"===e?"line":t;if("imperial"===e||"dual"===e){const e=this.viewModel.getScaleBarProperties(s,"imperial");e&&(r="ruler"===a?this._renderRuler(e):this._renderLine(e,"bottom"))}if(n){const e=this.viewModel.getScaleBarProperties(s,"metric");e&&(i="ruler"===a?this._renderRuler(e):this._renderLine(e,"top"))}}return(0,w.K)("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(_.base,b.D.widget,t)},i,r)}_renderRuler(e){const{length:t,unit:i,value:r}=e,n=Math.round(t),s=f(r,i);return(0,w.K)("div",{class:this.classes(_.barContainer,_.rulerBarContainer),key:_.rulerBarContainer},(0,w.K)("div",{class:_.ruler,styles:{width:`${n}px`}},(0,w.K)("div",{class:_.rulerBlock}),(0,w.K)("div",{class:_.rulerBlock}),(0,w.K)("div",{class:_.rulerBlock}),(0,w.K)("div",{class:_.rulerBlock})),(0,w.K)("div",{class:this.classes(_.labelContainer,_.rulerLabelContainer)},(0,w.K)("div",{class:_.label},"0"),(0,w.K)("div",{class:_.label},s)))}_renderLine(e,t){const{length:i,unit:r,value:n}=e,s=Math.round(i),a=f(n,r),l={[_.topLabelContainer]:"top"===t,[_.bottomLabelContainer]:"bottom"===t},o=(0,w.K)("div",{class:this.classes(_.labelContainer,_.lineLabelContainer,l),key:_.labelContainer},(0,w.K)("div",{class:_.label},a)),c={[_.topLine]:"top"===t,[_.bottomLine]:"bottom"===t},d=(0,w.K)("div",{class:this.classes(_.line,c),key:_.line,styles:{width:`${s}px`}});return(0,w.K)("div",{class:this.classes(_.barContainer,_.lineBarContainer),key:_.lineBarContainer},[d,o])}_handleRootCreateOrUpdate(e){if(!this.viewModel)return;const{scaleComputedFrom:t}=this.viewModel,i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,n=i.top+window.pageYOffset,s=(0,l.tc)(r,n);(s.x!==t.x||s.y!==t.y)&&(this.viewModel.scaleComputedFrom=s)}};(0,r._)([(0,o.MZ)(u.q)],g.prototype,"_defaultUnit",void 0),(0,r._)([(0,o.MZ)()],g.prototype,"icon",null),(0,r._)([(0,o.MZ)()],g.prototype,"label",null),(0,r._)([(0,o.MZ)(),(0,v.G)("esri/widgets/ScaleBar/t9n/ScaleBar")],g.prototype,"messages",void 0),(0,r._)([(0,o.MZ)({type:["ruler","line"]})],g.prototype,"style",void 0),(0,r._)([(0,o.MZ)({type:["metric","imperial","dual"]})],g.prototype,"unit",null),(0,r._)([(0,o.MZ)()],g.prototype,"view",null),(0,r._)([(0,o.MZ)()],g.prototype,"viewModel",void 0),g=(0,r._)([(0,c.$)("esri.widgets.ScaleBar")],g);const y=g},60831:(e,t,i)=>{i.r(t),i.d(t,{default:()=>g});var r=i(35143),n=i(91967),s=i(76931),a=i(31633),l=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),c=i(19247),d=i(23701),u=i(13312),p=i(7137),h=i(73953),_=i(80963),m=i(45417),b=i(47818);function v(e){let{state:{paddedViewState:t},spatialReference:i,width:r}=e;return i.isWrappable&&t.worldScreenWidth<r}function w(e,t){const{x:i,y:r}=e?(0,m.webMercatorToGeographic)(t,!0):t;return[i,r]}let f=class extends n.default{constructor(e){super(e),this.scaleComputedFrom=(0,s.tc)(),this.view=null}get state(){return this.view?.ready&&"2d"===this.view.type?(0,b.O)(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(e,t){if("disabled"===this.state||isNaN(e)||!t||!this.view)return null;const i=this._getDistanceInMeters();return null==i?null:this._getScaleBarProps(e,i,t)}_getDistanceInMeters(){const{state:e,spatialReference:t}=this.view;if(!(0,_.fn)(t))return null;const{isGeographic:i}=t,r=function(e){const{isWebMercator:t,wkt:i,wkt2:r}=e;return t||((r||i)?.includes("WGS_1984_Web_Mercator")??!1)}(t);if(!i&&!r)return e.extent.width*((0,a.Ao)(t)??1);const[n,s]=this._getScaleMeasuringPoints(),l=r||i&&!(0,p.isSupported)(t)?u.default.WGS84:t,o=new d.default({paths:[[w(r,n),w(r,s)]],spatialReference:l}),c=(0,h.straightLineDensify)(o,10);let m;try{[m]=(0,p.geodesicLengths)([c],"meters")}catch{return null}return m}_getScaleMeasuringPoints(){const e=this.view,{width:t,height:i,position:r,spatialReference:n}=e;if(v(e)){const e=(0,_.Vp)(n),{valid:t}=e;return[new c.default(t[0],0,n),new c.default(t[1],0,n)]}let a=this.scaleComputedFrom.y-r[1];a>i?a=i:a<0&&(a=0);const l=(0,s.tc)(0,a),o=(0,s.tc)(t,a);return[e.toMap(l),e.toMap(o)]}_getScaleBarProps(e,t,i){const r=this.view,n=e*t/(v(r)?r.state.paddedViewState.worldScreenWidth:r.width);if(n<.001)return null;const s=function(e,t){switch(t){case"metric":return e>1e3?{distance:(0,a.oU)(e,"meters","kilometers"),unit:"kilometer"}:e>1?{distance:e,unit:"meter"}:e>.01?{distance:(0,a.oU)(e,"meters","centimeters"),unit:"centimeter"}:{distance:(0,a.oU)(e,"meters","millimeters"),unit:"millimeter"};case"imperial":return e>1609.344?{distance:(0,a.oU)(e,"meters","miles"),unit:"mile"}:e>.3048?{distance:(0,a.oU)(e,"meters","feet"),unit:"foot"}:{distance:(0,a.oU)(e,"meters","inches"),unit:"inch"}}}(n,i),{distance:l,unit:o}=s;let c=l,d=0;for(;c>=1;)c/=10,d++;const{min:u,max:p}=function(e){return e>.5?{min:.5,max:1}:e>.2?{min:.2,max:.5}:{min:.1,max:.2}}(c),h=p/c>=c/u?u:p;return{length:e*(h/c),value:10**d*h,unit:o}}};(0,r._)([(0,l.MZ)()],f.prototype,"scaleComputedFrom",void 0),(0,r._)([(0,l.MZ)({readOnly:!0})],f.prototype,"state",null),(0,r._)([(0,l.MZ)()],f.prototype,"view",void 0),f=(0,r._)([(0,o.$)("esri.widgets.ScaleBar.ScaleBarViewModel")],f);const g=f}}]);
//# sourceMappingURL=3380.fd51601a.chunk.js.map