"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[21964,27824,36974,43292,47609,59177,63733,89646,95327],{23037:(e,t,i)=>{i.r(t),i.d(t,{default:()=>X});var n=i(35143),s=i(39356),o=i(91967),r=i(18690),l=i(55877),a=i(19276),u=i(3975),h=i(76460),c=i(53521),p=i(30726),d=i(56002),_=i(68134),v=i(31633),y=i(46053),f=(i(81806),i(85842)),g=i(71630),m=i(16159),w=i(98773),b=i(54901),M=i(50346),P=i(79468),I=(i(47249),i(12482)),E=i(54054),S=i(57902),R=i(78369);const Z=Symbol("line-change");let k=class extends o.default{constructor(e){super(e),this._updateTask=null,this._paramsPerProfile=new Map,this._getUpdateParametersMemoized=(0,d.B)(((e,t,i)=>({stationary:e,visibleProfiles:t,generationParameters:i}))),this._getGenerationParametersMemoized=(0,d.B)(((e,t,i,n,s,o,r)=>(0,S.Rg)(t)&&(0,S.yK)(t)&&null!=n?{view:e,geometry:t,elevationInfo:i,options:o,queue:n,cache:s,slicePlane:r}:null)),this._getElevationInfoMemoized=(0,d.B)(((e,t)=>({mode:e,offset:t}))),this._getOptionsMemoized=(0,d.B)(((e,t)=>{const{densificationMaxSamples:i,maxTotalSamples:n}=(0,E.zj)();return{samplingDistance:e,densificationMaxSamples:Math.round(i/t),maxTotalSamples:n}})),this._updateThrottled=(0,P.n)((e=>(0,M.ignoreAbortErrors)(this._update(e))),(0,E.zj)().updateThrottleMillis)}initialize(){const e=this.viewModel;this.addHandles([(0,_.watch)((()=>({visible:e.visible,profiles:e.profiles.toArray()})),(e=>{let{visible:t,profiles:i}=e;this._abortUpdate(),this._paramsPerProfile.clear(),this.removeHandles(Z),t&&0!==i.length&&this.addHandles([...i.map((e=>(0,b.vE)([e.attach(this.viewModel),e.on("change",(()=>{this._invalidateProfile(e)}))]))),(0,_.watch)((()=>this._updateParameters),this._updateThrottled,_.syncAndInitial),this._updateThrottled],Z)}),_.syncAndInitial)])}destroy(){this._paramsPerProfile.clear()}get _updateParameters(){const{viewModel:e}=this,t=e.view;return this._getUpdateParametersMemoized(null==t||t.stationary,this.viewModel.visibleProfiles,this._generationParameters)}get _generationParameters(){const{view:e,input:t,queue:i,tileCache:n}=this.viewModel;return null!=e&&e.ready?this._getGenerationParametersMemoized(e,t?.geometry,this._elevationInfo,i,n,this._options,"3d"===e.type?e.slicePlane:null):null}get _elevationInfo(){const e=this.viewModel.input,t=e?(0,I.NN)(e)?null:(0,I.bh)(e):null;return null!=t?this._getElevationInfoMemoized(t.mode,t.offset):null}get _options(){const e=this.viewModel,t=e.visibleProfiles.length;let i=e.minDemResolution??(0,E.zj)().defaultDemResolution;return i=parseFloat(i.toFixed(2)),this._getOptionsMemoized(i,t)}async _update(e){let{stationary:t,visibleProfiles:i,generationParameters:n}=e;this._abortUpdate(),t&&(null!=n?this._updateTask=(0,w.UT)((async e=>{this.viewModel.error=null;const t=i.filter((e=>!this._isProfileValid(e,n))),s=(0,R.uK)({...n,providers:t},{signal:e});try{for await(const i of s){(0,M.throwIfAborted)(e),this._clearInvalidResults(n);for(let e=0;e<t.length;e++)t[e].result=i[e]}for(const e of t)this._paramsPerProfile.set(e,n)}catch(o){(0,M.throwIfAbortError)(o),this._abortUpdate(),this.viewModel.error=o,t.forEach((e=>{e.result=null}))}})):this._clearResults())}_abortUpdate(){this._updateTask=(0,p.DC)(this._updateTask)}_isProfileValid(e,t){return this._paramsPerProfile.has(e)&&this._paramsPerProfile.get(e)===t}_invalidateProfile(e){this._paramsPerProfile.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this.viewModel.profiles.items)this._isProfileValid(t,e)||(t.result=null,this._paramsPerProfile.delete(t))}_clearResults(){for(const e of this.viewModel.profiles.items)e.result=null,this._paramsPerProfile.delete(e)}};(0,n._)([(0,y.MZ)({nonNullable:!0})],k.prototype,"viewModel",void 0),(0,n._)([(0,y.MZ)()],k.prototype,"_updateParameters",null),(0,n._)([(0,y.MZ)()],k.prototype,"_generationParameters",null),(0,n._)([(0,y.MZ)()],k.prototype,"_elevationInfo",null),(0,n._)([(0,y.MZ)()],k.prototype,"_options",null),k=(0,n._)([(0,f.$)("esri.widgets.ElevationProfile.ElevationProfileController")],k);var C=i(36974),D=i(84174),A=i(47609),G=i(59177),L=i(27824);const U={base:D.default,key:"type",typeMap:{ground:C.default,input:A.default,query:G.default,view:L.default},errorContext:"elevation-profile-line"},O=a.default.ofType(U);var T,V,x,z=i(63733),q=i(89465),N=i(38996),H=i(57308),B=i(81257);(x=T||(T={})).Ready="ready",x.Creating="creating",x.Reshaping="reshaping",x.ReshapingDisabled="reshaping-disabled",x.Selecting="selecting",x.Selected="selected",function(e){e.View="view",e.Main="main",e.Interaction="interaction"}(V||(V={}));let F=class extends o.default{constructor(e){super(e),this.state=T.Ready,this._pendingStartOptions=null,this._previousInputInfo=null,this._shouldRemoveLastPoint=!1,this._sketchedGraphics=new WeakSet,this._creationToolPromise=null,this._updateToolPromise=null,this._updateDisabled=!1}initialize(){this.addHandles((0,_.watch)((()=>({view:this.tool.viewModel.view,visible:this.tool.visible})),(e=>{let{view:t,visible:i}=e;null!=t&&i?this._attach(t):this._detach()}),_.syncAndInitial),V.View)}destroy(){this._detach()}get canStopCreating(){const e=this._geometry,t=this._shouldRemoveLastPoint?3:2;return(0,S.Rg)(e)&&e.paths.length>0&&e.paths[0].length>=t}get _input(){return this.tool.viewModel.input}set _input(e){this.tool.viewModel.input=e}get _geometry(){return this._input?.geometry}get _visibleAndEditable(){return this.tool.visible&&this.tool.editable}get _view(){return this.tool.viewModel.view}get test(){}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mode:"sketch"};if(!this.tool.editable)return;const t=this._view;if(null!=t&&t.ready)switch(this._pendingStartOptions=null,this._stopInteraction(),null==this._previousInputInfo&&this._storePreviousInput(this._input),this._setSketchedGraphic(null),e.mode){case"sketch":this._set("state",T.Creating),this._startCreationInteraction();break;case"select":this._set("state",T.Selecting),this._startSelectionInteraction()}else this._pendingStartOptions=e}stop(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._clearPreviousInput()}cancel(){this._pendingStartOptions=null,this._stopInteractionAndUpdate(),this._restorePreviousInput()}clear(){this._stopInteractionAndUpdate(),this._set("state",T.Ready),this._clearPreviousInput(),this._input=null,this._pendingStartOptions=null}isSketchedGraphic(e){return null!=e&&this._sketchedGraphics.has(e)}_attach(e){this._detach();const t={mode:"3d"===e.type?"relative-to-ground":"on-the-ground",offset:null};this._graphicsLayer=new z.default({listMode:"hide",internal:!0,elevationInfo:t});const i=function(e){return"2d"===e?new q.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[0,0,0,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5,color:[255,255,255,255]}]}}}):new N.default({color:[0,0,0,0]})}(e.type);this._sketchVM=new B.default({layer:this._graphicsLayer,view:e,defaultCreateOptions:{mode:"click",hasZ:!1},updateOnGraphicClick:!1,defaultUpdateOptions:{reshapeOptions:{shapeOperation:"none"},enableRotation:!1,enableScaling:!1,enableMoveAllGraphics:!1,enableZ:!1,multipleSelectionEnabled:!1,toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:i,activeLineSymbol:i}),this.addHandles([(0,_.when)((()=>e.ready),(()=>{const e=this._pendingStartOptions;e&&this.start(e)}),_.syncAndInitial),(0,_.watch)((()=>[this._input,this._visibleAndEditable]),(()=>this._update()),_.syncAndInitial),(0,_.watch)((()=>({map:e.map,graphicsLayer:this._graphicsLayer})),(e=>{let{map:t,graphicsLayer:i}=e;null!=t&&null!=i&&t.add(i),this._update()}),_.syncAndInitial)],V.Main)}_detach(){this.removeHandles(V.Main),this._sketchVM=(0,p.pR)(this._sketchVM),this._creationToolPromise=null,this._updateToolPromise=null;const e=this._view?.map,t=this._graphicsLayer;null!=e&&null!=t&&e.remove(t),this._graphicsLayer=(0,p.pR)(this._graphicsLayer),this._shouldRemoveLastPoint=!1,this._set("state",T.Ready)}_startCreationInteraction(){this._stopInteractionAndUpdate();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;this._shouldRemoveLastPoint=!1;const i=t.on("create",(e=>{const t=e.graphic;switch(e.state){case"complete":this._shouldRemoveLastPoint=!1,this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"cancel":this.cancel();break;case"active":this._setSketchedGraphic(t),"cursor-update"===e.toolEventInfo?.type&&(this._shouldRemoveLastPoint=!0);break;case"start":this._setSketchedGraphic(t)}}));this.removeHandles(V.Interaction),this.addHandles((0,b.hA)((()=>{i.remove();const e=this.canStopCreating,n=this._geometry?.clone();t.cancel(),this._creationToolPromise=null,null!=n&&e?this._shouldRemoveLastPoint&&this._setSketchedGraphic(new s.default({geometry:j(n)})):this._input=null})),V.Interaction),this._creationToolPromise=(0,M.ignoreAbortErrors)(t.create("polyline"))}_startReshapeInteraction(){this._stopInteraction();const e=this._view,t=this._sketchVM;if(null==e||null==t)return;const i=t.on("update",(e=>{const t=e.graphics[0];switch(e.state){case"complete":this._setSketchedGraphic(t),this._stopInteractionAndUpdate(),this._clearPreviousInput();break;case"active":case"start":this._setSketchedGraphic(t)}}));this.removeHandles(V.Interaction),this.addHandles((0,b.hA)((()=>{i.remove(),t.cancel(),this._updateToolPromise=null})),V.Interaction);const n=this._input;n&&(n.visible=!0,this._updateToolPromise=(0,M.ignoreAbortErrors)(t.update(n,{tool:"reshape"})))}_startSelectionInteraction(){this._stopInteraction();const e=this._view;if(null==e)return;const t=e.cursor,i=(0,b.hA)((()=>e.cursor=t));e.cursor="crosshair",e.closePopup();let n=null;const s=(0,b.hA)((()=>(0,p.DC)(n))),o=e.on("immediate-click",(t=>{t.async((async()=>{(0,p.DC)(n),n=(0,w.UT)((async i=>{const{results:n}=await e.hitTest(t);(0,M.throwIfAborted)(i);const s=n.filter((e=>"graphic"===e.type)).map((e=>e.graphic)).find((e=>null!=e.geometry&&"polyline"===e.geometry.type));s&&(t.preventDefault(),t.stopPropagation(),this._input=s,this._clearPreviousInput(),this._stopInteractionAndUpdate())})),await n.promise}))}),H.o.TOOL),r=e.on("key-down",(e=>{"Escape"===e.key&&this.cancel()}));this.removeHandles(V.Interaction),this.addHandles([o,r,s,i],V.Interaction),e.ready&&e.focus()}_stopInteraction(){this.removeHandles(V.Interaction)}_stopInteractionAndUpdate(){this.hasHandles(V.Interaction)&&(this._updateDisabled=!0,this._stopInteraction(),this._updateDisabled=!1,this._triggerUpdate())}_triggerUpdate(){this._set("state",T.Ready),this._update()}_update(){if(this._updateDisabled)return;const e=this.state;if(e!==T.Selecting){if(this._visibleAndEditable){if(e===T.Creating||e===T.Reshaping&&this.isSketchedGraphic(this._input))return}else this.cancel();this._set("state",this._getNextState()),this._updateVisuals()}else this.stop()}_getNextState(){return null==this._input?T.Ready:this.isSketchedGraphic(this._input)?this.state===T.Creating?T.Creating:this._visibleAndEditable?T.Reshaping:T.ReshapingDisabled:T.Selected}_updateVisuals(){switch(this.state){case T.Creating:break;case T.Reshaping:this._startReshapeInteraction();break;case T.ReshapingDisabled:{this._stopInteractionAndUpdate();const e=this._input;null!=e&&this.isSketchedGraphic(e)&&(e.visible=!1);break}case T.Ready:case T.Selected:this._stopInteractionAndUpdate();case T.Selecting:}this._updateSketchedGraphic()}_storePreviousInput(e){this._previousInputInfo={graphic:e}}_restorePreviousInput(){const e=this._previousInputInfo;null!=e&&(this._clearPreviousInput(),this._input=e.graphic,this._triggerUpdate())}_clearPreviousInput(){this._previousInputInfo=null}_updateSketchedGraphic(){const e=this._graphicsLayer;if(null==e)return;const t=e.graphics,i=this._input;if(null!=i&&this.isSketchedGraphic(i)){if(-1===t.indexOf(i))t.removeAll(),t.add(i);else if(1!==t.length){const e=t.filter((e=>e!==i));t.removeMany(e)}}else t.removeAll()}_setSketchedGraphic(e){null!=e&&this._sketchedGraphics.add(e),this._input=e,this._updateSketchedGraphic()}};function j(e){if((0,S.Rg)(e)){const t=e.clone();return t.paths=[t.paths[0].slice(0,-1)],t}return e}(0,n._)([(0,y.MZ)({nonNullable:!0})],F.prototype,"state",void 0),(0,n._)([(0,y.MZ)({nonNullable:!0})],F.prototype,"tool",void 0),(0,n._)([(0,y.MZ)()],F.prototype,"canStopCreating",null),(0,n._)([(0,y.MZ)()],F.prototype,"_graphicsLayer",void 0),(0,n._)([(0,y.MZ)()],F.prototype,"_sketchVM",void 0),(0,n._)([(0,y.MZ)()],F.prototype,"_input",null),(0,n._)([(0,y.MZ)()],F.prototype,"_geometry",null),(0,n._)([(0,y.MZ)()],F.prototype,"_visibleAndEditable",null),(0,n._)([(0,y.MZ)()],F.prototype,"_view",null),(0,n._)([(0,y.MZ)()],F.prototype,"_shouldRemoveLastPoint",void 0),F=(0,n._)([(0,f.$)("esri.widgets.ElevationProfile.ElevationProfileInteraction")],F);let $=class extends o.default{constructor(e){super(e),this._implementation=null,this._loadingTask=null}initialize(){this.addHandles((0,_.watch)((()=>({tool:this.tool,view:this.tool.viewModel.view,visible:this.tool.visible&&!!this.tool.viewModel.view?.ready})),(e=>{let{tool:t,view:i,visible:n}=e;null!=i&&n?this._show(i,t):this._hide()}),_.syncAndInitial))}destroy(){this._hide()}_show(e,t){this._loadingTask=(0,p.DC)(this._loadingTask),this._loadingTask=(0,w.UT)((async n=>{if("2d"===e.type){const s=i.e(69003).then(i.bind(i,69003)),o=(await(0,M.whenOrAbort)(s,n)).ElevationProfileView2D;this._implementation=new o(e,t)}else if("3d"===e.type){const s=i.e(63940).then(i.bind(i,41559)),o=(await(0,M.whenOrAbort)(s,n)).ElevationProfileView3D;this._implementation=new o(e,t)}}))}_hide(){this._loadingTask=(0,p.DC)(this._loadingTask),this._implementation=(0,p.pR)(this._implementation)}};(0,n._)([(0,y.MZ)()],$.prototype,"tool",void 0),$=(0,n._)([(0,f.$)("esri.widgets.ElevationProfile.support.ElevationProfileView")],$);let Q=class extends o.default{constructor(e){super(e),this.editable=!0,this.visible=!0,this.highlightEnabled=!0}initialize(){this.view=new $({tool:this}),this.interaction=new F({tool:this})}destroy(){this.interaction.destroy(),this.view.destroy()}get state(){const e=this.interaction?.state;switch(e){case T.Ready:return E.o8.Ready;case T.Creating:return E.o8.Creating;case T.Selecting:return E.o8.Selecting;case T.Selected:return E.o8.Selected;case T.Reshaping:case T.ReshapingDisabled:return E.o8.Created}}};(0,n._)([(0,y.MZ)({nonNullable:!0})],Q.prototype,"viewModel",void 0),(0,n._)([(0,y.MZ)()],Q.prototype,"view",void 0),(0,n._)([(0,y.MZ)()],Q.prototype,"interaction",void 0),(0,n._)([(0,y.MZ)()],Q.prototype,"editable",void 0),(0,n._)([(0,y.MZ)()],Q.prototype,"visible",void 0),(0,n._)([(0,y.MZ)()],Q.prototype,"highlightEnabled",void 0),Q=(0,n._)([(0,f.$)("esri.widgets.ElevationProfile.ElevationProfileTool")],Q);var W=i(44300),J=i(95507);let Y=class extends o.default{constructor(e){super(e),this.view=null,this.input=null,this._getEffectiveUnitsMemoized=(0,d.B)(((e,t)=>({distance:e,elevation:t}))),this.hoveredChartPosition=null,this.uniformChartScaling=!1,this.defaultUnit=null,this.queue=null,this._currentTileCache=null,this.error=null,this._defaultProfileLineGround=new C.default,this._userUnitOptions=null,this._userUnit=null,e?.profiles||(this.profiles=new a.default([this._defaultProfileLineGround]))}initialize(){this.addHandles((0,_.watch)((()=>this.view),(e=>{if(null==e)return void h.A.getLogger(this).warnOnce("no view. Widget will be disabled until a view is provided.");this.removeHandles(K);const t="3d"===e.type?e.resourceController:void 0;this.queue?.destroy(),this.queue=(0,R.LD)(t?.scheduler);const i=t?.addUpdatingObject(this);i&&this.addHandles(i,K)}),_.syncAndInitial)),this.tool=new Q({viewModel:this}),this._controller=new k({viewModel:this})}destroy(){this._defaultProfileLineGround=(0,p.pR)(this._defaultProfileLineGround),this._controller=(0,p.pR)(this._controller),this._currentTileCache=(0,p.pR)(this._currentTileCache),this.tool=(0,p.pR)(this.tool),this.queue=(0,p.pR)(this.queue)}get profiles(){return this._get("profiles")}set profiles(e){const t=this._get("profiles"),i=e??new a.default;this._set("profiles",(0,u.V)(i,t))}get state(){const e=this.view;return null!=e&&e.ready?this.tool.state:E.o8.Disabled}get progress(){let e=0,t=0;for(const i of this.visibleProfiles)e++,t+=i.progress;return e>0?t/e:0}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}get effectiveUnits(){const e=(0,J.DM)(this.visibleProfiles.map((e=>e.result))),t=(0,v.Vs)(e.maxDistance,"meters",this.unit),i=(0,v.jE)(e.maxElevation,"meters",this.unit);return this._getEffectiveUnitsMemoized(t,i)}get highlightEnabled(){return this.tool.highlightEnabled}set highlightEnabled(e){this.tool.highlightEnabled=e}get hasVertices(){const e=this.input?.geometry;return(0,S.Rg)(e)&&e.paths.reduce(((e,t)=>e+t.length),0)>0}get hoveredPoints(){return null!=this.input&&this.visible&&this.tool.editable?this.visibleProfiles.map((e=>{const t=e.hoveredPoint;return null!=t?{hoveredPoint:t,color:e.color}:null})).filter(r.Ru):[]}get statistics(){return(0,J.ch)(this.visibleProfiles.map((e=>e.statistics)))}get chartData(){if(null==this.input)return null;const{effectiveUnits:e,progress:t,statistics:i,visibleProfiles:n,uniformChartScaling:s}=this,o=n.filter((e=>e.hasZ)).map((e=>({id:e.id,type:e.type,title:e.title,color:e.color,samples:e.samples,progress:e.progress,chartFillEnabled:e.chartFillEnabled,chartStrokeWidth:e.chartStrokeWidth,chartStrokeOffsetY:e.chartStrokeOffsetY,viewVisualizationEnabled:e.viewVisualizationEnabled})));return 0===o.length?null:{lines:o,effectiveUnits:e,statistics:i,refined:1===t,dynamicElevationRange:n.some((e=>"view"===e.type)),uniformScaling:s}}get visibleProfiles(){return this.profiles.toArray().filter((e=>e.available&&e.visible))}get minDemResolutions(){const e=[];for(const{minDemResolution:t}of this.visibleProfiles)null!=t&&e.push(t);return e}get minDemResolution(){return(0,r.jk)(this.minDemResolutions)}get errorState(){const e=this.input?.geometry;if(!(0,S.yK)(e))return E.GJ.NoValidInput;if(null!=this.error){if((0,W.mb)(this.error))switch(this.error.cause){case W.NG.TooComplex:return E.GJ.TooComplex;case W.NG.InvalidGeometry:return E.GJ.InvalidGeometry;case W.NG.InvalidElevationInfo:return E.GJ.InvalidElevationInfo;case W.NG.ElevationQueryError:return E.GJ.NoValidInput}return E.GJ.UnknownError}return 0===this.visibleProfiles.length?E.GJ.NoVisibleProfiles:null==this.chartData&&1===this.progress?E.GJ.RefinedButNoChartData:E.GJ.None}get tileCache(){this._currentTileCache=(0,p.pR)(this._currentTileCache);const e=this.view;if(null!=e&&"3d"===e?.type){const t=e.basemapTerrain?.elevationQueryCache;if(null!=t)return t}return null==this._currentTileCache&&(this._currentTileCache=new g.E(new c.q(20*l.u.MEGABYTES))),this._currentTileCache}get visible(){return this.tool.visible}set visible(e){this.tool.visible=e}get selectAvailable(){for(const e of this.view?.map?.allLayers??[]){if("graphics"===e.type&&!e.internal&&e.graphics.some((e=>"polyline"===e.geometry?.type)))return!0;if("geometryType"in e&&"polyline"===e.geometryType)return!0}return!!this.view?.graphics?.some((e=>"polyline"===e.geometry?.type))}get inputIsSketched(){return this.tool.interaction.isSketchedGraphic(this.input)}get elevationProvider(){const e=this.view;return null!=e&&"3d"===e.type?e.elevationProvider:null}get updating(){const{progress:e}=this,t=!!this.queue?.updating;return e>0&&e<1||t}start(e){this.tool.interaction.start(e)}stop(){this.tool.interaction.stop()}cancel(){this.tool.interaction.cancel()}clear(){this.tool.interaction.clear()}_findSelectableUnit(e,t){const i=this.unitOptions;return null!=e&&i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){const t=(null!=e?e:[]).filter((e=>v.GB.includes(e)));return 0===t.length?v.GB.slice():t}};(0,n._)([(0,y.MZ)()],Y.prototype,"view",void 0),(0,n._)([(0,y.MZ)({type:s.default})],Y.prototype,"input",void 0),(0,n._)([(0,y.MZ)({type:O,nonNullable:!0})],Y.prototype,"profiles",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"state",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"progress",null),(0,n._)([(0,y.MZ)()],Y.prototype,"unitOptions",null),(0,n._)([(0,y.MZ)()],Y.prototype,"unit",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"effectiveUnits",null),(0,n._)([(0,y.MZ)()],Y.prototype,"hoveredChartPosition",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"uniformChartScaling",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"highlightEnabled",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"hoveredPoints",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"statistics",null),(0,n._)([(0,y.MZ)()],Y.prototype,"chartData",null),(0,n._)([(0,y.MZ)()],Y.prototype,"visibleProfiles",null),(0,n._)([(0,y.MZ)()],Y.prototype,"minDemResolutions",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"minDemResolution",null),(0,n._)([(0,y.MZ)({readOnly:!0})],Y.prototype,"errorState",null),(0,n._)([(0,y.MZ)(m.q)],Y.prototype,"defaultUnit",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"queue",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"tileCache",null),(0,n._)([(0,y.MZ)()],Y.prototype,"tool",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"visible",null),(0,n._)([(0,y.MZ)()],Y.prototype,"error",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"selectAvailable",null),(0,n._)([(0,y.MZ)()],Y.prototype,"inputIsSketched",null),(0,n._)([(0,y.MZ)()],Y.prototype,"elevationProvider",null),(0,n._)([(0,y.MZ)()],Y.prototype,"updating",null),(0,n._)([(0,y.MZ)()],Y.prototype,"_defaultProfileLineGround",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"_userUnitOptions",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"_controller",void 0),(0,n._)([(0,y.MZ)()],Y.prototype,"_userUnit",void 0),Y=(0,n._)([(0,f.$)("esri.widgets.ElevationProfile.ElevationProfileViewModel")],Y);const K=Symbol("updating-object"),X=Y},23758:(e,t,i)=>{i.d(t,{W:()=>l,e:()=>r});var n=i(18690),s=i(31633),o=i(97153);function r(e){if(null==e)return null;if((0,o.Q)(e))return l(e);const t=e.tileInfo;if(null==t)return null;const i=t.lods?.at(-1);return null==i?null:i.resolution*(0,s.GA)(t.spatialReference)}function l(e){if(null==e)return null;const t=e.layers.items.map(a).filter(n.Ru);return(0,n.jk)(t)??null}function a(e){return e&&"tileInfo"in e?r(e):null}},27824:(e,t,i)=>{i.r(t),i.d(t,{default:()=>E});var n=i(35143),s=i(69539),o=i(54901),r=i(56002),l=i(68134),a=i(41289),u=i(31633),h=i(46053),c=(i(81806),i(76460),i(47249),i(85842)),p=i(20664),d=i(9392),_=i(34111),v=i(95925),y=i(18722),f=i(88220),g=i(29808),m=i(3112),w=i(30310),b=i(84174);let M=class extends b.default{constructor(e){super(e),this.type="view",this.color=new s.default("#cf4ccf"),this.viewVisualizationEnabled=!0,this.include=null,this.exclude=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=25,this._getQueryElevationDependencies=(0,r.B)(((e,t,i,n,s,o,r)=>({inputGraphicUid:null!=e?I(e):null,visibleLayers:t,maxIntersectionDistance:i,intersectOptions:n,view:s,stationary:o,spatialReference:r}))),this._vecA=(0,d.vt)(),this._vecB=(0,d.vt)(),this._ray=(0,v.vt)()}get minDemResolution(){const e=this._viewModel?.view;if(null==e||"3d"!==e.type)return null;const t=e.pointsOfInterest?.focus?.worldUnitsPerContentPixel;return null==t?null:t*(0,u.G9)(e.spatialReference)}get queryElevationDependencies(){const e=this._view;return e?this._getQueryElevationDependencies(this._viewModel?.input,this._visibleLayers,this._maxIntersectionDistance,this._intersectOptions,e,e.stationary,e.spatialReference):null}get _visibleLayers(){return this._view?.map?.allLayers?.filter((e=>e.visible)).toArray()??[]}get _intersectOptions(){const e=this._view;if(null==e||e.destroyed)return{};const t=(0,f.ZD)(e,{include:this.include,exclude:this.exclude}),i=(0,f.ZD)(e,{exclude:this._pointCloudLayers});return t.exclude=(0,a.KC)(t.exclude,i.exclude),t}get _pointCloudLayers(){const e=this._view;return null==e?[]:e.allLayerViews.toArray().filter((e=>"point-cloud"===e.layer?.type)).map((e=>e.layer))}get _view(){const e=this._viewModel?.view;return null!=e&&"3d"===e.type?e:null}get _maxIntersectionDistance(){const e=this._view;return e?.renderCoordsHelper?(0,_.tO)(e.spatialReference).radius/e.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY}get _intersector(){const e=this._view;if(null==e)return null;const t=(0,g.hz)(e.state.viewingMode),i=t.options;return i.hud=!1,i.invisibleTerrain=!1,i.backfacesTerrain=!1,i.selectionMode=!1,i.store=m.oH.ALL,t}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const o=this._intersector;if(null==o)throw new Error("ElevationProfileLineInput: no view");const{intersectOptions:r,view:l,spatialReference:a}=s,u=l.renderCoordsHelper,h=l.sceneIntersectionHelper,c=this._vecA,d=this._vecA,_=this._vecB,f=this._ray;if(!a)return{geometry:e,noDataValue:i};const g=await y.GeometryDescriptor.fromGeometry(e).project(a,n);if(!g)return{geometry:e,noDataValue:i};const m=g.coordinates,w=m.length;for(let y=0;y<w;++y){const e=m[y];(0,p.i)(_,e.x,e.y,e.z??0),u.toRenderCoords(_,a,_),u.setAltitude(c,2e5,_);const t=(0,v.Cr)(c,_,f);h.computeIntersection(t,o,r,!0);const n=P(s,o.results.all);n?(n.getIntersectionPoint(d),u.fromRenderCoords(d,d,a),e.z=d[2]):e.z=i}return{geometry:g.export(),noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,o.vE)([super.attach(e),(0,l.watch)((()=>this.queryElevationDependencies),t),(0,l.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};function P(e,t){let{view:i,inputGraphicUid:n,maxIntersectionDistance:s}=e;for(const o of t){if(!o.withinDistance(s))continue;const e=(0,w.Gy)(o,i);if(null==e||I(e)!==n)return o}return null}function I(e){if(e.layer&&"objectIdField"in e.layer){const t=e.attributes[e.layer.objectIdField];if(t)return`o-${e.layer.id}-${t}`}return`u-${e.uid}`}(0,n._)([(0,h.MZ)({type:s.default,nonNullable:!0})],M.prototype,"color",void 0),(0,n._)([(0,h.MZ)()],M.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,h.MZ)()],M.prototype,"include",void 0),(0,n._)([(0,h.MZ)()],M.prototype,"exclude",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],M.prototype,"minDemResolution",null),(0,n._)([(0,h.MZ)()],M.prototype,"queryElevationDependencies",null),(0,n._)([(0,h.MZ)()],M.prototype,"_visibleLayers",null),(0,n._)([(0,h.MZ)()],M.prototype,"_intersectOptions",null),(0,n._)([(0,h.MZ)()],M.prototype,"_pointCloudLayers",null),(0,n._)([(0,h.MZ)()],M.prototype,"_view",null),(0,n._)([(0,h.MZ)()],M.prototype,"_maxIntersectionDistance",null),(0,n._)([(0,h.MZ)()],M.prototype,"_intersector",null),M=(0,n._)([(0,c.$)("esri.widgets.ElevationProfile.ElevationProfileLineView")],M);const E=M},36974:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var n=i(35143),s=i(69539),o=i(54901),r=i(56002),l=i(68134),a=i(31633),u=i(46053),h=(i(81806),i(76460),i(47249),i(85842)),c=i(84174),p=i(23758);let d=class extends c.default{constructor(e){super(e),this.type="ground",this.color=new s.default("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=(0,r.B)(((e,t)=>({ground:e,groundLayers:t})))}get available(){const e=this._ground;return null!=e&&e.layers.some((e=>e.visible))}get minDemResolution(){return(0,p.W)(this._ground)}get _queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){return this._viewModel?.view?.map?.ground}get _groundLayers(){return this._ground?.layers?.toArray()??[]}async queryElevation(e,t){const i=this._queryElevationDependencies;if(null==i)throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=i;if(null==n)throw new Error("No ground configured in the view");const s=await n.queryElevation(e,t),o=(0,a.G9)(e.spatialReference),r=(0,a.G9)(n.layers.at(0).spatialReference);if(o!==r){const e=s.geometry;e.points=e.points.map((e=>{let[i,n,s]=e;return[i,n,s===t.noDataValue?s:s*r/o]}))}return s}attach(e){return(0,o.vE)([super.attach(e),(0,l.watch)((()=>this._queryElevationDependencies),(()=>this._onChange()))])}};(0,n._)([(0,u.MZ)({type:s.default,nonNullable:!0})],d.prototype,"color",void 0),(0,n._)([(0,u.MZ)()],d.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,u.MZ)()],d.prototype,"available",null),(0,n._)([(0,u.MZ)({readOnly:!0})],d.prototype,"minDemResolution",null),(0,n._)([(0,u.MZ)()],d.prototype,"_queryElevationDependencies",null),(0,n._)([(0,u.MZ)()],d.prototype,"_ground",null),(0,n._)([(0,u.MZ)()],d.prototype,"_groundLayers",null),d=(0,n._)([(0,h.$)("esri.widgets.ElevationProfile.ElevationProfileLineGround")],d);const _=d},47609:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var n=i(35143),s=i(69539),o=i(54901),r=i(56002),l=i(68134),a=i(46053),u=(i(81806),i(76460),i(47249),i(85842)),h=i(18722),c=i(12482),p=i(84174);let d=class extends p.default{constructor(e){super(e),this.type="input",this.color=new s.default("#00c8c8"),this.viewVisualizationEnabled=!1,this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this.chartFillEnabled=!1,this.chartStrokeOffsetY=-1,this._getQueryElevationDependencies=(0,r.B)(((e,t,i,n,s)=>e?{elevationInfo:e,visibleLayers:t,view:i,stationary:n,spatialReference:s}:null))}get queryElevationDependencies(){const e=this._viewModel?.view;return null==e?null:this._getQueryElevationDependencies(this._elevationInfo,this._visibleLayers,e,e.stationary,e.spatialReference)}get available(){return!this._viewModel?.inputIsSketched}get _elevationInfo(){const e=this._viewModel?.input;return e?(0,c.bh)(e):null}get _visibleLayers(){return this._viewModel?.view?.map?.allLayers?.filter((e=>e.visible)).toArray()??[]}async queryElevation(e,t){let{noDataValue:i,signal:n}=t;const s=this.queryElevationDependencies;if(null==s)throw new Error("ElevationProfileLineInput: no dependencies");const{view:o,elevationInfo:r,spatialReference:l}=s;if("on-the-ground"===r.mode&&"3d"===o.type&&l){const t=await h.GeometryDescriptor.fromGeometry(e).project(l,n);if(!t)return{geometry:e,noDataValue:i};const s=o.elevationProvider;return t.coordinates.forEach((e=>{e.z=s.getElevation(e.x,e.y,0,l,"ground")??0})),{geometry:t.export(),noDataValue:i}}return{geometry:e,noDataValue:i}}attach(e){const t=()=>this._onChange();return(0,o.vE)([super.attach(e),(0,l.watch)((()=>this.queryElevationDependencies),t),(0,l.on)((()=>e.elevationProvider),"elevation-change",t,{onListenerAdd:t,onListenerRemove:t})])}};(0,n._)([(0,a.MZ)({type:s.default,nonNullable:!0})],d.prototype,"color",void 0),(0,n._)([(0,a.MZ)()],d.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,a.MZ)()],d.prototype,"queryElevationDependencies",null),(0,n._)([(0,a.MZ)()],d.prototype,"available",null),(0,n._)([(0,a.MZ)()],d.prototype,"_elevationInfo",null),(0,n._)([(0,a.MZ)()],d.prototype,"_visibleLayers",null),d=(0,n._)([(0,u.$)("esri.widgets.ElevationProfile.ElevationProfileLineInput")],d);const _=d},59177:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var n=i(35143),s=i(69539),o=i(54901),r=i(68134),l=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),u=i(84174),h=i(23758);let c=class extends u.default{constructor(e){super(e),this.type="query",this.color=new s.default("#db334a"),this.viewVisualizationEnabled=!0,this.source=null,this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return(0,h.e)(this.source)}get available(){const e=this.source;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some((e=>e.visible)))}queryElevation(e,t){if(!this.source)throw new Error("No source configured for the elevation profile line");return this.source.queryElevation(e,t)}attach(e){return(0,o.vE)([super.attach(e),(0,r.watch)((()=>this.source),(()=>this._onChange()),r.sync)])}};(0,n._)([(0,l.MZ)({type:s.default,nonNullable:!0})],c.prototype,"color",void 0),(0,n._)([(0,l.MZ)()],c.prototype,"viewVisualizationEnabled",void 0),(0,n._)([(0,l.MZ)()],c.prototype,"source",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],c.prototype,"minDemResolution",null),(0,n._)([(0,l.MZ)()],c.prototype,"available",null),c=(0,n._)([(0,a.$)("esri.widgets.ElevationProfile.ElevationProfileLineQuery")],c);const p=c},63733:(e,t,i)=>{i.r(t),i.d(t,{default:()=>d});var n=i(35143),s=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),r=i(5364),l=i(25515),a=i(65624),u=i(5682),h=i(64519),c=i(731);let p=class extends((0,a.dM)((0,u.j)(l.default))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new h.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,n._)([(0,s.MZ)({type:c.A})],p.prototype,"elevationInfo",void 0),(0,n._)([(0,s.MZ)((0,r.C)(h.Y,"graphics"))],p.prototype,"graphics",void 0),(0,n._)([(0,s.MZ)({type:["show","hide"]})],p.prototype,"listMode",void 0),(0,n._)([(0,s.MZ)()],p.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],p.prototype,"type",void 0),(0,n._)([(0,s.MZ)({constructOnly:!0})],p.prototype,"internal",void 0),p=(0,n._)([(0,o.$)("esri.layers.GraphicsLayer")],p);const d=p},79468:(e,t,i)=>{function n(e,t,i,n){let s=null,o=1e3;"number"==typeof t?(o=t,n=i):(s=t??null,o=i);let r,l=0;const a=()=>{l=0,e.apply(n,r)},u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];s&&s.apply(n,t),r=t,o?l||(l=setTimeout(a,o)):a()};return u.remove=()=>{l&&(clearTimeout(l),l=0)},u.forceUpdate=()=>{l&&(clearTimeout(l),a())},u.hasPendingUpdates=()=>!!l,u}i.d(t,{n:()=>n})},89646:(e,t,i)=>{i.d(t,{$h:()=>v,Ef:()=>I,IP:()=>f,P1:()=>b,hF:()=>P,jQ:()=>w,rT:()=>M,rZ:()=>n,uR:()=>g});var n,s,o=i(73582),r=i(24648),l=i(31633),a=i(19555),u=i(72745),h=i(20664),c=i(9392),p=i(14487),d=i(7137),_=i(80963);function v(e,t){if(null==e||null==t)return;const i=y(e,t);return null!=i?(0,r.Wq)(i,"radians","geographic"):void 0}(s=n||(n={})).Absolute="absolute",s.Relative="relative",s.RelativeBilateral="relative-bilateral";const y=(()=>{const e=(0,c.vt)(),t=(0,c.vt)();return(i,n)=>((0,h.i)(e,i.x,i.y,i.z??0),(0,h.i)(t,n.x,n.y,n.z??0),f(e,t,i.spatialReference,n.spatialReference))})(),f=(()=>{const e=(0,u.vt)(),t=(0,c.vt)(),i=(0,c.vt)();return(n,s,o,r)=>{if((0,h.p)(n,s))return;const c=(0,d.geodesicCompatibleSpatialReference)(o),v=(0,d.geodesicCompatibleSpatialReference)(r);if(c&&v&&(0,_.aI)(c,v)&&(0,p.F)(n,o,t,c)&&(0,p.F)(s,r,i,v)){const{azimuth:e}=(0,d.inverseGeodeticSolver)(S,t,i,c);return null!=e?(0,l.oU)(e,"degrees","radians"):void 0}e[0]=s[0]-n[0],e[1]=s[1]-n[1];let y=(0,a.g7)(u.JP,e);return e[0]<0&&(y=R-y),y}})();function g(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.Absolute;if(t&&i)switch(s){case n.Absolute:return v(t,i);case n.Relative:return w(m(e,t,i),n.Relative);case n.RelativeBilateral:return w(m(e,t,i),n.RelativeBilateral)}}function m(e,t,i){if(!e||!t||!i)return;const n=y(e,t),s=y(t,i);return null!=n&&null!=s?(0,r.Wq)(s-n,"radians","geographic"):void 0}function w(e,t){if(null!=e)switch(t){case n.Absolute:return b(e);case n.Relative:{const t=P(e);let i=k.normalize(t,0,!0);return-180===i&&(i=180),(0,r.Wq)(i,"degrees","geographic")}case n.RelativeBilateral:{const t=P(e),i=Math.abs(k.normalize(t,0,!0));return(0,r.Wq)(i,"degrees","geographic")}}}function b(e){const t=P(e),i=Z.normalize(t,0,!0);return(0,r.Wq)(i,"degrees","geographic")}const M=(()=>{const e=(0,c.vt)();return function(t,i,n,s,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"geodesic";(0,h.c)(e,i);const u=P(o);if("geodesic"===a){const o=(0,d.geodesicCompatibleSpatialReference)(n);if(o&&(0,p.F)(e,n,e,o))return(0,d.directGeodeticSolver)(t,e,u,s,o),t[2]=i[2],!!(0,p.F)(t,o,t,n)}const c=(0,r.g2)(u,"geographic","arithmetic"),_=(0,l.oU)(c,"degrees","radians"),v=i[0]+s*Math.cos(_),y=i[1]+s*Math.sin(_),f=i[2];return(0,h.i)(t,v,y,f),!0}})();function P(e){if(null!=e)return(0,r.g2)(E(e),e.rotationType,"geographic")}function I(e){if(null!=e)return(0,r.g2)(E(e),e.rotationType,"arithmetic")}function E(e){return(0,l.oU)(e.value,e.unit,"degrees")}const S=new d.InverseGeodeticSolverResult,R=2*Math.PI,Z=o.ie,k=new o.hr(-180,180)},95327:(e,t,i)=>{i.r(t),i.d(t,{default:()=>a});var n=i(35143),s=i(91967),o=i(46053),r=(i(81806),i(76460),i(47249),i(85842));let l=class extends s.default{constructor(e){super(e),this.enabled=!1}};(0,n._)([(0,o.MZ)({type:Boolean,nonNullable:!0})],l.prototype,"enabled",void 0),l=(0,n._)([(0,r.$)("esri.views.interactive.sketch.SketchLabelOptions")],l);const a=l}}]);
//# sourceMappingURL=43292.ed5768ed.chunk.js.map