"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[8775,50698,96141],{7150:(e,t,n)=>{n.d(t,{K:()=>c});var r=n(15941),s=n(30015),o=n(20664),i=n(9392);const a=-1;function c(e,t,n){const r=e.vertices.position,s=e.vertices.componentIndex,i=h.position0,c=h.position1,f=h.faceNormal0,g=h.faceNormal1,{edges:p,normals:I}=l(e),N=p.length/4,m=t.allocate(N);let O=0;const A=N,v=n?.allocate(A);let T=0,y=0,L=0;d.length=0;for(let a=0;a<N;++a){const e=4*a;r.getVec(p.data[e],i),r.getVec(p.data[e+1],c);const t=d.pushNew();t.index=4*a,t.length=(0,o.j)(i,c)}d.sort(((e,t)=>t.length-e.length));const P=new Array,D=new Array;d.forAll((e=>{let{length:l,index:d}=e;const N=p.data[d],A=p.data[d+1],V=p.data[d+2],M=p.data[d+3],R=M===a;if(r.getVec(N,i),r.getVec(A,c),R){const e=3*V;(0,o.i)(f,I.data[e],I.data[e+1],I.data[e+2]),(0,o.c)(g,f),h.componentIndex=s.get(N),h.cosAngle=(0,o.f)(f,g)}else{let e=3*V;if((0,o.i)(f,I.data[e],I.data[e+1],I.data[e+2]),e=3*M,(0,o.i)(g,I.data[e],I.data[e+1],I.data[e+2]),h.componentIndex=s.get(N),h.cosAngle=(0,o.f)(f,g),function(e,t){return e.cosAngle>t}(h,w))return;h.cosAngle<-.9999&&(0,o.c)(g,f)}y+=l,L++,R||function(e,t){return e.cosAngle<t}(h,E)?(t.write(m,O++,h),P.push(l)):u(h,S)&&(v&&n&&n.write(v,T++,h),D.push(l))}));const V=new Float32Array(P.reverse()),M=new Float32Array(D.reverse()),R=v&&n?{instancesData:v.slice(0,T),lodInfo:{lengths:M}}:void 0;return{regular:{instancesData:m.slice(0,O),lodInfo:{lengths:V}},silhouette:R,averageEdgeLength:y/L}}function u(e,t){const n=(0,r.XM)(e.cosAngle);return(0,o.o)(N,e.position1,e.position0),n*((0,o.f)((0,o.e)(I,e.faceNormal0,e.faceNormal1),N)>0?-1:1)>t}function l(e){const t=e.faces.length/3,n=e.faces,r=e.neighbors,s=e.vertices.position;g.length=p.length=0;for(let i=0;i<t;i++){const e=3*i,t=r[e],c=r[e+1],u=r[e+2],l=n[e],f=n[e+1],d=n[e+2];s.getVec(l,m),s.getVec(f,O),s.getVec(d,A),(0,o.d)(O,O,m),(0,o.d)(A,A,m),(0,o.e)(m,O,A),(0,o.n)(m,m),p.pushArray(m),(t===a||l<f)&&(g.push(l),g.push(f),g.push(i),g.push(t)),(c===a||f<d)&&(g.push(f),g.push(d),g.push(i),g.push(c)),(u===a||d<l)&&(g.push(d),g.push(l),g.push(i),g.push(u))}return{edges:g,normals:p}}class f{constructor(){this.index=0,this.length=0}}const d=new s.A({allocator:e=>e||new f,deallocator:null}),g=new s.A({deallocator:null}),p=new s.A({deallocator:null}),h=new class{constructor(){this.position0=(0,i.vt)(),this.position1=(0,i.vt)(),this.faceNormal0=(0,i.vt)(),this.faceNormal1=(0,i.vt)(),this.componentIndex=0,this.cosAngle=0}},I=(0,i.vt)(),N=(0,i.vt)(),m=(0,i.vt)(),O=(0,i.vt)(),A=(0,i.vt)(),S=(0,r.kU)(4),w=Math.cos(S),v=(0,r.kU)(35),E=Math.cos(v)},8775:(e,t,n)=>{n.d(t,{o6:()=>l,extractComponentsEdgeLocationsLayout:()=>I,hx:()=>f,Jb:()=>h});var r=n(77176);function s(e,t,n){const r=t/3,s=new Uint32Array(n+1),o=new Uint32Array(n+1),i=(e,t)=>{e<t?s[e+1]++:o[t+1]++};for(let N=0;N<r;N++){const t=e[3*N],n=e[3*N+1],r=e[3*N+2];i(t,n),i(n,r),i(r,t)}let a=0,c=0;for(let N=0;N<n;N++){const e=s[N+1],t=o[N+1];s[N+1]=a,o[N+1]=c,a+=e,c+=t}const u=new Uint32Array(6*r),l=s[n],f=(e,t,n)=>{if(e<t){const r=s[e+1]++;u[2*r]=t,u[2*r+1]=n}else{const r=o[t+1]++;u[2*l+2*r]=e,u[2*l+2*r+1]=n}};for(let N=0;N<r;N++){const t=e[3*N],n=e[3*N+1],r=e[3*N+2];f(t,n,N),f(n,r,N),f(r,t,N)}const d=(e,t)=>{const n=2*e,r=t-e;for(let s=1;s<r;s++){const e=u[n+2*s],t=u[n+2*s+1];let r=s-1;for(;r>=0&&u[n+2*r]>e;r--)u[n+2*r+2]=u[n+2*r],u[n+2*r+3]=u[n+2*r+1];u[n+2*r+2]=e,u[n+2*r+3]=t}};for(let N=0;N<n;N++)d(s[N],s[N+1]),d(l+o[N],l+o[N+1]);const g=new Int32Array(3*r),p=(t,n)=>t===e[3*n]?0:t===e[3*n+1]?1:t===e[3*n+2]?2:-1,h=(e,t)=>{const n=p(e,t);g[3*t+n]=-1},I=(e,t,n,r)=>{const s=p(e,t);g[3*t+s]=r;const o=p(n,r);g[3*r+o]=t};for(let N=0;N<n;N++){let e=s[N];const t=s[N+1];let n=o[N];const r=o[N+1];for(;e<t&&n<r;){const t=u[2*e],r=u[2*l+2*n];t===r?(I(N,u[2*e+1],r,u[2*l+2*n+1]),e++,n++):t<r?(h(N,u[2*e+1]),e++):(h(r,u[2*l+2*n+1]),n++)}for(;e<t;)h(N,u[2*e+1]),e++;for(;n<r;)h(u[2*l+2*n],u[2*l+2*n+1]),n++}return g}var o=n(48549),i=n(66470),a=n(96141),c=n(69413),u=n(7150);function l(e){const t=f(e.data,e.skipDeduplicate,e.indices,e.indicesLength);return g.updateSettings(e.writerSettings),p.updateSettings(e.writerSettings),(0,u.K)(t,g,p)}function f(e,t,n,o){if(t){const t=s(n,o,e.count);return new d(n,o,t,e)}const i=(0,r.b)(e.buffer,e.stride/4,{originalIndices:n,originalIndicesLength:o}),c=s(i.indices,o,i.uniqueCount);return{faces:i.indices,facesLength:i.indices.length,neighbors:c,vertices:a.EdgeInputBufferLayout.createView(i.buffer)}}class d{constructor(e,t,n,r){this.faces=e,this.facesLength=t,this.neighbors=n,this.vertices=r}}const g=new c.T,p=new c.k,h=(0,o.BP)().vec3f(i.r.POSITION0).vec3f(i.r.POSITION1),I=(0,o.BP)().vec3f(i.r.POSITION0).vec3f(i.r.POSITION1).u16(i.r.COMPONENTINDEX)},12580:(e,t,n)=>{n.d(t,{L:()=>s,s:()=>o});var r=n(48549);function s(e,t){return t.push(e.buffer),{buffer:e.buffer,layout:new r.l5(e.layout)}}function o(e){return new r.q3(e.layout).createView(e.buffer)}},50698:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var r=n(12580),s=n(96141),o=n(7150),i=n(8775);class a{async extract(e){const t=c(e),n=(0,i.o6)(t),r=[t.data.buffer];return{result:u(n,r),transferList:r}}async extractComponentsEdgeLocations(e){const t=c(e),n=(0,i.hx)(t.data,t.skipDeduplicate,t.indices,t.indicesLength),s=(0,o.K)(n,f),a=[];return{result:(0,r.L)(s.regular.instancesData,a),transferList:a}}async extractEdgeLocations(e){const t=c(e),n=(0,i.hx)(t.data,t.skipDeduplicate,t.indices,t.indicesLength),s=(0,o.K)(n,l),a=[];return{result:(0,r.L)(s.regular.instancesData,a),transferList:a}}}function c(e){return{data:s.EdgeInputBufferLayout.createView(e.dataBuffer),indices:"Uint32Array"===e.indicesType?new Uint32Array(e.indices):"Uint16Array"===e.indicesType?new Uint16Array(e.indices):e.indices,indicesLength:e.indicesLength,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}function u(e,t){return t.push(e.regular.lodInfo.lengths.buffer),t.push(e.silhouette.lodInfo.lengths.buffer),{regular:{instancesData:(0,r.L)(e.regular.instancesData,t),lodInfo:{lengths:e.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:(0,r.L)(e.silhouette.instancesData,t),lodInfo:{lengths:e.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:e.averageEdgeLength}}const l=new class{allocate(e){return i.Jb.createBuffer(e)}trim(e,t){return e.slice(0,t)}write(e,t,n){e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1)}},f=new class{allocate(e){return i.extractComponentsEdgeLocationsLayout.createBuffer(e)}trim(e,t){return e.slice(0,t)}write(e,t,n){e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1),e.componentIndex.set(t,n.componentIndex)}}},69413:(e,t,n)=>{n.d(t,{T:()=>N,k:()=>m});var r=n(47249),s=n(20664),o=n(9392),i=n(57481),a=n(25672),c=n(96141);class u{updateSettings(e){this.settings=e,this._edgeHashFunction=e.reducedPrecision?p:g}write(e,t,n){A.seed=this._edgeHashFunction(n);const r=A.getIntRange(0,255),s=A.getIntRange(0,this.settings.variants-1),o=A.getFloat(),i=255*(.5*function(e,t){return Math.abs(e)**t*Math.sign(e)}(-(1-Math.min(o/.7,1))+Math.max(0,o-.7)/(1-.7),1.2)+.5);e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1),e.componentIndex.set(t,n.componentIndex),e.variantOffset.set(t,r),e.variantStroke.set(t,s),e.variantExtension.set(t,i)}}const l=new Float32Array(6),f=new Uint32Array(l.buffer),d=new Uint32Array(1);function g(e){return l[0]=e.position0[0],l[1]=e.position0[1],l[2]=e.position0[2],l[3]=e.position1[0],l[4]=e.position1[1],l[5]=e.position1[2],d[0]=31*(31*(31*(31*(31*(166811+f[0])+f[1])+f[2])+f[3])+f[4])+f[5],d[0]}function p(e){const t=l;t[0]=I(e.position0[0]),t[1]=I(e.position0[1]),t[2]=I(e.position0[2]),t[3]=I(e.position1[0]),t[4]=I(e.position1[1]),t[5]=I(e.position1[2]),d[0]=5381;for(let n=0;n<f.length;n++)d[0]=31*d[0]+f[n];return d[0]}const h=1e4;function I(e){return Math.round(e*h)/h}class N{constructor(){this._commonWriter=new u}updateSettings(e){this._commonWriter.updateSettings(e)}allocate(e){return c.gr.createBuffer(e)}write(e,t,n){this._commonWriter.write(e,t,n),(0,s.g)(O,n.faceNormal0,n.faceNormal1),(0,s.n)(O,O);const{typedBuffer:r,typedBufferStride:o}=e.normalCompressed;(0,a.aT)(r,t,O[0],O[1],O[2],o)}}N.Layout=c.gr,N.glLayout=(0,i.U)(c.gr,1);class m{constructor(){this._commonWriter=new u}updateSettings(e){this._commonWriter.updateSettings(e)}allocate(e){return c.In.createBuffer(e)}write(e,t,n){this._commonWriter.write(e,t,n);{const{typedBuffer:r,typedBufferStride:s}=e.normalCompressed;(0,a.aT)(r,t,n.faceNormal0[0],n.faceNormal0[1],n.faceNormal0[2],s)}{const{typedBuffer:r,typedBufferStride:s}=e.normal2Compressed;(0,a.aT)(r,t,n.faceNormal1[0],n.faceNormal1[1],n.faceNormal1[2],s)}}}m.Layout=c.In,m.glLayout=(0,i.U)(c.In,1);const O=(0,o.vt)(),A=new r.A},96141:(e,t,n)=>{n.d(t,{EdgeInputBufferLayout:()=>i,In:()=>l,gr:()=>u,vG:()=>f,vJ:()=>a,wO:()=>c});var r=n(57481),s=n(48549),o=n(66470);const i=(0,s.BP)().vec3f(o.r.POSITION).u16(o.r.COMPONENTINDEX).freeze(),a=(0,s.BP)().vec2u8(o.r.SIDENESS).freeze(),c=(0,r.U)(a),u=(0,s.BP)().vec3f(o.r.POSITION0).vec3f(o.r.POSITION1).vec2i16(o.r.NORMALCOMPRESSED).u16(o.r.COMPONENTINDEX).u8(o.r.VARIANTOFFSET,{glNormalized:!0}).u8(o.r.VARIANTSTROKE).u8(o.r.VARIANTEXTENSION,{glNormalized:!0}).freeze(),l=(0,s.BP)().vec3f(o.r.POSITION0).vec3f(o.r.POSITION1).vec2i16(o.r.NORMALCOMPRESSED).vec2i16(o.r.NORMAL2COMPRESSED).u16(o.r.COMPONENTINDEX).u8(o.r.VARIANTOFFSET,{glNormalized:!0}).u8(o.r.VARIANTSTROKE).u8(o.r.VARIANTEXTENSION,{glNormalized:!0}).freeze(),f=new Map([[o.r.POSITION0,0],[o.r.POSITION1,1],[o.r.COMPONENTINDEX,2],[o.r.VARIANTOFFSET,3],[o.r.VARIANTSTROKE,4],[o.r.VARIANTEXTENSION,5],[o.r.NORMALCOMPRESSED,6],[o.r.NORMAL2COMPRESSED,7],[o.r.SIDENESS,8]])}}]);
//# sourceMappingURL=50698.5ed31e4b.chunk.js.map