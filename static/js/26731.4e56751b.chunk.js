"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[26731],{6951:(t,e,n)=>{n.d(e,{Y7:()=>A,HS:()=>$,mm:()=>T,A:()=>M,k2:()=>N,ZA:()=>I,E8:()=>_,hF:()=>g,C5:()=>v,uK:()=>w,Pi:()=>b});var r=n(35143),i=(n(81806),n(76460)),o=n(88685),s=n(60984);function c(t,e,n){const r=e.split("\n");for(const i of r)if(i.trim().length){{let e="";null!=n&&(e+=`/*id:${n??"000"}*/   `),t.body+=e.padEnd(14)}t.body+=" ".repeat(t.indent)+i+"\n"}}class u{write(t){for(const e of t.rootOutputNodes())t.shouldPruneOutputNode(e)||(e.variableName=this._write(t,e.node));return t}_createVarName(t,e){let n="";return"boolean"!=typeof e&&"number"!=typeof e&&e.debugInfo.name&&(n=`${e.debugInfo.name}_`),`${n}v${t.varCount++}`}_write(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e)return e.toString();if("boolean"==typeof e)return e.toString();let r=t.getEmit(e);if(r)return r;switch(e.shaderType){case"scope-node":r=this._writeScopeNode(t,e);break;case"primitive-node":r=this._writePrimitiveNode(t,e,n);break;case"function-node":r=this._writeFunctionNode(t,e);break;case"property-access-node":r=this._writePropertyAccessNode(t,e);break;case"property-access-2d-node":r=this._writePropertyAccess2DNode(t,e);break;case"text-node":r=e.text;break;case"block-node":r=this._writeBlockNode(t,e);break;case"condition-node":r=this._writeConditionNode(t,e)}return t.setEmit(e,r),r}_writeScopeNode(t,e){const n=new e.child.constructor;n.setDebugName(e.debugInfo.name);const r=this._write(t,n,!0);return c(t,`{ /*ScopeStart: ${e.uid} ${e.debugInfo.name}*/`),t.indent+=2,c(t,`${r} = ${this._write(t,e.child)};`),t.indent-=2,c(t,`} /*ScopeEnd: ${e.uid} ${e.debugInfo.name}*/`),r}_writeConditionNode(t,e){const n=new e.ifTrue.constructor,r=this._write(t,n,!0);c(t,`if (${this._write(t,e.condition)}) {`),t.indent+=2;const i=t.createSubgraphContext(),o=this._write(i,e.ifTrue);if(t.body+=i.body,o&&c(t,`${r} = ${o};`),t.indent-=2,c(t,"}"),e.ifFalse){c(t,"else {"),t.indent+=2;const n=t.createSubgraphContext(),i=this._write(n,e.ifFalse);t.body+=n.body,i&&c(t,`${r} = ${i};`),t.indent-=2,c(t,"}")}return r}_writeBlockNode(t,e){const{captureList:n,generator:r,returnType:i}=e,o={};for(const c in n){if(!n[c])continue;const e=this._write(t,n[c]);o[c]=e}const s=new i,u=this._write(t,s,!0);if(o.out=u,e.subgraph){const n=t.createSubgraphContext(),r=this._write(n,e.subgraph.child),i=n.body;o.subgraph={varName:r,body:i}}const a=r(o);return c(t,"{\n"),t.indent+=2,c(t,a),t.indent-=2,c(t,"}\n"),u}_writePropertyAccessNode(t,e){const n=this._write(t,e.target);return"string"==typeof e.property&&e.property.includes("[")?`${n}${e.property}`:"string"!=typeof e.property?`${n}[${this._write(t,e.property)}]`:`${n}.${e.property}`}_writePropertyAccess2DNode(t,e){return`${this._write(t,e.target)}[${this._write(t,e.x)}][${this._write(t,e.y)}]`}_writeFunctionNode(t,e){const n=e.returnType.type;if(e.isInfix){const[r,i]=e.children.map((e=>this._write(t,e))),o=this._createVarName(t,e);return c(t,`${n.padEnd(5)} ${o} = ${r} ${e.token} ${i};`,e.uid),o}const r=e.children.map((e=>this._write(t,e))).join(", "),i=this._createVarName(t,e);return c(t,`${n.padEnd(5)} ${i} = ${e.token}(${r});`,e.uid),i}_writePrimitiveNode(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.getInput(e);if(r)return r.isUsed=!0,r.variableName;const i=1===e.children.length&&e.children[0]?.type===e.type;if(!e.isMutable&&(e.isImplicit||i))return this._write(t,e.children[0]);const o=this._createVarName(t,e);if(n)return c(t,`${e.type.padEnd(5)} ${o};`,e.uid),o;const s=!e.debugInfo.name&&!e.isMutable;if(s&&"float"===e.type&&"number"==typeof e.children[0])return Number.isInteger(e.children[0])?e.children[0].toFixed(1):e.children[0].toString();if(s&&"int"===e.type&&"number"==typeof e.children[0]&&Number.isInteger(e.children[0]))return e.children[0].toString();const u=e.children.map((e=>this._write(t,e))).join(", ");return"array"===e.type?(c(t,`${e.type.padEnd(5)} ${o} = [${u}];`,e.uid),o):s?`${e.type}(${u})`:(c(t,`${e.type.padEnd(5)} ${o} = ${e.type}(${u});`,e.uid),o)}}var a=n(22881);class d{constructor(t,e,n){this.variableName=t,this.variableInputType=e,this.node=n,this.type="shader-input",this.isUsed=!1}clone(){return new d(this.variableName,this.variableInputType,(0,a.vA)(this.node))}}class h{constructor(t,e,n){this.outVariableName=t,this.outVariableType=e,this.node=n,this.type="shader-output"}clone(){const t=new h(this.outVariableName,this.outVariableType,(0,a.vA)(this.node));return t.variableName=this.variableName,t}}class l{static createVertex(t,e,n,r,i,o){const s=[];for(const u in t){const e=t[u],r=n.get(u);r?s.push(new d(r,"builtin",e)):s.push(new d("a_"+u,"in",e))}for(const u of r){const t=u.uniformHydrated;s.push(new d(u.uniformName,"uniform",t))}const c=[];for(const u in e){const t=e[u];"glPosition"===u?c.push(new h("gl_Position","builtin",t)):"glPointSize"===u?c.push(new h("gl_PointSize","builtin",t)):c.push(new h("v_"+u,"out",t))}return new l(s,c,i,o)}static createFragment(t,e,n,r,i,o){const s=[],c=Array.from(i.rootOutputNodes());for(const a in t){const e=t[a],r=n.get(a);if(r){s.push(new d(r,"builtin",e));continue}const i=c.find((t=>t.node===e));i&&s.push(new d(i.outVariableName,"in",e))}for(const a of r){const t=a.uniformHydrated;s.push(new d(a.uniformName,"uniform",t))}const u=[];for(const a in e){const t=e[a],r=n.get(a);"discard"===a?u.push(new h(null,"discard",t)):r?u.push(new h(r,"builtin",t)):u.push(new h(a,"out",t))}return new l(s,u,o)}constructor(t,e,n,r){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const i of t)this._inputShaderTypesByNodeUid.set(i.node.uid,i);this._outputShaderTypes=e,this._transformFeedbackBindings=n,this._transformFeedbackNames=new Set(n.map((t=>"v_"+t.propertyKey))),this._usedInFragmentShader=r}shouldPruneOutputNode(t){return!!this._usedInFragmentShader&&"builtin"!==t.outVariableType&&!this._transformFeedbackNames.has(t.outVariableName)&&!this._usedInFragmentShader.has(t.node.uid)}setEmit(t,e){this._nodeEmitMap.set(t.uid,e)}getEmit(t){return this._nodeEmitMap.get(t.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(t){return this._inputShaderTypesByNodeUid.get(t.uid)}*rootOutputNodes(){for(const t of this._outputShaderTypes)yield t}*nodes(){const t=[];for(const e of this._outputShaderTypes.values())t.push(e.node);for(;t.length;){const e=t.pop();"number"!=typeof e&&"boolean"!=typeof e&&t.push(...e.children.filter(Boolean)),yield e}}*nodesOfTypeOrFunction(){for(const t of this.nodes())"number"!=typeof t&&"boolean"!=typeof t&&(yield t)}createSubgraphContext(){const t=this.clone();return t.body="",t.indent=this.indent+2,t._nodeEmitMap=new Map(this._nodeEmitMap),t}clone(){const t=new l([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return t._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,t.indent=this.indent,t.body=this.body,t.varCount=this.varCount,t._nodeEmitMap=this._nodeEmitMap,t}insertVertexShader(t){t.vertex.code.add(""),this._insertInputs(t,"vertex"),t.vertex.code.add(""),t.vertex.code.add("// OUTPUTS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this.rootOutputNodes()){const n="builtin"===e.outVariableType;this.shouldPruneOutputNode(e)||(n?t.vertex.code.add(`// ${e.outVariableType.padEnd(7)} ${e.node.type.padEnd(9)} ${e.outVariableName};`):t.vertex.code.add(`${e.outVariableType.padEnd(10)} ${e.node.type.padEnd(9)} ${e.outVariableName};`))}t.vertex.code.add(""),t.vertex.code.add("void main() {"),t.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())this.shouldPruneOutputNode(e)||t.vertex.code.add(`  ${e.outVariableName} = ${e.variableName};`);t.vertex.code.add("}")}insertFragmentShader(t){this._insertInputs(t,"fragment"),t.fragment.code.add(""),t.fragment.code.add("// OUTPUTS: "),t.fragment.code.add("// --------------------------------------------------------- ");let e=0;for(const n of this.rootOutputNodes())"builtin"===n.outVariableType?t.fragment.code.add(`// ${n.outVariableType.padEnd(7)} ${n.node.type.padEnd(9)} ${n.outVariableName};`):t.outputs.add(n.outVariableName,n.node.type,e++);t.fragment.code.add(""),t.fragment.code.add("void main() {"),t.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const n of this.rootOutputNodes())"discard"===n.outVariableType?(t.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),t.fragment.code.add(`  if (${n.variableName}) {`),t.fragment.code.add("    discard;"),t.fragment.code.add("  }"),t.fragment.code.add("  ")):t.fragment.code.add(`  ${n.outVariableName} = ${n.variableName};`);t.fragment.code.add("}")}_insertInputs(t,e){t[e].code.add("// INPUTS: "),t[e].code.add("// --------------------------------------------------------- ");for(const n of this.inputs())n.isUsed&&"builtin"!==n.variableInputType&&("array"===n.node.type?t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.elementType.type.padEnd(9)} ${n.variableName}[${n.node.size}];`):"array-2d"===n.node.type?t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.elementType.type.padEnd(9)} ${n.variableName}[${n.node.size}]; // Emulated 2D Array. Not supported by ES3.0`):t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.type.padEnd(9)} ${n.variableName};`))}}var p=n(78492),f=n(2687);function y(t){return new t}function m(t,e,n){const r=t.constructor[e]??[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:r.slice()}),t.constructor[e].push(n)}function v(t,e){return(n,r)=>{m(n,"locations",{typeCtor:e,propertyKey:r,parameterIndex:null,index:t})}}const g=t=>(e,n,r)=>{m(e,"inputs",{inputCtor:t,propertyKey:n,parameterIndex:r})},b=t=>(e,n)=>{m(e,"uniforms",{typeCtor:t,propertyKey:n})},w=t=>(e,n)=>{m(e,"options",{typeCtor:t,propertyKey:n})},_=(t,e)=>{m(t,"defines",{propertyKey:e})};const x=(t,e)=>(n,r)=>{n.constructor.builtins.push({builtin:t,propertyKey:r,typeCtor:e})};class I{}I.builtins=[],(0,r._)([x("gl_VertexID",s.Ai)],I.prototype,"glVertexID",void 0);class A{}class ${}$.builtins=[],(0,r._)([x("gl_FragCoord",s.Zb)],$.prototype,"glFragCoord",void 0),(0,r._)([x("gl_PointCoord",s.ZY)],$.prototype,"glPointCoord",void 0);class T{}(0,r._)([(t=>(e,n)=>{m(e,"builtins",{builtin:t,propertyKey:n})})("gl_FragDepth")],T.prototype,"glFragDepth",void 0);class N{constructor(){this.type="uniform-group"}get _uniforms(){return this.constructor.uniforms??[]}}class M{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const t=this._shaderModuleClass.inputs.findLast((t=>"vertex"===t.propertyKey&&0===t.parameterIndex));if(!t)throw new Error("Unable to find vertex input parameter");return t}get computeInput(){return this._shaderModuleClass.inputs.findLast((t=>"vertex"===t.propertyKey&&1===t.parameterIndex))}get fragmentInput(){const t=this._shaderModuleClass.inputs.findLast((t=>"fragment"===t.propertyKey));if(!t)throw new Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){return this.fragmentInput.inputCtor.transformFeedbackBindings??[]}get locations(){return[...this.vertexInput.inputCtor.locations,...this.computeInput?.inputCtor.locations??[]]}get locationsMap(){const t=new Map,e=new Set;for(const n of this.locations)e.has(n.index)?i.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${n.propertyKey} to ${n.index}. Index already in use`,{locationsMap:t}):(t.set(n.propertyKey,n.index),e.add(n.index));return t}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map((t=>{let[e,n]=t;return`${e}.${n}`})).join("."),n=(0,o.Wm)(e),r=this.computeAttributes;this._locationInfo={hash:n,stringHash:e,locations:t,computeAttributeMap:r}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set;for(const e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){return this._shaderModuleClass.defines??[]}get _options(){return this._shaderModuleClass.options??[]}get _uniforms(){return this._shaderModuleClass.uniforms??[]}getProgram(t,e,n,r){try{const{vertex:i,fragment:o,uniformBindings:s}=this._generateShaders(t,e,n,r);return new p.K(i,o,this.renamedLocationsMap,this.locationInfo,s,this.transformFeedbackBindings)}catch(i){return new p.K("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){const e=this._options.find((e=>e.propertyKey===t));if(e)return{type:"option",className:e.typeCtor};const n=this._uniforms.find((e=>e.propertyKey===t));if(!n)throw new Error(`Unable to find uniform class type for property: ${t}`);return{type:"required",className:n.typeCtor}}getShaderKey(t,e,n,r){const i=Object.keys(t).map((e=>`${e}.${t[e]}`)).join("."),o=Object.keys(n).map((t=>`${t}.${n[t]}`)).join("."),s=Object.keys(r).map((t=>`${t}.${r[t]}`)).join("."),c=Object.keys(e).filter((t=>this.optionPropertyKeys.has(t)&&e[t])).join(".");return`${this.type}.${i}.${o}.${s}.${c}`}_generateShaders(t,e,n,r){const i=[];this._setDefines(n),this._setOptionalUniforms(i,e),this._setRequiredUniforms(i);const o=this._hydrateVertexInput(r),s=this._injectPackPrecisionFactor(o,t),c=this._hydrateComputeInput(),d=c&&this._injectComputePackPrecisionFactor(c,t),h=this.vertex(s,d),p=this._hydrateFragmentInput(h),f=this.fragment(p),y=new Set;for(const u in f){const t=f[u];(0,a.rz)(y,t)}const m=this._getVertexInputBuiltins(),v=l.createVertex({...o,...c},h,m,i,this.transformFeedbackBindings,y);(new u).write(v);const g=this._getFragmentInputBuiltins(f);g.set("glPointCoord","gl_PointCoord");const b=l.createFragment(p,f,g,i,v,this.transformFeedbackBindings);(new u).write(b);const w=this._createShaderBuilder(v,b),_=w.generate("vertex"),x=w.generate("fragment");return this.logShader&&(console.log(_),console.log(x)),{vertex:_,fragment:x,uniformBindings:i}}_setDefines(t){for(const e in t)this[e]=t[e]}_setOptionalUniforms(t,e){for(const n of this._options)e[n.propertyKey]?this[n.propertyKey]=this._hydrateUniformGroup(t,n):this[n.propertyKey]=null}_setRequiredUniforms(t){for(const e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e)}_hydrateUniformGroup(t,e){const n=new(0,e.typeCtor);for(const r of n._uniforms??[]){const i=y(r.typeCtor),o=`u_${e.propertyKey}_${r.propertyKey}`,s=i.type,c=[e.propertyKey,r.propertyKey].join(".");if("type"in r.typeCtor&&"array"===r.typeCtor.type){const e=i;t.push({shaderModulePath:c,uniformName:o,uniformType:s,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:i})}else if("type"in r.typeCtor&&"array-2d"===r.typeCtor.type){const e=i;t.push({shaderModulePath:c,uniformName:o,uniformType:s,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:i})}else t.push({shaderModulePath:c,uniformName:o,uniformType:s,uniformHydrated:i});n[r.propertyKey]=i}return n}_hydrateVertexInput(t){const e=this.vertexInput.inputCtor,n=e.locations.reduce(((e,n)=>!1===t[n.propertyKey]?e:{...e,[n.propertyKey]:y(n.typeCtor)}),{});for(const{propertyKey:r,typeCtor:i}of e.builtins){const t=y(i);n[r]=t}return n}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce(((t,e)=>({...t,[e.propertyKey]:y(e.typeCtor)})),{})}_injectPackPrecisionFactor(t,e){const n={};for(const r in t){const i=t[r],o=e[r];if(o){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${i.type}`);n[r]=i.divide(new s.nt(o))}else n[r]=i}return n}_injectComputePackPrecisionFactor(t,e){const n={},r=new Map;for(const i in this.computeAttributes)for(const t of this.computeAttributes[i]??[])r.set(t,i);for(const i in t){const o=t[i],c=r.get(i);if(!c)continue;const u=e[c];if(u){if("float"!==o.type&&"vec2"!==o.type&&"vec3"!==o.type&&"vec4"!==o.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${o.type}`);n[i]=o.divide(new s.nt(u))}else n[i]=o}return n}_hydrateFragmentInput(t){const e={};for(const n in t)e[n]=t[n];for(const{propertyKey:n,typeCtor:r}of $.builtins){const t=y(r);e[n]=t}return e}_getVertexInputBuiltins(){const t=this.vertexInput.inputCtor,e=new Map;for(const{builtin:n,propertyKey:r}of t.builtins)e.set(r,n);return e}_getFragmentInputBuiltins(t){const e=t.constructor,n=new Map;for(const r of e.builtins??[])n.set(r.propertyKey,r.builtin);return n}_createShaderBuilder(t,e){const n=new f.N5;return this._insertDebugInfo(n),t.insertVertexShader(n),e.insertFragmentShader(n),n}_insertDebugInfo(t){t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._defines)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`);t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._options)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`)}}},22881:(t,e,n)=>{function r(t,e){const n=[];for(n.push(e);n.length;){const e=n.pop();if("object"==typeof e&&!t.has(e.uid)){t.add(e.uid);for(const t of e.children)n.push(t)}}}n.d(e,{XL:()=>d,aw:()=>l,ff:()=>a,rR:()=>h,rz:()=>r,vA:()=>o,vL:()=>s,zg:()=>u});class i{constructor(){this.uid=i.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(t){return t=function(t){return t.split(" ").map(((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t)).join("")}(t),this._debugName=t,this.isImplicit&&this.children[0]instanceof i&&this.children[0].setDebugName(t),this}get debugInfo(){return{name:this._debugName??""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid}}function o(t){return"object"==typeof t?t.clone():t}i.NodeCount=0;class s extends i{constructor(){super(...arguments),this.shaderType="primitive-node"}}class c extends i{constructor(t){super(),this.child=t,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const t=new c(o(this.child));return this.cloneInto(t),t}}class u extends i{constructor(t,e,n){super(),this.property=t,this.target=e,this.returnType=n,this.shaderType="property-access-node"}get children(){const t=[this.target];return"string"!=typeof this.property&&t.push(this.property),t}clone(){const t=new u(this.property,o(this.target),this.returnType);return this.cloneInto(t),t}}class a extends i{constructor(t,e,n,r){super(),this.x=t,this.y=e,this.target=n,this.returnType=r,this.shaderType="property-access-2d-node"}get children(){return[this.target,this.x,this.y]}clone(){const t=new a(this.x,this.y,o(this.target),this.returnType);return this.cloneInto(t),t}}class d extends i{constructor(t,e,n){super(),this.condition=t,this.ifTrue=e,this.ifFalse=n,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const t=o(this.ifTrue),e=this.ifFalse?o(this.ifFalse):null,n=new d(this.condition,t,e);return this.cloneInto(n),n}}class h extends i{constructor(t,e,n,r){super(),this.captureList=t,this.returnType=e,this.generator=r,this.shaderType="block-node",n&&(this.subgraph=new c(n))}get children(){return Object.keys(this.captureList).map((t=>this.captureList[t])).concat(this.subgraph??[])}clone(){const t={};for(const n in this.captureList)t[n]=o(this.captureList[n]);const e=new h(t,this.returnType,this.subgraph?o(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}}class l extends i{constructor(t,e,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];super(),this.token=t,this._children=e,this.isInfix=n,this.isPropertyAccess=r,this.returnType=i,this.isTernary=o,this.shaderType="function-node"}get children(){return this._children}clone(){const t=new l(this.token,this._children.map(o),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}}},32743:(t,e,n)=>{var r;n.d(e,{N:()=>r}),function(t){t[t.AnimatedMarker=0]="AnimatedMarker",t[t.Blend=1]="Blend",t[t.ComplexFill=2]="ComplexFill",t[t.ComplexOutlineFill=3]="ComplexOutlineFill",t[t.DotDensity=4]="DotDensity",t[t.Fill=5]="Fill",t[t.GradientFill=6]="GradientFill",t[t.GradientStroke=7]="GradientStroke",t[t.Grid=8]="Grid",t[t.Heatmap=9]="Heatmap",t[t.Label=10]="Label",t[t.Line=11]="Line",t[t.Magnifier=12]="Magnifier",t[t.Marker=13]="Marker",t[t.OutlineFill=14]="OutlineFill",t[t.Overlay=15]="Overlay",t[t.PatternFill=16]="PatternFill",t[t.PatternOutlineFill=17]="PatternOutlineFill",t[t.PieChart=18]="PieChart",t[t.Test=19]="Test",t[t.Text=20]="Text",t[t.TexturedLine=21]="TexturedLine",t[t.Bitmap=22]="Bitmap"}(r||(r={}))},60984:(t,e,n)=>{n.d(e,{$5:()=>vt,$I:()=>G,AU:()=>Bt,Ai:()=>O,Bw:()=>Pt,F8:()=>zt,Gb:()=>lt,Io:()=>St,LC:()=>yt,LI:()=>Vt,MM:()=>gt,My:()=>x,Ny:()=>z,Om:()=>kt,PM:()=>Rt,RI:()=>Ft,RZ:()=>Gt,S8:()=>Ot,Sj:()=>pt,T9:()=>Et,TF:()=>Dt,Tk:()=>st,U:()=>D,US:()=>Ht,Uo:()=>_t,Wh:()=>H,Xe:()=>mt,ZY:()=>T,Zb:()=>M,Zc:()=>Z,aX:()=>bt,eB:()=>N,eR:()=>X,fV:()=>q,gn:()=>Mt,j1:()=>ct,jc:()=>Ct,jh:()=>Kt,jk:()=>Lt,ln:()=>Y,lw:()=>ut,mk:()=>Tt,n7:()=>jt,nf:()=>ft,nt:()=>$,om:()=>ot,or:()=>wt,qE:()=>Nt,rY:()=>$t,tn:()=>xt,w0:()=>W,x:()=>P,z7:()=>A,ze:()=>it,zi:()=>Ut});var r,i,o,s,c,u,a,d,h,l,p,f,y,m,v=n(35143),g=n(22881);function b(t){return new Proxy(t,{get(e,n){if("constructor"===n)return new Proxy(e.constructor,{construct:(t,e,n)=>b(new t(...e))});if(n in e)return e[n];if("string"==typeof n){const e=function(t){const e=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const n of e)if(n.includes(t))return n.map((t=>R[t]));throw new Error("Unable to find type family")}(t.type);return J(t,n,e[n.length-1])}}})}function w(t){return new Proxy(t,{construct:(t,e,n)=>b(new t(...e))})}class _ extends Error{}let x=r=class extends g.vL{constructor(t,e){super(),this.elementType=t,this.size=e,this.children=[],this.type="array"}clone(){const t=new r(this.elementType,this.size);return super.cloneInto(t),t}get(t,e){const n=new O(t),r=null!=e?new O(e):null;return null!=r?Q(this,n,r,function(t){switch(t.type){case"bool":case"bvec2":case"bvec3":case"bvec4":return P;case"float":case"vec2":case"vec3":case"vec4":return $;case"int":case"ivec2":case"ivec3":case"ivec4":return O;case"uint":case"uvec2":case"uvec3":case"uvec4":return S;default:throw new Error("Unable to handle type")}}(this.elementType.constructor)):J(this,n,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=new O(n).setMutable().setDebugName("FindIndexIterator"),o=e(t.get(i)).setDebugName("FindIndexPredicate"),s=ot({iter:i},O,o,(t=>{let{out:e,iter:n,subgraph:i}=t;return`\n${e} = -1;\n\nfor (; ${n} < ${r}; ${n}++) {\n\n${i.body}\n\n  if (${i.varName}) {\n    ${e} = ${n};\n    break;\n  }\n\n}\n`})).setDebugName("FindIndexBlock");return s}(this,t,e,n)}glslFindIndex(t,e,n){return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.size;const i=ot({array:t},O,null,(t=>{let{out:i,array:o}=t;return`\n${i} = -1;\nfor (int i = ${n}; i < ${r}; i++) {\n  bool condition;\n  ${e({array:o,i:"i",out:"condition"})}\n  if (condition) {\n    ${i} = i;\n    break;\n  }\n}\n`})).setDebugName("GlslFindIndexBlock");return i}(this,t,e,n)}static ofType(t,e){const n={construct:(n,i)=>new r(new t,e)};return new Proxy(r,n)}};x.type="array",x=r=(0,v._)([function(t){return new Proxy(t,{construct:(t,e,n)=>function(t){return new Proxy(t,{get(e,n){if(n in e)return e[n];if("string"==typeof n){const e=parseInt(n,10);if(!isNaN(e))return J(t,`[${e}]`,t.elementType.constructor)}}})}(new t(...e))})}],x);class I extends g.vL{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.elementType=t,this.xSize=e,this.ySize=n,this.isRowMajor=r,this.children=[],this.type="array-2d"}clone(){const t=new I(this.elementType,this.xSize,this.ySize,this.isRowMajor);return super.cloneInto(t),t}get size(){return this.xSize*this.ySize}get(t,e){return this.isRowMajor?this._getRowMajor(t,e):this._getColumnMajor(t,e)}_getColumnMajor(t,e){const n=new O(t);return J(this,new O(e).add(n.multiply(this.xSize)),this.elementType.constructor)}_getRowMajor(t,e){const n=new O(t),r=new O(e);return J(this,n.add(r.multiply(this.ySize)),this.elementType.constructor)}static ofType(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Proxy(x,{construct:(i,o)=>new I(new t,e,n,r)})}}I.type="array-2d";class A extends g.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const t=new A;return t.children=this.children.map(g.vA),super.cloneInto(t),t}}A.type="sampler2D";class $ extends g.vL{constructor(t){super(),this.type="float",this.children=[t]}clone(){const t=new $((0,g.vA)(this.children[0]));return super.cloneInto(t),t}multiply(t){return ut(this,"number"==typeof t?K(t,$):t)}divide(t){return at(this,"number"==typeof t?K(t,$):t)}add(t){return dt(this,"number"==typeof t?K(t,$):t)}subtract(t){return ht(this,"number"==typeof t?K(t,$):t)}}$.type="float";let T=i=class extends g.vL{constructor(t,e){super(),this.type="vec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new i((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}get 0(){return J(this,"[0]",$)}get 1(){return J(this,"[1]",$)}get 2(){throw new _}get 3(){throw new _}multiply(t){return ut(this,"number"==typeof t?K(t,$):t)}divide(t){return at(this,"number"==typeof t?K(t,$):t)}add(t){return dt(this,"number"==typeof t?K(t,$):t)}subtract(t){return ht(this,"number"==typeof t?K(t,$):t)}};T.type="vec2",T=i=(0,v._)([w],T);let N=o=class extends g.vL{constructor(t,e,n){super(),this.type="vec3",this.children=[t,e,n].filter((t=>null!=t))}get 0(){return J(this,"[0]",$)}get 1(){return J(this,"[1]",$)}get 2(){return J(this,"[2]",$)}get 3(){throw new _}clone(){const t=new o((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}multiply(t){return ut(this,"number"==typeof t?K(t,$):t)}divide(t){return at(this,"number"==typeof t?K(t,$):t)}add(t){return dt(this,"number"==typeof t?K(t,$):t)}subtract(t){return ht(this,"number"==typeof t?K(t,$):t)}};N.type="vec3",N=o=(0,v._)([w],N);let M=s=class extends g.vL{constructor(t,e,n,r){super(),this.type="vec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new s((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}get 0(){return J(this,"[0]",$)}get 1(){return J(this,"[1]",$)}get 2(){return J(this,"[2]",$)}get 3(){return J(this,"[3]",$)}multiply(t){return ut(this,"number"==typeof t?K(t,$):t)}divide(t){return at(this,"number"==typeof t?K(t,$):t)}add(t){return dt(this,"number"==typeof t?K(t,$):t)}subtract(t){return ht(this,"number"==typeof t?K(t,$):t)}};M.type="vec4",M=s=(0,v._)([w],M);let S=c=class extends g.vL{constructor(t){super(),this.type="uint",this.children=[t]}clone(){const t=new c((0,g.vA)(this.children[0]));return super.cloneInto(t),t}};S.type="uint",S=c=(0,v._)([w],S);let k=u=class extends g.vL{constructor(t,e){super(),this.type="uvec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new u((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};k.type="uvec2",k=u=(0,v._)([w],k);let F=a=class extends g.vL{constructor(t,e,n){super(),this.type="uvec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new a((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};F.type="uvec3",F=a=(0,v._)([w],F);let C=d=class extends g.vL{constructor(t,e,n,r){super(),this.type="uvec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new d((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};C.type="uvec4",C=d=(0,v._)([w],C);class P extends g.vL{constructor(t){super(),this.type="bool",this.children=[t]}and(t){return _t(this,t)}or(t){return wt(this,t)}clone(){const t=new P((0,g.vA)(this.children[0]));return super.cloneInto(t),t}}P.type="bool";let E=h=class extends g.vL{constructor(t,e){super(),this.type="bvec2",this.children=[t,e].filter((t=>null!=t))}all(){return It(this)}any(){return At(this)}clone(){const t=new h((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};E.type="bvec2",E=h=(0,v._)([w],E);let L=l=class extends g.vL{constructor(t,e,n){super(),this.type="bvec3",this.children=[t,e,n].filter((t=>null!=t))}all(){return It(this)}any(){return At(this)}clone(){const t=new l((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};function K(t,e){return"number"==typeof t?new e(t):t}L.type="bvec3",L=l=(0,v._)([w],L);let U=p=class extends g.vL{constructor(t,e,n,r){super(),this.type="bvec4",this.children=[t,e,n,r].filter((t=>null!=t))}all(){return It(this)}any(){return At(this)}clone(){const t=new p((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};U.type="bvec4",U=p=(0,v._)([w],U);class O extends g.vL{constructor(t){super(),this.type="int",this.children=[t]}multiply(t){return ut(this,K(t,O))}add(t){return dt(this,K(t,O))}subtract(t){return ht(this,K(t,O))}divide(t){return at(this,K(t,O))}clone(){const t=new O((0,g.vA)(this.children[0]));return super.cloneInto(t),t}}O.type="int";let B=f=class extends g.vL{constructor(t,e){super(),this.type="ivec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new f((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};B.type="ivec2",B=f=(0,v._)([w],B);let j=y=class extends g.vL{constructor(t,e,n){super(),this.type="ivec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new y((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};j.type="ivec3",j=y=(0,v._)([w],j);let V=m=class extends g.vL{constructor(t,e,n,r){super(),this.type="ivec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new m((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};V.type="ivec4",V=m=(0,v._)([w],V);class z extends g.vL{constructor(t,e,n,r){super(),this.type="mat2",this.children=[t,e,n,r]}clone(){const t=new z((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}get(t,e){return Q(this,new O(t),new O(e),$)}multiply(t){return ut(this,t)}}z.type="mat2";class D extends g.vL{static identity(){return new D(1,0,0,0,1,0,0,0,1)}static fromRotation(t){const e=zt(t),n=Mt(t);return new D(n,e,0,it(e),n,0,0,0,1)}constructor(t,e,n,r,i,o,s,c,u){super(),this.type="mat3",this.children=[t,e,n,r,i,o,s,c,u]}add(t){return dt(this,t)}multiply(t){return ut(this,t)}get(t,e){return Q(this,new O(t),new O(e),$)}clone(){const t=new D((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]),(0,g.vA)(this.children[4]),(0,g.vA)(this.children[5]),(0,g.vA)(this.children[6]),(0,g.vA)(this.children[7]),(0,g.vA)(this.children[8]));return super.cloneInto(t),t}}D.type="mat3";class G extends g.vL{static identity(){return new G(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,n,r,i,o,s,c,u,a,d,h,l,p,f,y){super(),this.type="mat4",this.children=[t,e,n,r,i,o,s,c,u,a,d,h,l,p,f,y]}static fromColumns(t,e,n,r){return new G(t.x,t.y,t.z,t.w,e.x,e.y,e.z,e.w,n.x,n.y,n.z,n.w,r.x,r.y,r.z,r.w)}multiply(t){return ut(this,t)}get(t,e){return Q(this,new O(t),new O(e),$)}clone(){const t=new G((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]),(0,g.vA)(this.children[4]),(0,g.vA)(this.children[5]),(0,g.vA)(this.children[6]),(0,g.vA)(this.children[7]),(0,g.vA)(this.children[8]),(0,g.vA)(this.children[9]),(0,g.vA)(this.children[10]),(0,g.vA)(this.children[11]),(0,g.vA)(this.children[12]),(0,g.vA)(this.children[13]),(0,g.vA)(this.children[14]),(0,g.vA)(this.children[15]));return super.cloneInto(t),t}}G.type="mat4";const R={float:$,vec2:T,vec3:N,vec4:M,int:O,ivec2:B,ivec3:j,ivec4:V,uint:S,uvec2:k,uvec3:F,uvec4:C,bool:P,bvec2:E,bvec3:L,bvec4:U},H=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new O(...e)},q=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new $(...e)},Z=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new T(...e)},X=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new N(...e)},Y=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new M(...e)},W=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new D(...e)};function J(t,e,n){const r=new n(new g.zg(e,t,n));return r.isImplicit=!0,r}function Q(t,e,n,r){const i=new r(new g.ff(e,n,t,r));return i.isImplicit=!0,i}function tt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){const i=new r,o=new r(new g.aw(t,[e,n],!0,!1,i));return o.isImplicit=!0,o}if("float"===e.type||"int"===e.type){const r=new n.constructor(new g.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}if(("mat2"===e.type||"mat3"===e.type||"mat4"===e.type)&&"float"!==n.type){const r=new n.constructor(new g.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}const i=new e.constructor(new g.aw(t,[e,n],!0,!1,e.constructor));return i.isImplicit=!0,i}function et(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.constructor;const r=new n(new g.aw(t,[e],!1,!1,n));return r.isImplicit=!0,r}function nt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.constructor;const i=new r(new g.aw(t,[e,n],!1,!1,r));return i.isImplicit=!0,i}function rt(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.constructor;const o=new i(new g.aw(t,[e,n,r],!1,!1,i));return o.isImplicit=!0,o}function it(t){return ut(t,q(-1))}function ot(t,e,n,r){return new e(new g.rR(t,e,n,r))}function st(t,e,n){const r="function"==typeof e?e():e,i="function"==typeof n?n():n,o=new r.constructor(new g.XL(t,r,i));return o.isImplicit=!0,o}function ct(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map((t=>{let[e,n]=t;return"function"==typeof n?[e,n()]:[e,n]})),i=r[0][1].constructor,o=r.findIndex((t=>!0===t[0]));if(-1===o)throw new Error("A cond must have a fallthrough case with `true`/; ");const s=r.slice(0,o),c=r[o][1],u=new i(s.reduceRight(((t,e)=>st(e[0],e[1],t)),c));return u.isImplicit=!0,u}function ut(t,e){return tt("*",t,e)}function at(t,e){return tt("/",t,e)}function dt(t,e){return tt("+",t,e)}function ht(t,e){return tt("-",t,e)}function lt(t,e){return tt("%",t,e)}function pt(t,e){return tt(">>",t,e)}function ft(t,e){return tt("&",t,e)}function yt(t,e){return tt("==",t,e,P)}function mt(t,e){return tt("<",t,e,P)}function vt(t,e){return tt("<=",t,e,P)}function gt(t,e){return tt(">",t,e,P)}function bt(t,e){return tt(">=",t,e,P)}function wt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce(((t,e)=>function(t,e){return tt("||",t,e,P)}(t,e)),e[0])}function _t(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length<=1?e[0]:e.slice(1).reduce(((t,e)=>function(t,e){return tt("&&",t,e,P)}(t,e)),e[0])}function xt(t){return et("abs",t)}function It(t){return et("all",t,P)}function At(t){return et("any",t,P)}function $t(t,e){return null==e?et("atan",t):nt("atan",t,e,t.constructor)}function Tt(t){return et("ceil",t)}function Nt(t,e,n){return rt("clamp",t,e,n,t.constructor)}function Mt(t){return et("cos",t)}function St(t,e){return nt("distance",t,e,$)}function kt(t,e){return nt("dot",t,e,$)}function Ft(t){return et("floor",t)}function Ct(t){return et("fract",t)}function Pt(t){return et("length",t,$)}function Et(t,e){return nt("max",t,e)}function Lt(t,e){return nt("min",t,e)}function Kt(t,e,n){return rt("mix",t,e,n)}function Ut(t,e){return nt("mod",t,e)}function Ot(t){return et("normalize",t)}function Bt(t){return"bool"===t.type?et("!",t):et("not",t)}function jt(t,e){return nt("pow",t,e)}function Vt(t){return et("round",t)}function zt(t){return et("sin",t)}function Dt(t,e,n){return rt("smoothstep",t,e,n)}function Gt(t){return et("sqrt",t)}function Rt(t,e){return nt("step",t,e,e.constructor)}function Ht(t,e){return nt("texture",t,e,M)}},70479:(t,e,n)=>{n.d(e,{j:()=>i});var r=n(61551);class i{constructor(){this.drawPhase=r.S5.MAP|r.S5.HITTEST|r.S5.HIGHLIGHT|r.S5.DEBUG}startup(){}shutdown(t){}}},78492:(t,e,n)=>{n.d(e,{K:()=>h});var r=n(50076),i=n(76460),o=n(48611),s=(n(81806),n(47249),n(61678),n(93345),n(12331),n(44488)),c=(n(89179),n(29492)),u=n(96673);function a(t,e,n){const r=new u.R(e.width,e.height);return r.dataType=e.dataType,e.depth&&(r.depth=e.depth),e.flipped&&(r.flipped=e.flipped),e.hasMipmap&&(r.hasMipmap=e.hasMipmap),r.internalFormat=e.internalFormat,e.isImmutable&&(r.isImmutable=e.isImmutable),e.isOpaque&&(r.isOpaque=e.isOpaque),e.maxAnisotropy&&(r.maxAnisotropy=e.maxAnisotropy),r.pixelFormat=e.pixelFormat,e.preMultiplyAlpha&&(r.preMultiplyAlpha=e.preMultiplyAlpha),e.samplingMode&&(r.samplingMode=e.samplingMode),e.target&&(r.target=e.target),r.uniform=e.uniform,e.unpackAlignment&&(r.unpackAlignment=e.unpackAlignment),e.wrapMode&&(r.wrapMode=e.wrapMode),new c.g(t,r,n)}function d(t,e,n){const o=e.length;if(o!==n){const s=new r.default("Invalid Uniform",`Invalid length, expected ${n} but got ${o}`,{uniformName:t,values:e});i.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(s)}}class h{constructor(t,e,n,r,i,o){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=t,this.fragmentShader=e,this._locations=n,this._locationInfo=r,this._uniformBindings=i,this._transformFeedbackBindings=o}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(t){this._uniforms=t}cleanupTemporaryTextures(){for(const t of this._temporaryTextures)t.dispose();this._temporaryTextures=[]}bind(t){const e=this._uniforms;if(!this._program){const e=new Map;for(const[t,r]of this._locations)e.set(t,r);const n=[];for(const t of this._transformFeedbackBindings??[]){const{index:e,propertyKey:r}=t;n[e]=`v_${r}`}this._program=new s.B(t,this.vertexShader,this.fragmentShader,e,new Map,n)}const n=this._program;t.useProgram(n);for(const r of this._uniformBindings){const{shaderModulePath:i,uniformName:s,uniformType:c,uniformArrayLength:u}=r,h=(0,o.wc)(i,e);if(null==h){if("sampler2D"===c)continue;throw new Error(`Failed to find uniform value for ${i}`)}switch("array"===c||"array-2d"===c?r.uniformArrayElementType:c){case"sampler2D":{const{unit:e,texture:r}=h;if(n.setUniform1i(s,e),"type"in r)t.bindTexture(r,e);else{const n=a(t,r.descriptor,r.data);t.bindTexture(n,e)}break}case"int":if(!u){n.setUniform1i(s,h);break}d(r.uniformName,h,u),n.setUniform1iv(s,h);break;case"float":if(!u){n.setUniform1f(s,h);break}d(r.uniformName,h,u),n.setUniform1fv(s,h);break;case"vec2":if(!u){n.setUniform2f(s,h[0],h[1]);break}d(r.uniformName,h,u),n.setUniform2fv(s,h.flat());break;case"vec3":if(!u){n.setUniform3f(s,h[0],h[1],h[2]);break}d(r.uniformName,h,u),n.setUniform3fv(s,h.flat());break;case"vec4":if(!u){n.setUniform4f(s,h[0],h[1],h[2],h[3]);break}d(r.uniformName,h,u),n.setUniform4fv(s,h.flat());break;case"mat3":n.setUniformMatrix3fv(s,h);break;case"mat4":n.setUniformMatrix4fv(s,h);break;default:throw new Error(`Unable to set uniform for type ${c}`)}}}}}}]);
//# sourceMappingURL=26731.4e56751b.chunk.js.map