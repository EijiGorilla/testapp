"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[15062,59572],{15062:(e,t,a)=>{a.d(t,{T:()=>i});const i={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"}},59572:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var i=a(35143),l=(a(11265),a(19276)),n=a(45802),o=a(68134),s=a(96820),r=a(90534),c=a(46053),d=a(40565),p=(a(81806),a(47249),a(85842)),u=a(13312),h=a(80963),m=a(47437),b=a(54994),_=a(92706),v=a(25329),g=a(91967);a(76460);let y=class extends g.default{constructor(e){super(e),this.state="pending",this.url=""}initialize(){this.addHandles((0,o.watch)((()=>[this.extension,this.name]),(()=>this._setFormattedFileName()),o.initial))}_setFormattedFileName(){this.name&&this.extension&&(this.formattedName=this.count?`${this.name}(${this.count}).${this.extension}`:`${this.name}.${this.extension}`)}};(0,i._)([(0,c.MZ)()],y.prototype,"count",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"error",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"extension",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"formattedName",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"name",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"portalItem",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"state",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"url",void 0),y=(0,i._)([(0,p.$)("esri.widgets.Print.FileLink")],y);const f=y;var w=a(74571),T=a(94126),x=a(98108),k=a(87540),C=a(15062),K=a(76099),O=a(63582),S=a(54761),I=a(50265);const $=l.default.ofType(f),M="map-only";var E,L;(L=E||(E={})).layout="layoutTab",L.mapOnly="mapOnlyTab",L.export="exportTab";const F="esri-print",P=`${F}__advanced-options-button`,A={base:F,headerTitle:`${F}__header-title`,layoutTabList:`${F}__layout-tab-list`,layoutTab:`${F}__layout-tab`,layoutSection:`${F}__layout-section`,mapOnlySection:`${F}__map-only-section`,panelItemsCentered:`${F}__panel-items--centered`,loader:`${F}__loader`,advancedOptionsButton:P,advancedOptionsButtonContainer:`${P}-container`,advancedOptionsButtonTitle:`${P}-title`,advancedOptionsButtonIconOpened:`${P}-icon--opened`,advancedOptionsButtonIconClosed:`${P}-icon--closed`,advancedOptionsButtonIconClosed_RTL:`${P}-icon--closed-rtl`,swapButton:`${F}__swap-button`,printButton:`${F}__export-button`,printButtonSection:`${F}__export-button-section`,printButtonSectionDivider:`${F}__export-button-section--divider`,templateSelectContainer:`${F}__template-select-container`,templateSelectBlock:`${F}__template-select-block`,templateSelectIcon:`${F}__template-select-icon`,templateSelectError:`${F}__template-select-error`,templateSelectArrow:`${F}__template-select-arrow`,formSectionContainer:`${F}__form-section-container`,formCheckboxLabel:`${F}__form-checkbox-label`,advancedOptionsSection:`${F}__advanced-options-section`,advancedOptionsContainer:`${F}__advanced-options-container`,browseTemplateButtonContainer:`${F}__browse-template-button-container`,browseTemplateButtonContainerFilter:`${F}__browse-template-button-container-filter`,exportedFilesContainer:`${F}__export-panel-container`,exportedFilesTitle:`${F}__export-title`,exportedFile:`${F}__exported-file`,exportedFileLink:`${F}__exported-file-link`,exportedFileLinkTitle:`${F}__exported-file-link-title`,exportedFileLinkDescription:`${F}__exported-file-link-description`,exportedFilesEmpty:`${F}__exported-files-empty`,printWidgetContainer:`${F}__container`,content:`${F}__content`,panelContainer:`${F}__panel-container`,scaleInfoContainer:`${F}__scale-info-container`,scaleInputContainer:`${F}__scale-input-container`,scaleInput:`${F}__scale-input`,sizeContainer:`${F}__size-container`,panelError:`${F}__panel--error`,exportedFileError:`${F}__exported-file--error`,exportedFileLoader:`${F}__exported-file--loader`,exportSection:`${F}__export-section`,exportSectionCentered:`${F}__export-section--centered`,templateButtonContainer:`${F}__template-button-container`,templateDoneButton:`${F}__template-done-button`,templateSelectFlowItemContainer:`${F}__template-select-flow-item-container`,templateSelectFlowItemContent:`${F}__template-select-flow-item-content`,templateSelectFlowItemListHeading:`${F}__template-select-flow-item-list-heading`,srLabel:`${F}__sr-label`,invalidWkidText:`${F}__invalid-wkid-text`};function N(e){return e?.toLowerCase()===M}function B(e){const{state:t,extension:a}=e;switch(t){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return a?.toLowerCase()?.includes("pdf")?"file-pdf":"file"}}const Z=new n.J({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),D=new Map([["a3-landscape","a3-landscape"],["a3-portrait","a3-portrait"],["a4-landscape","a4-landscape"],["a4-portrait","a4-portrait"],["letter-ansi-a-landscape","ansi-a-landscape"],["letter-ansi-a-portrait","ansi-a-portrait"],["tabloid-ansi-b-landscape","ansi-b-landscape"],["tabloid-ansi-b-portrait","ansi-b-portrait"]]);let V=class extends v.default{constructor(e,t){super(e,t),this._activeTabFocusRequested=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._selectedTab=E.layout,this._pendingExportScroll=!1,this._rootNode=null,this._selectedTemplate=null,this._formats=[],this._showTemplates=!1,this._isValidSpatialReference=!0,this.allowedFormatsForSaving=null,this.browseTemplateButtonOnClick=null,this.exportedLinks=new $,this.headerVisible=!0,this.headingLevel=3,this.includeOrganizationTemplates=!0,this.messagesCommon=null,this.messagesUnits=null,this.saveExportEnabled=!1,this.saveExportHidden=!0,this.saveAsButtonCallback=null,this.viewModel=new w.default,this._onInput=e=>{this._selectedTab===E.layout?this.templateOptions.title=e.currentTarget.value:this._selectedTab===E.mapOnly&&(this.templateOptions.fileName=e.currentTarget.value)},this._handleLinkClick=e=>{const t=e.currentTarget["data-item"];if(!t||"ready"!==t.state||!t.url)return;const a=(0,b.gf)(this.viewModel.effectivePrintServiceUrl),i=t.url,l=document.createElement("a");if(l.target="_blank",l.href=i,l.rel="noreferrer",l.download=t.formattedName??"",!a)return l.click(),void e.stopPropagation();e.preventDefault();const n=new URL(i);n.searchParams.set("token",a),l.href=n.href,l.click(),l.href=i},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([(0,o.watch)((()=>[this.templateOptions.format,this.viewModel.templatesInfo?.format]),(()=>{const{templatesInfo:e}=this.viewModel;if(!e)return;if(this._formats.length!==e.format.choiceList.length){const t=_.U.apiValues;this._formats=e.format.choiceList.map((e=>{const a=t.find((t=>new RegExp(`\\b${t}\\b`,"i").test(e)))??e;return{value:a,label:e===a?e.toUpperCase():e}})).sort(((e,t)=>e.label.localeCompare(t.label)))}const t=this._formats.some((e=>{let{value:t}=e;return new RegExp(`\\b${t}\\b`,"i").test(this.templateOptions.format)}));if(!e.format.defaultValue||t);else{const t=this._formats.find((t=>{let{value:a}=t;return new RegExp(`\\b${a}\\b`,"i").test(e.format.defaultValue)}))?.value;t&&(this.templateOptions.format=t)}})),(0,o.watch)((()=>[this.templateOptions.id,this.viewModel.loaded]),(async()=>{const{layout:e}=this.templateOptions;this._selectedTab=N(e)?E.mapOnly:E.layout,this._selectedTab===E.layout&&this.viewModel.loaded&&(this._selectedTemplate=this.viewModel.getLayoutTemplateById(this.templateOptions.id))})),(0,o.watch)((()=>this.templateOptions.dpi),(e=>{e<=0&&(this.templateOptions.dpi=1)})),(0,o.watch)((()=>this.viewModel.view?.scale),(e=>{!e||this.templateOptions.scaleEnabled&&this.templateOptions.scale||(this.templateOptions.scale=e)}))]);for(const{name:i,extension:l}of this.exportedLinks)i&&l&&this._updateExportedFileNameMap(`${i}${l}`);const{height:e,width:t}=this.templateOptions;this.templateOptions.width=t||800,this.templateOptions.height=e||1100;const a=setTimeout((()=>{this._awaitingServerResponse=!0,this.scheduleRender()}),500);this.viewModel.load().then((()=>{clearTimeout(a),this._awaitingServerResponse=!1}))}loadDependencies(){return(0,T.W)({action:()=>Promise.resolve().then(a.bind(a,85375)),block:()=>a.e(75502).then(a.bind(a,75502)),button:()=>Promise.resolve().then(a.bind(a,43285)),checkbox:()=>Promise.resolve().then(a.bind(a,64990)),combobox:()=>a.e(64880).then(a.bind(a,64880)),"combobox-item":()=>a.e(73438).then(a.bind(a,73438)),flow:()=>a.e(87473).then(a.bind(a,87473)),"flow-item":()=>a.e(68445).then(a.bind(a,68445)),icon:()=>Promise.resolve().then(a.bind(a,16702)),input:()=>Promise.resolve().then(a.bind(a,38841)),"input-number":()=>a.e(41763).then(a.bind(a,41763)),label:()=>Promise.resolve().then(a.bind(a,11839)),list:()=>Promise.resolve().then(a.bind(a,75802)),"list-item":()=>Promise.resolve().then(a.bind(a,70205)),loader:()=>Promise.resolve().then(a.bind(a,35688)),switch:()=>a.e(8989).then(a.bind(a,8989)),chip:()=>Promise.resolve().then(a.bind(a,10239)),popover:()=>Promise.resolve().then(a.bind(a,51866)),link:()=>a.e(13549).then(a.bind(a,13549))})}destroy(){this.viewModel.destroy()}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get icon(){return"print"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get outSpatialReference(){return this.viewModel.outSpatialReference}set outSpatialReference(e){this.viewModel.outSpatialReference=e}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get showPrintAreaEnabled(){return this.viewModel.showPrintAreaEnabled}set showPrintAreaEnabled(e){this.viewModel.showPrintAreaEnabled=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get templateOptions(){return this.viewModel.templateOptions}set templateOptions(e){this.viewModel.templateOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{messages:e,templateOptions:t,viewModel:a,view:i}=this,{attributionEnabled:l,author:n,copyright:o,dpi:s,format:r,height:c,layout:p,layoutItem:m,legendEnabled:b,northArrowEnabled:_,scaleBarEnabled:v,scaleEnabled:g,scale:y,width:f}=t,w="ready"!==a.state||this._awaitingServerResponse||!(p||m),T=this._renderTitleOrFileNameSection(),O=(0,S.K)("div",{class:A.formSectionContainer},(0,S.K)("calcite-label",null,e.fileFormatTitle,(0,S.K)("calcite-combobox",{clearDisabled:!0,label:e.formatDefaultOption,maxItems:6,placeholder:e.formatDefaultOption,selectionMode:"single-persist",onCalciteComboboxChange:e=>{let{currentTarget:t}=e;this.templateOptions.format=t.selectedItems[0]?.value??"pdf"}},this._formats.map(((e,t)=>{let{value:a,label:i}=e;return(0,S.K)("calcite-combobox-item",{key:`file-format-${t}`,selected:a===this.templateOptions.format,textLabel:i,value:a})}))))),I=(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-switch",{checked:this.showPrintAreaEnabled,onCalciteSwitchChange:e=>{this.showPrintAreaEnabled=!!e.currentTarget.checked}}),e.printPreview),$=(0,S.K)("div",null,(0,S.K)("div",{class:A.formSectionContainer},(0,S.K)("calcite-label",null,e.template,(0,S.K)("calcite-block",{class:A.templateSelectContainer,collapsible:!1,description:this._getPageSizeLabel(this._selectedTemplate),heading:this._getTemplateLabel(this._selectedTemplate,!0),key:"template-select-block",loading:"loading"===this._selectedTemplate?.state,onclick:()=>this._showTemplates=!0,onkeydown:e=>{"Enter"!==e.key&&" "!==e.key||(this._showTemplates=!0)},tabIndex:0},(0,S.K)("calcite-icon",{class:A.templateSelectIcon,icon:(this._selectedTemplate?.layout?D.get(this._selectedTemplate.layout):null)||"custom-print",key:"template-select-icon",scale:"l",slot:"content-start"}),"error"===this._selectedTemplate?.state?(0,S.K)("calcite-icon",{class:A.templateSelectError,icon:"exclamation-mark-circle",key:"template-select-error",scale:"s",slot:"actions-end"}):null,(0,S.K)("calcite-icon",{class:A.templateSelectArrow,icon:(0,K.V8)()?"chevron-left":"chevron-right",key:"template-select-arrow",scale:"s",slot:"actions-end"})))),I),M=(0,S.K)("div",{class:A.formSectionContainer},(0,S.K)("calcite-label",null,e.dpi,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"dpi",min:1,value:`${s}`,onCalciteInputNumberInput:this._handleDPIChange}))),L=(0,S.K)("div",{class:A.formSectionContainer},(0,S.K)("calcite-label",null,(0,S.K)("div",{class:A.srLabel},e.outSpatialReference,(0,S.K)("calcite-link",{href:"https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references/",target:"_blank"},"(WKID)")),(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"outSpatialReference",integer:!0,numberButtonType:"none",value:a.outSpatialReference?.wkid?.toString()??"",onCalciteInputNumberInput:e=>{let{currentTarget:t}=e;const i=(0,d.Vr)(t.value);a.outSpatialReference=Number.isNaN(i)||null==i?null:new u.default({wkid:i}),this._isValidSpatialReference=!a.outSpatialReference||(0,h.fn)(a.outSpatialReference)}}),this._isValidSpatialReference?null:(0,S.K)("div",{class:A.invalidWkidText,key:`out-sr-${a.outSpatialReference?.wkid}`},e.invalidWkid))),F=(0,S.K)("div",{class:this.classes(A.scaleInfoContainer,A.formSectionContainer)},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:g,"data-option-name":"scaleEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.scale),(0,S.K)("div",{class:A.scaleInputContainer},(0,S.K)("calcite-input-number",{"aria-label":e.scaleLabel,"aria-valuenow":`${y}`,bind:this,class:A.scaleInput,"data-input-name":"scale",disabled:!g,value:`${y}`,onCalciteInputNumberInput:this._updateNumberInputValue}),(0,S.K)("calcite-button",{appearance:"outline","aria-label":e.reset,bind:this,disabled:!g,iconStart:"refresh",kind:"neutral",onclick:this._resetToCurrentScale}))),P=(0,S.K)("div",{"aria-labelledby":`${this.id}__advancedOptionsForLayout`,class:A.advancedOptionsContainer,key:"advanced-section-for-layout"},F,this._selectedTemplate?.layoutTemplateInfo?.layoutOptions?.hasAuthorText??1?(0,S.K)("div",{class:A.formSectionContainer,key:"author-info"},(0,S.K)("calcite-label",null,e.author,(0,S.K)("calcite-input",{bind:this,"data-input-name":"author",value:n??"",onCalciteInputInput:this._updateInputValue}))):null,this._selectedTemplate?.layoutTemplateInfo?.layoutOptions?.hasCopyrightText??1?(0,S.K)("div",{class:A.formSectionContainer,key:"copyright-text"},(0,S.K)("calcite-label",null,e.copyright,(0,S.K)("calcite-input",{bind:this,"data-input-name":"copyright",value:o??"",onCalciteInputInput:this._updateInputValue}))):null,M,L,this._renderCustomTextElementSection(),this._selectedTemplate?.layoutTemplateInfo?.layoutOptions?.hasLegend??1?(0,S.K)("div",{class:A.formSectionContainer,key:"legend-info"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!b,"data-option-name":"legendEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.legend)):null,this._selectedTemplate?.mapSurroundInfoOptions?.northArrow.length?(0,S.K)("div",{class:A.formSectionContainer,key:"north-arrow"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!_,"data-option-name":"northArrowEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.northArrow)):null,this._selectedTemplate?.mapSurroundInfoOptions?.scaleBar.length?(0,S.K)("div",{class:A.formSectionContainer,key:"scale-bar"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!v,"data-option-name":"scaleBarEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.scaleBar)):null),N=(0,S.K)("div",{"aria-labelledby":`${this.id}__advancedOptionsForMapOnly`,class:A.advancedOptionsContainer},F,M,L,(0,S.K)("div",{class:A.formSectionContainer},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:l,"data-option-name":"attributionEnabled",onCalciteCheckboxChange:this._toggleInputValue}),e.attribution)),this._renderCustomTextElementSection()),B=this.exportedLinks.toArray(),Z=this._renderExportedLinkItems(B),V={[A.exportSectionCentered]:!B.length},R=this._selectedTab===E.layout?(0,S.K)("section",{"aria-labelledby":`${this.id}__layoutTab`,class:A.layoutSection,id:`${this.id}__layoutContent`,key:"esri-print__layoutContent",role:"tabpanel"},(0,S.K)("div",{class:A.panelContainer},this._selectedTemplate?.layoutTemplateInfo?.layoutOptions?.hasTitleText??1?T:null,$,this._selectedTab===E.layout?O:null,(0,S.K)("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(A.panelContainer,A.advancedOptionsSection),collapsible:!0,disabled:!(p||m?.id),heading:e.advancedOptions,id:"advancedOptionsForLayout",key:"advanced-options-for-layout"},P))):this._selectedTab===E.mapOnly?(0,S.K)("section",{"aria-labelledby":`${this.id}__mapOnlyTab`,class:A.mapOnlySection,id:`${this.id}__mapOnlyContent`,key:"esri-print__mapOnlyContent",role:"tabpanel"},(0,S.K)("div",{class:A.panelContainer},T,O,(0,S.K)("div",null,(0,S.K)("div",{class:this.classes(A.sizeContainer,A.formSectionContainer)},(0,S.K)("calcite-label",null,e.width,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"width",value:`${f}`,onCalciteInputNumberInput:this._updateNumberInputValue})),(0,S.K)("calcite-label",null,e.height,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"height",value:`${c}`,onCalciteInputNumberInput:this._updateNumberInputValue})),(0,S.K)("button",{"aria-label":e.swap,bind:this,class:this.classes(x.D.widgetButton,A.swapButton,C.T.swap),onclick:this._switchInput,type:"button"})),I),(0,S.K)("calcite-block",{"aria-label":e.advancedOptions,class:this.classes(A.panelContainer,A.advancedOptionsSection),collapsible:!0,heading:e.advancedOptions,id:"advancedOptionsForMapOnly",key:"advanced-options-for-map-only"},N))):(0,S.K)("section",{"aria-labelledby":`${this.id}__exportTab`,class:this.classes(A.exportSection,V),id:`${this.id}__exportContent`,key:"esri-print__exportContent",role:"tabpanel"},(0,S.K)("div",{class:A.panelContainer},(0,S.K)("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:A.exportedFilesContainer},0===B.length?(0,S.K)("div",{class:A.exportedFilesEmpty},(0,S.K)("calcite-icon",{icon:"file",scale:"l"}),(0,S.K)("div",null,(0,S.K)(k.D,{class:A.exportedFilesTitle,level:this.headingLevel},e.noExportedFiles),(0,S.K)("div",null,e.exportHint))):Z))),U="2d"!==i?.type,z=(0,S.K)("div",{class:A.panelError},i?U?e.sceneViewError:e.serviceError:e.noViewError),H=B.some((e=>{let{state:t}=e;return"pending"===t})),W=(0,S.K)("div",{class:A.content,key:"panel"},(0,S.K)("div",null,(0,S.K)("ul",{bind:this,class:A.layoutTabList,onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===E.layout}`,class:A.layoutTab,"data-tab-id":E.layout,id:`${this.id}__layoutTab`,role:"tab",tabIndex:0},e.layoutTab),(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===E.mapOnly}`,class:A.layoutTab,"data-tab-id":E.mapOnly,id:`${this.id}__mapOnlyTab`,role:"tab",tabIndex:0},e.mapOnlyTab),(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${this._selectedTab===E.export}`,class:A.layoutTab,"data-tab-id":E.export,id:`${this.id}__exportedFilesTab`,role:"tab",tabIndex:0},H?(0,S.K)("calcite-loader",{inline:!0,label:"loading",scale:"s"}):null,e.exportsTab)),R),this._selectedTab!==E.export?(0,S.K)("div",{class:this.classes(A.printButtonSection,!this.saveExportHidden&&this.portal?A.printButtonSectionDivider:null),key:"export-button-section"},!this.saveExportHidden&&this.portal?(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:this.saveExportEnabled,onCalciteCheckboxChange:e=>{this.saveExportEnabled=!!e.currentTarget.checked}}),e.saveExportToMyContent):null,(0,S.K)("calcite-button",{"aria-label":e.exportDescription,bind:this,class:this.classes(A.printButton),disabled:w||!(p||m?.id)&&!r,onclick:this._handlePrintMap,scale:"l",width:"full"},e.export)):null),q=(0,S.K)("calcite-flow",{key:"root-flow"},(0,S.K)("calcite-flow-item",{bind:this,key:"root-flow-item",selected:!this._showTemplates},(0,S.K)("div",{class:A.printWidgetContainer},this.headerVisible?(0,S.K)("header",{class:A.headerTitle},e.export):null,this.error||U||!i?z:W)),this._renderChooseTemplateFlowItem()),j="initializing"===a.state,G=j?this._renderLoader():q,J={[A.panelItemsCentered]:j};return(0,S.K)("div",{bind:this,class:this.classes(A.base,x.D.widget,x.D.panel,J)},G)}_getPageSizeLabel(e){if(!e)return;const t=e.layoutTemplateInfo;if(!t)return;const a=Z.fromJSON(t.pageUnits.toLowerCase());return`${(0,I.ZV)(t.pageSize[0])} \xd7 ${(0,I.ZV)(t.pageSize[1])} ${(0,s.Cq)(this.messagesUnits,a,"abbr")}`}_getTemplateLabel(e){if(!e)return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.messages.selectTemplate:this.messages.untitled;const{label:t,layout:a,layoutItem:i,type:l}=e;if("print-service-template"===l&&this.messages[a])return this.messages[a];const n=t??a??i?.id;return n?.replaceAll("_"," ")??this.messages.untitled}_getPortalTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates&&this.includeOrganizationTemplates?this.viewModel.defaultTemplates.toArray().filter((t=>{let{layout:a,layoutItem:i}=t;return!N(a)&&!!i?.id&&e.includes(i.id)})):[]}_getDefaultTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates?this.viewModel.defaultTemplates.toArray().filter((t=>{let{layout:a,layoutItem:i}=t;return!(N(a)||i?.id&&e.includes(i.id))})):[]}_getPrintServiceTemplates(){return this.includeDefaultTemplates&&this._getDefaultTemplates().length?[]:this.viewModel.printServiceTemplates.toArray().filter((e=>{let{layout:t}=e;return!N(t)}))}_renderLayoutTemplates(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e.sort(((e,t)=>(e.label??"")>(t.label??"")?1:-1)),e.map((e=>(0,S.K)("calcite-list-item",{description:this._getPageSizeLabel(e),key:`template-${e.id}-${e.id===this.templateOptions.id}`,label:this._getTemplateLabel(e),selected:e.id===this.templateOptions.id,title:e.description??"",value:e},(0,S.K)("calcite-icon",{icon:(e.layout?D.get(e.layout):null)||"custom-print",slot:"content-start"}),"loading"===e.state?(0,S.K)("calcite-loader",{inline:!0,key:`template-loader-${e.id}`,label:"loading",scale:"s",slot:"content-end"}):null,"error"===e?.state?(0,S.K)("calcite-icon",{class:A.templateSelectError,icon:"exclamation-mark-circle",key:`template-error-${e.id}`,scale:"s",slot:"content-end"}):null,t?(0,S.K)("calcite-action",{icon:"trash",onclick:()=>this.viewModel.removePortalTemplate(e),slot:"actions-end",text:"delete"}):null)))}_renderChooseTemplateFlowItem(){if(!this._showTemplates)return null;const{messages:e}=this,t=m.oQ.test(this.portal?.url),a=this.viewModel.browseTemplates.toArray(),i=this._getPortalTemplates(),l=this._getDefaultTemplates(),n=this._getPrintServiceTemplates(),o=a.length+i.length+l.length+n.length>15,s=this.browseTemplateButtonOnClick?(0,S.K)("calcite-button",{appearance:"outline",class:o?A.browseTemplateButtonContainerFilter:A.browseTemplateButtonContainer,iconStart:"folder",key:"browse-template-button",onclick:this.browseTemplateButtonOnClick,slot:o?"filter-actions-end":"default"},o?null:e.browseTemplates):null;return(0,S.K)("calcite-flow-item",{bind:this,closable:!1,heading:e.chooseTemplate,key:"template-flow-item",selected:this._showTemplates,onCalciteFlowItemBack:e=>{e.preventDefault(),this._showTemplates=!1}},(0,S.K)("div",{class:A.templateSelectFlowItemContainer},(0,S.K)("div",{class:A.templateSelectFlowItemContent},o?null:s,(0,S.K)("calcite-list",{filterEnabled:o,filterProps:["label"],key:"template-list",label:e.templateList,selectionMode:"single-persist",onCalciteListChange:e=>{let{currentTarget:t}=e;return this.viewModel.applyTemplate(t.selectedItems[0]?.value)}},o?s:null,a.length?(0,S.K)("div",{key:"my-templates"},(0,S.K)("div",{class:A.templateSelectFlowItemListHeading},e.myTemplates,t?(0,S.K)("calcite-chip",{appearance:"outline",kind:"neutral",label:e.beta,scale:"s"},e.beta):null),this._renderLayoutTemplates(a,!0,!0)):null,i.length?(0,S.K)("div",{key:"org-templates"},(0,S.K)("div",{class:A.templateSelectFlowItemListHeading},e.organizationTemplates,t?(0,S.K)("calcite-chip",{appearance:"outline",kind:"neutral",label:e.beta,scale:"s"},e.beta):null),this._renderLayoutTemplates(i)):null,a.length||i.length?l.length?(0,S.K)("div",{key:"default-templates"},(0,S.K)("div",{class:A.templateSelectFlowItemListHeading},e.defaultTemplates),this._renderLayoutTemplates(l,!0)):null:this._renderLayoutTemplates(l,!0),a.length||i.length?n.length?(0,S.K)("div",{key:"service-templates"},(0,S.K)("div",{class:A.templateSelectFlowItemListHeading},e.defaultTemplates),this._renderLayoutTemplates(n)):null:this._renderLayoutTemplates(n))),(0,S.K)("div",{class:A.templateButtonContainer},(0,S.K)("calcite-button",{class:A.templateDoneButton,onclick:()=>this._showTemplates=!1},this.messagesCommon.done))))}_renderCustomTextElementSection(){const{customTextElements:e}=this.templateOptions;return e?(0,S.K)("div",{class:A.formSectionContainer,key:"custom-text-elements"},e.map(((e,t)=>{const[a,i]=Object.entries(e)[0];return"date"===a?null:(0,S.K)("calcite-label",{key:`custom-text-elements-${a}-${t}`},a,(0,S.K)("calcite-input",{bind:this,"data-input-custom":!0,"data-input-name":a,value:i??"",onCalciteInputInput:this._updateInputValue}))}))):null}_renderTitleOrFileNameSection(){const{title:e,fileName:t,titlePlaceHolder:a,fileNamePlaceHolder:i}=this.messages,l=this._selectedTab===E.layout?e:t,n=this._selectedTab===E.layout?a:i,o=this._selectedTab===E.layout?this.templateOptions.title:this.templateOptions.fileName;return(0,S.K)("div",{class:A.formSectionContainer,key:l},(0,S.K)("calcite-label",null,l,(0,S.K)("calcite-input",{placeholder:n,value:o??"",onCalciteInputInput:this._onInput})))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const t=e.getAttribute("data-tab-id");("layoutTab"===t&&this._selectedTab===E.layout||"mapOnlyTab"===t&&this._selectedTab===E.mapOnly||"exportTab"===t&&this._selectedTab===E.export)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[A.loader]:this._awaitingServerResponse};return(0,S.K)("div",{class:this.classes(e),key:"loader"})}_updateExportedFileNameMap(e){void 0!==this._exportedFileNameMap[e]?this._exportedFileNameMap[e]++:this._exportedFileNameMap[e]=0}_createFileLink(e,t){const a=t||this.messages.untitled,i=e.format.toLowerCase(),l=i.includes("png")?"png":i,n=a+l;return this._updateExportedFileNameMap(n),new f({name:a,extension:l,count:this._exportedFileNameMap[n]})}_resetToCurrentScale(){this.templateOptions.scale=this.viewModel.view?.scale}_updateCustomTextElementValue(e,t,a){e.find((e=>{const[a]=Object.entries(e)[0];return a===t}))[t]=a}_updateInputValue(e){const t=e.currentTarget,a=t.getAttribute("data-input-name"),i=!!t["data-input-custom"],{templateOptions:l}=this;i?this._updateCustomTextElementValue(l.customTextElements,a,t.value):l[a]=t.value}_updateNumberInputValue(e){const t=e.currentTarget,a=t.getAttribute("data-input-name"),{templateOptions:i}=this,l=Number(t.value);if(function(e){return!isNaN(e)&&e>0}(l))i[a]=l;else{const e=i[a];t.value=`${e}`}}_handleDPIChange(e){const{templateOptions:t}=this,a=t.dpi;this._updateNumberInputValue(e);const i=t.dpi,{height:l,width:n}=function(e,t,a,i){const l=a/t,n=i/t;return{width:Math.round(e*l),height:Math.round(e*n)}}(i,a,t.width,t.height);t.height=l,t.width=n}_handlePrintMap(){this._pendingExportScroll=!0;const{templateOptions:e,saveExportEnabled:t}=this,a=this.viewModel.toPrintTemplate(e),i=this._selectedTab===E.layout?a.layoutOptions?.titleText:e.fileName,l=this._createFileLink(a,i);this.exportedLinks.add(l),this.emit("submit",{link:l,saveExportEnabled:t}),this._selectedTab=E.export,this.viewModel.print(a).then((e=>{l.set({url:e&&e.url,state:"ready"})})).catch((e=>{l.set({error:e,state:"error"})})).then((()=>{this.emit("complete",{link:l,saveExportEnabled:t}),this.scheduleRender()}))}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_scrollExportIntoView(){if(!this._pendingExportScroll)return;this._pendingExportScroll=!1;const e=this._rootNode;if(!e)return;const{clientHeight:t,scrollHeight:a}=e,i=a-t;i>0&&(e.scrollTop=i)}_toggleInputValue(e){const t=e.target,a=t.getAttribute("data-option-name");this.templateOptions[a]=t.checked,"scaleEnabled"===a&&this._resetToCurrentScale()}_renderExportedLinkItemPopover(e){const t=this.messages,a=e.formattedName??"",{state:i}=e,l=this.saveAsButtonCallback&&"error"!==i&&this._isFormatAllowedForSaving(e.extension);return"pending"!==i&&l?(0,S.K)("calcite-popover",{autoClose:!0,key:`${a}-popover`,label:"Popover",offsetDistance:1,overlayPositioning:"fixed",pointerDisabled:!0,referenceElement:`${a}-popover-button`,scale:"s"},(0,S.K)("calcite-list",{label:""},e.portalItem?(0,S.K)("calcite-list-item",{label:t.openItem,onCalciteListItemSelect:()=>{const t=e.portalItem;if(!t||!t.itemPageUrl)return;const a=document.createElement("a");a.target="_blank",a.href=t.itemPageUrl,a.rel="noreferrer",a.click()}},(0,S.K)("calcite-icon",{icon:"launch2",key:`${a}-launch-icon`,scale:"s",slot:"content-start"})):(0,S.K)("calcite-list-item",{label:t.saveAs,onCalciteListItemSelect:async()=>{this.saveAsButtonCallback&&((0,o.whenOnce)((()=>e.portalItem)).then((e=>{e.itemPageUrl&&this.scheduleRender()})),await this.saveAsButtonCallback(e))}},(0,S.K)("calcite-icon",{icon:"save",key:`${a}-save-icon`,scale:"s",slot:"content-start"})),(0,S.K)("calcite-list-item",{label:this.messagesCommon.delete,onCalciteListItemSelect:()=>this.exportedLinks.remove(e)},(0,S.K)("calcite-icon",{icon:"trash",key:`${a}-delete-icon`,scale:"s",slot:"content-start"})))):null}_renderExportedLinkItemContent(e,t){const a=this.messages,{url:i,state:l}=e,n=e.formattedName??"";let o=i||null;o&&(o=(0,r.addProxy)(o));const s=(0,r.hasSameOrigin)(o,location.href);return(0,S.K)("div",{class:A.exportedFile,"data-item":e,onclick:this._handleLinkClick,slot:"content"},(0,S.K)("div",null,(0,S.K)("div",{class:A.exportedFileLinkTitle},n),(0,S.K)("div",{class:A.exportedFileLinkDescription},"pending"===l?a.generatingExport:t||(s?a.ready:a.linkReady))),"ready"===l?(0,S.K)("calcite-icon",{"aria-label":`${n}. ${a.linkReady}`,icon:s?"download-to":"launch",key:`${n}-end-icon`,scale:"s",slot:"content-end"}):null)}_renderExportedLinkItemIcon(e){const t=e.formattedName??"";return"pending"===e.state?(0,S.K)("calcite-loader",{class:A.exportedFileLoader,inline:!0,key:`${t}-loader`,label:this.messages.generatingExport,scale:"m",slot:"content-start"}):(0,S.K)("calcite-icon",{icon:B(e),key:`${t}-start-icon`,scale:"s",slot:"content-start"})}_renderExportedLinkItemAction(e,t){const{state:a}=e,i=e.formattedName??"",l=this.saveAsButtonCallback&&"error"!==a&&this._isFormatAllowedForSaving(e.extension);return"pending"!==a?(0,S.K)("calcite-action",{"aria-label":`${t}`,icon:l?"ellipsis":"x",id:l?`${i}-popover-button`:void 0,key:l?`${i}-saveAs-action`:`${i}-action`,onclick:l?void 0:()=>{this.exportedLinks.remove(e)},slot:"actions-end",text:`${t}`}):null}_renderExportedLinkItem(e){const t=this.messages,{error:a,state:i}=e,l=e.formattedName??"";let n;switch(i){case"pending":n=t.pending;break;case"ready":n=t.ready;break;case"error":n=t.errorMessage}const o="error"===i?"print-task:cim-symbol-unsupported"===a?.name?t.exportWebMapCIMError:t.exportWebMapError:"";return(0,S.K)(S.w,null,(0,S.K)("calcite-list-item",{"aria-label":n,key:l,title:o},this._renderExportedLinkItemContent(e,o),this._renderExportedLinkItemIcon(e),this._renderExportedLinkItemAction(e,o)),this._renderExportedLinkItemPopover(e))}_renderExportedLinkItems(e){return(0,S.K)("calcite-list",{filterEnabled:e?.length>10,label:this.messages.exportedLinksList},e.map(this._renderExportedLinkItem.bind(this)))}_isFormatAllowedForSaving(e){return!this.allowedFormatsForSaving||"all"===this.allowedFormatsForSaving||!(!e||!this.allowedFormatsForSaving.includes(e))}_toggleLayoutPanel(e){const t=e.target;this._toggleTab(t.getAttribute("data-tab-id"))}_toggleTab(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._selectedTab=e,this._selectedTab===E.mapOnly)this.templateOptions.reset(),this.templateOptions.layout=M;else if(this._selectedTab===E.layout){const e=this._selectedTemplate??this.viewModel.defaultTemplate;e?this.viewModel.applyTemplate(e):this.templateOptions.reset()}t&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const{key:t}=e,a=e.target.getAttribute("data-tab-id");if((0,K.OU)(t))return this._toggleTab(a),e.preventDefault(),void e.stopPropagation();if("ArrowLeft"===t||"ArrowRight"===t){switch(a){case E.layout:this._toggleTab("ArrowLeft"===t?E.export:E.mapOnly);break;case E.mapOnly:this._toggleTab("ArrowLeft"===t?E.layout:E.export);break;case E.export:this._toggleTab("ArrowLeft"===t?E.mapOnly:E.layout)}e.preventDefault(),e.stopPropagation()}}};(0,i._)([(0,c.MZ)()],V.prototype,"_showTemplates",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"_isValidSpatialReference",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"allowedFormats",null),(0,i._)([(0,c.MZ)()],V.prototype,"allowedFormatsForSaving",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"allowedLayouts",null),(0,i._)([(0,c.MZ)()],V.prototype,"browseTemplateButtonOnClick",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"error",null),(0,i._)([(0,c.MZ)({type:$})],V.prototype,"exportedLinks",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"extraParameters",null),(0,i._)([(0,c.MZ)()],V.prototype,"headerVisible",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"headingLevel",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"icon",null),(0,i._)([(0,c.MZ)()],V.prototype,"includeDefaultTemplates",null),(0,i._)([(0,c.MZ)()],V.prototype,"includeOrganizationTemplates",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"label",null),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/widgets/Print/t9n/Print")],V.prototype,"messages",void 0),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/t9n/common")],V.prototype,"messagesCommon",void 0),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/core/t9n/Units")],V.prototype,"messagesUnits",void 0),(0,i._)([(0,c.MZ)({type:u.default})],V.prototype,"outSpatialReference",null),(0,i._)([(0,c.MZ)()],V.prototype,"portal",null),(0,i._)([(0,c.MZ)()],V.prototype,"saveExportEnabled",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"saveExportHidden",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"showPrintAreaEnabled",null),(0,i._)([(0,c.MZ)()],V.prototype,"printServiceUrl",null),(0,i._)([(0,c.MZ)()],V.prototype,"saveAsButtonCallback",void 0),(0,i._)([(0,c.MZ)()],V.prototype,"templateCustomTextElements",null),(0,i._)([(0,c.MZ)()],V.prototype,"templateOptions",null),(0,i._)([(0,c.MZ)()],V.prototype,"view",null),(0,i._)([(0,c.MZ)({type:w.default})],V.prototype,"viewModel",void 0),V=(0,i._)([(0,p.$)("esri.widgets.Print")],V);const R=V}}]);
//# sourceMappingURL=59572.09495ecf.chunk.js.map