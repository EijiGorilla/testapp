"use strict";(self.webpackChunktestapp=self.webpackChunktestapp||[]).push([[9912,30295,65529,66635],{3320:(e,t,n)=>{n.d(t,{Au:()=>F,CU:()=>j,Et:()=>v,Gq:()=>V,H1:()=>S,HG:()=>w,Iy:()=>Z,Kl:()=>G,Kn:()=>B,LZ:()=>O,TN:()=>T,U3:()=>K,Ve:()=>U,XI:()=>M,bx:()=>x,cU:()=>I,k_:()=>_,lB:()=>z,l_:()=>P,n4:()=>H,nT:()=>b,oc:()=>A,qG:()=>q,rf:()=>g,s9:()=>k,t6:()=>R,tM:()=>$,vp:()=>C,wr:()=>E});n(11265);var i=n(18690),l=n(4212),r=n(53084),o=n(76460),a=n(88685),u=n(71764),s=n(15142),d=n(53430),p=n(31933),c=n(42633),f=n(20639),m=n(23301),y=n(26547),h=n(39348);const g=e=>"field"===e?.type,v=e=>"group"===e?.type,b=e=>"relationship"===e?.type,_=e=>"text"===e.type,F=e=>"utilityNetworkAssociations"===e.type,x=e=>!v(e)&&null!=e.group,E=e=>e.reduce(((e,t)=>v(t)?[...e,...t.inputs]:[...e,t]),[]),Z=e=>E(e).filter(g),I=e=>E(e).filter(b),T=e=>E(e).filter(F),M=e=>null!=e&&(w(e,"combo-box")||w(e,"radio-buttons")),w=(e,t)=>null!=e&&e.input?.type===t,V=e=>{let{domain:t,inputType:n="text-box",dataType:i}=e;return"number"===i&&"text-box"===n&&(!t||"coded-value"!==t.type)};function C(e,t){const{title:n,feature:i}=e??{};return n||(i?(0,y.R)(i):null)||t||""}function O(e){const{attributes:t,fieldsIndex:n,label:l,timeZone:r}=e;if(!t||"object"!=typeof t)return l;const o=Object.keys(t).filter((e=>(0,a.mk)(l,e))),u=o.map((e=>t[e])),s=o.map((e=>n.get(e))).filter(i.Ru);return function(e,t){return(0,a.HC)((0,a.HC)(e,(e=>`{${e.toLowerCase()}}`)),Object.fromEntries(Object.entries(t).map((e=>{let[t,n]=e;return[t.toLowerCase(),n]}))))}(l,U({values:u,fields:s,timeZone:r}))}const N="expression/",D="expr/",L="field/";function A(e){const[t,n]=e.split(N);return""===t&&n?n:(o.A.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${e} is not a valid expression reference of the form '${N}/expressionName'`),"")}function R(e){return`${N}${e}`}function S(e){return`${L}${e}`}function k(e){return e.startsWith(N)}function q(e){return e.startsWith(D)}function U(e){const{fields:t,values:n}=e,i=e.timeZone??void 0,l=t.map(((e,t)=>{let l=n[t];if(e.domain&&"coded-value"===e.domain.type){const t=e.domain.codedValues.find((e=>e.code===l));t?.name&&(l=t.name)}return((0,c.fs)(e)||(0,d.isTimeOnlyField)(e))&&(l=(0,f.ZP)(e,l,{timeZone:i,...(0,f.ZT)(e)})),[e.name,l]}));return Object.fromEntries(l)}const j=e=>{const t={typeFieldName:null,types:[]};return e?((0,p.Sv)(e)?(t.typeFieldName=e.parent?.subtypeField,t.types=e.parent?.subtypes??[]):"subtype-group"===e.type||"feature"===e.type&&e.subtypes?.length?(t.typeFieldName=e.subtypeField,t.types=e.subtypes??[]):"types"in e&&e.types&&(t.typeFieldName=e.typeIdField,t.types=e.types.map((e=>{let{id:t,name:n,domains:i}=e;return{code:t,name:n,domains:i}}))),null!=t.typeFieldName&&(t.typeFieldName=e.getField(t.typeFieldName)?.name??t.typeFieldName),t):t},$=(e,t,n)=>{const{dataType:i,error:l,minLength:r}=e,o=t?.validationErrors;if(!o||!l)return null;if(l===m.gK.CANNOT_BE_EMPTY)return o.cannotBeNull;if(l===s.Mh.VALUE_OUT_OF_RANGE||l===d.NumericRangeValidationError.OUT_OF_RANGE){const{field:t,range:l}=e,r={type:"date",intlOptions:{timeZone:"date"===t.type&&n?n:void 0,...(0,f.ZT)(t)}},a=(0,m.hQ)(l,o);return(0,h.V)(a,l,{format:{max:"date"===i?r:null!=l.max&&(0,m.qn)(l.max)?m.Qv:m.PA,min:"date"===i?r:null!=l.min&&(0,m.qn)(l.min)?m.Qv:m.PA}})}return l===s.Mh.INVALID_CODED_VALUE?o.invalidCodedValue:l===d.TypeValidationError.INVALID_TYPE?o.invalidType:l===m.gK.TOO_SHORT?(0,h.V)(o.tooShort,{min:r}):(m.gK.TOO_LONG,null)},P=e=>{if(!e)return;const t=e.layer,n=t&&"geometryType"in t?t.geometryType:void 0,i=e.geometry?.type;return"polyline"===i||"polyline"===n?"line":"mesh"===i||"mesh"===n||"multipatch"===n?"cube":"multipoint"===i||"multipoint"===n?"point":i||n||"table"},H=e=>{const t=[];if(e.formTemplate){const{description:n,title:i}=e.formTemplate;e.fields?.forEach((e=>{const l=i&&(0,a.mk)(i,e.name),r=n&&(0,a.mk)(n,e.name);(l||r)&&t.push(e.name)}))}return t};function z(e,t){const n=t??("formTemplate"in e&&e.formTemplate);return!!n&&(n.elements?.filter(u.jt)??[]).some((t=>{let{fieldName:n}=t;return!e.fieldsIndex.get(n)}))}function B(e,t){return null==e||t.onValue!==e&&t.offValue!==e}function G(e,t){switch(t.objectType){case"any":return!0;case"null":return null==e;case"code":return e===t.codedValue?.code;case"range":return null!=e&&null!=t.minValue&&null!=t.maxValue&&+e>=t.minValue&&+e<=t.maxValue;default:return(0,l.Xb)(t.objectType),!1}}function K(e,t,n){const i=(0,p.fV)(e),l=i?.find((e=>e.code===n));if(!l)return!1;const o=i?.find((e=>e.code===t));return!(0,r.equalsShallow)(l.defaultValues,o?.defaultValues)&&Object.values(l.defaultValues).some((e=>null!=e))}},9912:(e,t,n)=>{n.r(t),n.d(t,{applyTextFormattingHTML:()=>Q,createFieldInfoMap:()=>G,findRelatedLayer:()=>ae,findUtilityNetwork:()=>ue,fixTokens:()=>R,formatAttributes:()=>J,formatEditInfo:()=>B,formatValueToFieldInfo:()=>P,getAllFieldInfos:()=>K,getFieldInfo:()=>z,getFieldInfoLabel:()=>w,getFixedFieldName:()=>V,getFixedFieldNames:()=>C,getHighlightKeyForFeature:()=>pe,getSourceLayer:()=>Z,graphicCallback:()=>I,htmlEntities:()=>W,isAssociatedFeatureSupportedLayer:()=>j,isExpressionField:()=>M,isFeatureSupportedLayer:()=>k,isGraphicForRelatableFeatureSupportedLayer:()=>$,isRelatableFeatureSupportedLayer:()=>U,isRelatableLayer:()=>q,isRelatedField:()=>te,preLayerQueryCallback:()=>re,preRequestCallback:()=>oe,querySourceLayer:()=>Y,queryUpdatedFeature:()=>ee,shouldOpenInNewTab:()=>T,substituteAttributes:()=>L,substituteFieldsInLinksAndAttributes:()=>D});var i=n(81806),l=n(76460),r=n(88685),o=n(65256),a=n(50265),u=n(53430),s=n(31933),d=n(42633),p=n(98976),c=n(67478);const f=()=>l.A.getLogger("esri.widgets.Feature.support.featureUtils"),m=/href=(""|'')/gi,y=/(\{([^{\r\n]+)\})/g,h=/'/g,g=/^\s*expression\//i,v=/(\n)/gi,b=/[\u00A0-\u9999<>&]/gim,_=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,F=/^(?:mailto:|tel:)/,x="relationships/",E=(0,o.J2)("short-date-short-time");function Z(e){if(null!=e)return(e.sourceLayer||e.layer)??void 0}async function I(e){let{type:t,value:n,event:i}=e;try{return"function"==typeof n?n(i):await n}catch(l){return void f().error("error",`An error occurred when calling the "${t}" function`,{error:l,graphic:i.graphic,value:n})}}function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!F.test(e.trim().toLowerCase())}function M(e){return!!e&&g.test(e)}function w(e,t){const n=function(e,t){if(!t||!M(t)||!e)return;const n=t.replace(g,"").toLowerCase();return e.find((e=>{let{name:t}=e;return t.toLowerCase()===n}))}(t,e?.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function V(e,t){const n=O(t,e);return n?n.name:e}function C(e,t){return e&&e.map((e=>V(e,t)))}function O(e,t){return e&&"function"==typeof e.getField&&t?e.getField(t)??null:null}function N(e){return`${e}`.trim()}function D(e){let{attributes:t,globalAttributes:n,layer:i,text:l,expressionAttributes:r,fieldInfoMap:o}=e;return l?L({formattedAttributes:n,template:S(l,{...n,...r,...t},i),fieldInfoMap:o}):""}function L(e){let{formattedAttributes:t,template:n,fieldInfoMap:i}=e;return N(function(e){return e.replaceAll(m,"")}((0,r.HC)((0,r.HC)(n,(e=>function(e,t){const n=t.get(e.toLowerCase());return`{${n?.fieldName||e}}`}(e,i))),t)))}function A(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={...e};return Object.keys(n).forEach((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t[e];if("string"==typeof i){const l="%27",r=(n?encodeURIComponent(i):i).replaceAll(h,l);t[e]=r}}(e,n,t))),n}function R(e,t){return e.replaceAll(y,((e,n,i)=>{const l=O(t,i);return l?`{${l.name}}`:n}))}function S(e,t,n){const i=R(e,n);return i?i.replaceAll(_,((e,n,i)=>function(e,t,n){const i=(t=N(t))&&"{"!==t[0];return(0,r.HC)(e,A(n,i||!1))}(e,n||i,t))):i}function k(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"sublayer"===e.type)&&"when"in e}function q(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}function U(e){return k(e)&&q(e)}function j(e){return!(!(e&&"object"==typeof e&&"createQuery"in e&&"getField"in e&&"queryFeatureCount"in e&&"queryFeatures"in e&&"queryObjectIds"in e&&"capabilities"in e&&"fields"in e&&"fieldsIndex"in e&&"type"in e)||"feature"!==e.type&&"subtype-group"!==e.type&&"subtype-sublayer"!==e.type&&"sublayer"!==e.type||!("when"in e))&&("subtype-sublayer"===e.type&&"parent"in e&&e.parent&&"object"==typeof e.parent?"globalIdField"in e.parent:"globalIdField"in e)}function $(e){return!!e&&"object"==typeof e&&"sourceLayer"in e&&U(e.sourceLayer)}function P(e,t){const{fieldInfos:n,fieldName:i,preventPlacesFormatting:l,layer:r,timeZone:o}=t,s=z(n,i),p=O(r,i);if(s&&!(0,u.isRasterPixelValueField)(i)){const t=p?.type,n=s.format?.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||n)return(0,d.i0)(e,{format:n,fieldType:t,timeZoneOptions:{layerTimeZone:r&&"preferredTimeZone"in r?r.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone}})}const c=s?.format;return"string"==typeof e&&(0,u.isRasterPixelValueField)(i)&&c?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?H(e,",",", ",t):e.includes(";")?H(e,";","; ",t):e.includes(" ")?H(e," "," ",t):(0,a.ZV)(Number(e),(0,a.yx)(t))}(e,c):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,c))||null==e||null==c?Q(e):(0,a.ZV)(e,l?{...(0,a.yx)(c),minimumFractionDigits:0,maximumFractionDigits:20}:(0,a.yx)(c))}function H(e,t,n,i){return e.trim().split(t).map((e=>(0,a.ZV)(Number(e),(0,a.yx)(i)))).join(n)}function z(e,t){if(e?.length&&t)return e.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))}function B(e,t,n,i){const{creatorField:l,creationDateField:r,editorField:a,editDateField:u}=e;if(!t)return;const s=(0,c.hv)(i&&"preferredTimeZone"in i?i.preferredTimeZone:null,!(!i||!("datesInUnknownTimezone"in i))&&!!i.datesInUnknownTimezone,n,E,"date"),d={...E,...s},p=t[u];if("number"==typeof p){const e=t[a];return{type:"edit",date:(0,o.Yq)(p,d),user:e}}const f=t[r];if("number"==typeof f){const e=t[l];return{type:"create",date:(0,o.Yq)(f,d),user:e}}return null}function G(e,t){const n=new Map;if(!e)return n;for(const i of e){if(!i.fieldName)continue;const e=V(i.fieldName,t);i.fieldName=e,n.set(e.toLowerCase(),i)}return n}function K(e){const t=[];if(!e)return t;const{fieldInfos:n,content:i}=e;return n&&t.push(...n),i&&Array.isArray(i)?(i.forEach((e=>{if("fields"===e.type){const n=e?.fieldInfos;n&&t.push(...n)}})),t):t}function W(e){return e.replaceAll(b,(e=>`&#${e.charCodeAt(0)};`))}function Q(e){return"string"==typeof e?e.replaceAll(v,'<br class="esri-text-new-line" />'):e}function X(e){const{value:t,fieldName:n,fieldInfos:l,fieldInfoMap:r,layer:o,graphic:a,timeZone:s}=e;if(null==t)return"";const p=function(e){let{fieldName:t,value:n,graphic:l,layer:r}=e;if(te(t))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const o=l&&r.getFieldDomain(t,{feature:l,excludeImpliedDomains:(0,i.A)("esri-widget-legacy-field-domain-calculation")});return o&&"coded-value"===o.type?o.getName(n):null}({fieldName:n,value:t,graphic:a,layer:o});if(p)return p;const c=function(e){let{fieldName:t,graphic:n,layer:i}=e;if(te(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:l}=i;if(!l||t!==l)return null;const r=i.getFeatureType(n);return r?r.name:null}({fieldName:n,graphic:a,layer:o});if(c)return c;if(r.get(n.toLowerCase()))return P(t,{fieldInfos:l||Array.from(r.values()),fieldName:n,layer:o,timeZone:s});const f=o?.fieldsIndex?.get(n);return f&&((0,d.fs)(f)||(0,u.isTimeOnlyField)(f))?(0,d.i0)(t,{fieldType:f.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:s,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}}):Q(t)}function J(e){let{fieldInfos:t,attributes:n,layer:i,graphic:l,fieldInfoMap:r,relatedInfos:o,timeZone:a}=e;const u={};return o?.forEach((e=>function(e){let{attributes:t,relatedInfo:n,fieldInfoMap:i,fieldInfos:l,layer:r,timeZone:o}=e;t&&n&&(n.relatedFeatures?.forEach((e=>ne({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:i,fieldInfos:l,layer:r,timeZone:o}))),n.relatedStatsFeatures?.forEach((e=>ne({attributes:t,graphic:e,relatedInfo:n,fieldInfoMap:i,fieldInfos:l,layer:r,timeZone:o}))))}({attributes:u,relatedInfo:e,fieldInfoMap:r,fieldInfos:t,layer:i,timeZone:a}))),n&&Object.keys(n).forEach((e=>{const o=n[e];u[e]=X({fieldName:e,fieldInfos:t,fieldInfoMap:r,layer:i,value:o,graphic:l,timeZone:a})})),u}async function Y(e,t){const{layer:n,graphic:i,outFields:l,objectIds:r,returnGeometry:o,spatialReference:a}=e,u=r[0];if("number"!=typeof u&&"string"!=typeof u){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:n,graphic:i,objectId:u,requiredFields:l};return f().warn(e,t),null}if(!(0,s.BR)(n)?.operations?.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:n,graphic:i,requiredFields:l,returnGeometry:o};return f().warn(e,t),null}const d=n.createQuery();return d.objectIds=r,d.outFields=l?.length?l:[n.objectIdField],d.returnGeometry=!!o,d.returnZ=!!o,d.returnM=!!o,d.outSpatialReference=a,(await n.queryFeatures(d,t)).features[0]}async function ee(e,t){let{graphic:n,popupTemplate:i,layer:l,spatialReference:r}=e;if(!l||!i)return;if("function"==typeof l.load&&await l.load(t),!n.attributes)return;const o=l.objectIdField,a=n.attributes[o];if(null==a)return;const s=[a],d=await i.getRequiredFields(l.fieldsIndex),c=(0,u.featureHasFields)(d,n),f=c?[]:d.includes(o)?d:[...d,o],m=i.returnGeometry||await async function(e){if(!e.expressionInfos?.length)return!1;const t=await(0,p.lw)(),{arcadeUtils:{hasGeometryFunctions:n}}=t;return n(e)}(i);if(c&&!m)return;const y=await Y({layer:l,graphic:n,outFields:f,objectIds:s,returnGeometry:m,spatialReference:r},t);y&&(y.geometry&&(n.geometry=y.geometry),y.attributes&&(n.attributes={...n.attributes,...y.attributes}))}function te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(x)}function ne(e){let{attributes:t,graphic:n,relatedInfo:i,fieldInfos:l,fieldInfoMap:r,layer:o,timeZone:a}=e;t&&n&&i&&Object.keys(n.attributes).forEach((e=>{const u=function(e){return`${x}${e.layerId}/${e.fieldName}`}({layerId:i.relation.id.toString(),fieldName:e}),s=n.attributes[e];t[u]=X({fieldName:u,fieldInfos:l,fieldInfoMap:r,layer:o,value:s,graphic:n,timeZone:a})}))}const ie=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},le=e=>{let{layer:t,method:n,query:i,definitionExpression:l}=e;if(!t.capabilities?.query?.supportsCacheHint||"attachments"===n)return;const r=null!=i.where?i.where:null,o=null!=i.geometry?i.geometry:null;ie(l)||ie(r)||"extent"===o?.type||"tile"===i.resultType||(i.cacheHint=!0)},re=e=>{let{query:t,layer:n,method:i}=e;le({layer:n,method:i,query:t,definitionExpression:`${n.definitionExpression} ${n.serviceDefinitionExpression??""}`})},oe=e=>{let{queryPayload:t,layer:n,method:i}=e;le({layer:n,method:i,query:t,definitionExpression:`${n.definitionExpression} ${n.serviceDefinitionExpression??""}`})};function ae(e,t,n){return e&&t&&n?"sublayer"===t.type?de({layers:t.layer?.sublayers,map:e,relatedLayer:t,relationship:n})||de({layers:t.layer?.subtables,map:e,relatedLayer:t,relationship:n}):de({layers:e.allLayers,map:e,relatedLayer:t,relationship:n})||de({layers:e.allTables,map:e,relatedLayer:t,relationship:n}):null}function ue(e,t){return e&&"utilityNetworks"in e&&t?e.utilityNetworks?.find((e=>e.isUtilityLayer(t))):null}function se(e,t){return e?.allTables.find((e=>"feature"===e.type&&e.layerId===t.id&&e.url===t.layer?.url))}function de(e){let{map:t,relationship:n,relationship:{relatedTableId:i},relatedLayer:l,layers:r}=e;if(!r)return null;for(const o of r){if("map-image"===o.type){const e=de({layers:o.sublayers,map:t,relatedLayer:l,relationship:n})||de({layers:o.subtables,map:t,relatedLayer:l,relationship:n});if(e)return e;continue}if(!U(o))continue;if("sublayer"===l.type){if(o!==l&&o.id===i)return o.isTable?se(t,o):o;continue}const e="scene"===l.type&&l.associatedLayer?l.associatedLayer.url:l.url;if(!e)return null;if("sublayer"!==o.type){if(o!==l&&o.url===e&&o.layerId===i)return o}else if(o!==l&&o.layer?.url===e&&o.id===i)return o.isTable?se(t,o):o}return null}function pe(e){const t=e.getObjectId();return null!=t?`oid:${t}`:`uid:${e.uid}`}},20639:(e,t,n)=>{n.d(t,{Ng:()=>E,OM:()=>g,Q0:()=>_,T8:()=>b,ZP:()=>x,ZT:()=>F,eX:()=>T,fD:()=>V,fb:()=>m,fl:()=>f,iP:()=>w,oh:()=>Z,rX:()=>C,sH:()=>y,yk:()=>O});n(11265),n(81806);var i=n(50076),l=n(15941),r=n(65256),o=n(96017),a=n(85632),u=n(36693),s=n(24241),d=n(38042);const p=u.n$,c={date:null,time:null,timeZoneOffset:null},f=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]),m="latn",y=new Set(["date-only","time-only","timestamp-offset"]),h=e=>"valueAsDate"in e;function g(e){return{locale:(0,d.JK)(),numberingSystem:m,zone:e??p}}function v(e,t){return null==e?null:s.c9.fromMillis(e,g(t))}function b(e,t){if(null==e||!(0,a.Kg)(e)||""===e){if(t){const e=s.c9.local({zone:t});return{date:null,time:null,timeZoneOffset:e.isValid?e.offset.toString():null}}return c}const n=s.c9.fromISO(e,{setZone:!0});return{date:n.toFormat(o.mo,g()),time:n.toFormat(o.Uq.HMS_MS,g()),timeZoneOffset:n.offset.toString()}}function _(e,t){if(null==e||!(0,a.Et)(e)||isNaN(e))return c;const n=v(e,t);return n?{date:n.toFormat(o.mo,g(t)),time:n.toFormat(o.Fj,g(t))}:c}function F(e){switch(e.type){case"date":default:return(0,r.J2)("short-date-short-time");case"date-only":return(0,r.J2)("short-date");case"time-only":return(0,r.J2)("short-time");case"timestamp-offset":return{...(0,r.J2)("short-date-short-time"),timeZone:void 0,timeZoneName:"short"}}}function x(e,t,n){if(!e||null==t)return null;switch(e.type){case"date":return(0,r.Yq)(t,n);case"date-only":return(0,r.iS)(t,n);case"time-only":return(0,r.F8)(t,n);case"timestamp-offset":return(0,r.Ey)(t,n);default:return null}}function E(e){const{dateComponent:t,defaultTimeZone:n,timeComponent:i,timeZoneComponent:l,oldValue:r}=e;if(!t?.value)return null;const{year:a,month:d,day:p}=s.c9.fromFormat(t.value,o.mo),{hour:c,minute:f,second:m,millisecond:y}=I(i,u.n$)??s.c9.now(),h=b(r,n),g=l?.value?parseInt(l.value,10):null!=h.timeZoneOffset?parseInt(h.timeZoneOffset,10):(new Date).getTimezoneOffset(),v=s.mQ.instance(g),_=s.c9.fromObject({year:a,month:d,day:p,hour:c,minute:f,second:m,millisecond:y},{zone:v});return _.isValid?_.toISO({includeOffset:!0}):null}function Z(e){const{dateComponent:t,timeComponent:n,timeZone:i,max:l,min:r,oldValue:o}=e,a=I(t,i);let u=!!e.applyRange;if(!a)return null;let d=null;if(null!=n?.value){const e=I(n,i),t=Date.now(),r=null!=l&&l<t?l:t,o=s.c9.fromMillis(r,g(i)),u=a||o,{year:p,month:c,day:f}=u,{hour:m,minute:y,second:h,millisecond:v}=e||o;d=u.set({year:p,month:c,day:f,hour:m,minute:y,second:h,millisecond:v})}else{const e=v(M({value:o??Date.now(),max:l,min:r}),i),{year:t,month:n,day:s}=a,{hour:p,minute:c,second:f,millisecond:m}=e;u=!0,d=a.set({year:t,month:n,day:s,hour:p,minute:c,second:f,millisecond:m})}if(!d.isValid)return null;const p=d.toMillis();return u?M({value:p,max:l,min:r}):p}function I(e,t){if(null==e?.value||Array.isArray(e.value))return null;let n=null;return n=h(e)?s.c9.fromFormat(e.value,o.mo,g(t)):(0,o.UE)(e.value),n?.isValid?n:null}function T(e){const{max:t,min:n,value:i}=e;return!isNaN(i)&&!(null!=t&&i>t)&&!(null!=n&&i<n)}function M(e){const{max:t,min:n,value:i}=e;return null!=t&&null!=n?(0,l.qE)(i,n,t):null!=t&&i>t?t:null!=n&&i<n?n:i}function w(e){if(!e)return"";const t=e.split(".").at(0);if(!t||t.length<1)throw new i.default("invalid time-only field",`Cannot parse valid time-only field value from ${e}`);const n=t.split(":"),l=new Array(3);for(let i=0;i<3;i++){const e=n.at(i)??"";l[i]=e.padStart(2,"0")}return l.join(":")}function V(e,t){switch(t){case"date":return e.getTime();case"date-only":return e.toISODate();case"time-only":return w(e.toISOTime(!0,!1));case"timestamp-offset":return e.toISOString(!1);default:return null}}function C(e){return!!e&&"object"==typeof e&&"getTime"in e&&"toISOString"in e&&"timeZone"in e}function O(e){const{type:t,range:n,value:i}=e;if(null==i||!n||i===n.min||i===n.max)return!0;if("date"===t)return T({value:i,min:n.min,max:n.max});const{rawMax:l,rawMin:r}=n;let a=null,u=null,s=null;switch(t){case"date-only":a=(0,o.Xi)(l),u=(0,o.Xi)(r),s=(0,o.Xi)(i);break;case"time-only":a=(0,o.UE)(l),u=(0,o.UE)(r),s=(0,o.UE)(i);break;case"timestamp-offset":a=(0,o.gz)(l),u=(0,o.gz)(r),s=(0,o.gz)(i)}return!s||T({value:s.valueOf(),min:u?.valueOf(),max:a?.valueOf()})}},23301:(e,t,n)=>{n.d(t,{$$:()=>F,D_:()=>c,Gd:()=>p,Kx:()=>i,PA:()=>g,Po:()=>f,Qv:()=>v,gK:()=>l,hQ:()=>_,jl:()=>y,of:()=>d,qn:()=>b,zU:()=>m});var i,l,r,o=n(71764),a=n(15142),u=n(53430),s=n(20639);(r=i||(i={})).Text="text",r.Number="number",r.Date="date",r.Unsupported="unsupported",function(e){e.CANNOT_BE_EMPTY="input-validation-error::cannot-be-empty",e.TOO_SHORT="length-validation-error::too-short",e.TOO_LONG="length-validation-error::too-long"}(l||(l={}));const d=(e,t)=>{if(!e)return!0;const{operations:n}=e;switch(t){case"INSERT":return n.supportsAdd;case"UPDATE":case"DELETE":return n.supportsUpdate;default:return!0}};function p(e,t){const{dataType:n,domain:i,field:r,maxLength:o,minLength:d,range:p,required:c}=t;if(null==e)return c?l.CANNOT_BE_EMPTY:null;if("text"===n&&"string"==typeof e){if(d>-1&&e.length<d)return l.TOO_SHORT;if(o>-1&&e.length>o)return l.TOO_LONG}return"date"!==n||(0,s.yk)({type:r.type,range:p,value:e})?i?(0,a.wb)(r,e,i):(0,u.validateFieldValue)(r,e)??(0,a.wb)(r,e):u.NumericRangeValidationError.OUT_OF_RANGE}function c(e,t){return!(!f(e)||!f(t))||e===t}function f(e){return null==e||""===e}function m(e){let{dataType:t,field:n,input:l}=e;if(t===i.Date)return-1;const r=h(n.length);if(!l||!(0,o.AI)(l))return r;const a=h(l.maxLength);return-1===a?r:-1===r?a:Math.min(r,a)}function y(e){let{dataType:t,field:n,input:l}=e;if(t===i.Date)return-1;if(!l||!(0,o.AI)(l))return-1;const r=h(l.minLength);if(r<0)return-1;const a=h(n.length);return a>-1&&a<r?-1:r}function h(e){return"number"==typeof e&&e>-1?e:-1}const g={type:"number"},v={type:"number",intlOptions:{notation:"scientific"}};function b(e){return e>=1e7||e<=-1e7}function _(e,t){return null!=e.max&&null!=e.min?t.outsideRange:null!=e.max?t.outsideRangeMax:t.outsideRangeMin}const F=e=>e&&!Number.isNaN(e.valueOf())},26547:(e,t,n)=>{function i(e){const{attributes:t,sourceLayer:n}=e??{},i=n&&"displayField"in n?n.displayField:null,l=i?t?.[i]:null,r=null!=l?JSON.stringify(l):null,o=e?.getObjectId()?.toString();return r||o||""}n.d(t,{R:()=>i})},48397:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),l=n(46053),r=(n(81806),n(76460),n(47249),n(85842)),o=n(31933),a=n(84668),u=n(23301);let s=class extends a.A{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){return!!this.layerAllowsEdits&&(this.evaluatedEditableExpression??!0)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const t=(0,o.BR)(e),n=t?.operations.supportsEditing,i=(0,u.of)(t,this.arcadeEditType);return!(!n||!i)}};(0,i._)([(0,l.MZ)()],s.prototype,"arcadeEditType",void 0),(0,i._)([(0,l.MZ)()],s.prototype,"editable",null),(0,i._)([(0,l.MZ)()],s.prototype,"editableExpressionExecutor",void 0),(0,i._)([(0,l.MZ)()],s.prototype,"evaluatedEditableExpression",null),(0,i._)([(0,l.MZ)()],s.prototype,"layerAllowsEdits",null),s=(0,i._)([(0,r.$)("esri.widgets.FeatureForm.EditableInput")],s);const d=s},65529:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var i=n(35143),l=n(50076),r=n(68134),o=n(46053),a=(n(81806),n(76460),n(47249),n(85842)),u=n(15142),s=n(53430),d=n(42633),p=n(85632),c=n(9912),f=n(48397),m=n(3320),y=n(20639),h=n(23301);let g=class extends f.A{constructor(e){super(e),this._storedValue=null,this.error=null,this.preservesValueWhenHidden=!0,this.field=null,this.group=null,this.requiredExpressionExecutor=null,this.type="field",this._fieldInputWasVisibleDuringLifetime=!1,this.valueExpressionExecutor=null}initialize(){this.addHandles((0,r.watch)((()=>this.feature),(()=>this._fieldInputWasVisibleDuringLifetime=!1),r.sync))}get _dateFormRange(){const{element:e,field:t}=this;if("date"!==this.dataType)return{};const n=e?.domain?(0,u.A5)(t,e.domain):null;if(!e?.input)return n??{};const i=e.input,{type:l}=i;let r={};if("date-picker"!==l&&"time-picker"!==l&&"datetimeoffset-picker"!==l||(r=(0,u.nm)(t,i.max,i.min)),"datetime-picker"===l){const{max:e,min:t}=i;r={max:null!=e&&(0,h.$$)(e)?e.getTime():null,min:null!=t&&(0,h.$$)(t)?t.getTime():null}}const{max:o,min:a}=r;if(n){const{max:e,min:t}=n,i=(0,p.Et)(e)&&(null==o||null!=o&&e<o),l=(0,p.Et)(t)&&(null==a||null!=a&&t>a);return{max:i?e:o??null,min:l?t:a??null,rawMax:i?n.rawMax:r?.rawMax??null,rawMin:l?n.rawMin:r?.rawMin??null}}return{min:a,max:o,rawMax:r?.rawMax??null,rawMin:r?.rawMin??null}}get _dateRange(){const{_dateFormRange:e,field:t}=this;if("date"!==this.dataType)return{};const n=(0,u.A5)(t);if(!n)return e;const{max:i,min:l,rawMax:r,rawMin:o}=e;if("date"===t.type){const{max:e,min:t}=n;return{max:(0,p.Et)(i)&&(null===e||null!=e&&i<e)?i:e??null,min:(0,p.Et)(l)&&(null===t||null!=t&&l>t)?l:t??null}}if("date-only"===t.type||"time-only"===t.type||"timestamp-offset"===t.type){const{max:e,min:t,rawMax:a,rawMin:u}=n,s=(0,p.Et)(i)&&r&&(null==e||i<e),d=(0,p.Et)(l)&&o&&(null==t||l>t);return{max:s?i:e,min:d?l:t,rawMax:s?r:a,rawMin:d?o:u}}return{max:null,min:null}}get _configAllowsEdits(){const{element:e,layer:t,name:n}=this;if(null!=e)return e.editableExpression?!!this.evaluatedEditableExpression:!1!==e.editable;if(t?.userHasUpdateItemPrivileges)return!0;const i=t&&"popupTemplate"in t?t?.popupTemplate?.fieldInfos?.find((e=>{let{fieldName:t}=e;return t===n})):null;return i?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const{field:e,layer:t}=this;return!!e?.visible&&(0,s.isFieldVisibleByDefault)(e,t)}get _isEditTrackingField(){return(0,s.getLowerCaseEditTrackingFields)(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&null!=this.valueExpressionExecutor&&this.valueExpressionExecutor.initialExecutionComplete}get isSubtypeField(){const{layer:e}=this;if(e&&"subtypeField"in e){const{subtypeField:t,fieldsIndex:n}=e;return(n.get(t)?.name??t)===this.name}return!1}get valueIsOutOfDomain(){const{domain:e,value:t,field:n}=this;return!(!e||null==t)&&null!==(0,u.wb)(n,t,e)}get dataType(){const{field:e}=this;return(0,s.isNumericField)(e)?h.Kx.Number:(0,s.isStringField)(e)?h.Kx.Text:(0,d.fs)(e)||(0,s.isTimeOnlyField)(e)?h.Kx.Date:h.Kx.Unsupported}get dateDataType(){if(this.dataType===h.Kx.Date)return"date"!==this.field.type?"string":"number"}get domain(){const{layer:e,feature:t,name:n,element:i}=this,l=i?.domain;return null!=l&&this._isDomainCompatible(l)?l:e.getFieldDomain(n,{feature:t})}get editable(){return!!this._layerAndFieldAllowEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return null!=e?e.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!==h.Kx.Date||"time-only"===this.field.type)}get includeTime(){const{element:e,field:t}=this;if(this.dataType!==h.Kx.Date)return!1;if("time-only"===t.type)return!0;if("date-only"===t.type)return!1;const n="datetime-picker"===e?.input?.type?e.input.includeTime:void 0;return void 0===n||n}get includeTimeOffset(){if("timestamp-offset"!==this.field.type)return!1;const e=this.element?.input;return!e||"datetimeoffset-picker"===e.type&&e.includeTimeOffset}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){const{element:e}=this,t=(0,m.HG)(e,"switch")?e.input:null;return!t||(0,m.Kn)(this.value,t)}get isRelationshipKeyField(){const{field:e,layer:t}=this;return(0,c.isRelatableFeatureSupportedLayer)(t)&&!!t.relationships?.some((t=>t.keyField===e.name))}get label(){const{field:e}=this;return this.getFormattedLabel(this.element?.label)??e.alias??e.name}get maxLength(){return(0,h.zU)({dataType:this.dataType,field:this.field,input:this.element?.input})}get minLength(){return(0,h.jl)({dataType:this.dataType,field:this.field,input:this.element?.input})}get name(){return this.field?.name}get range(){const{domain:e,element:t,field:n}=this;if("date"===this.dataType)return this._dateRange;const i=(0,u.A5)(n,e)||(0,s.getFieldRange)(n,e),l=i?.max===Number.MAX_VALUE?null:i?.max??null,r=i?.min===-Number.MAX_VALUE?null:i?.min??null;if(!t?.domain||"range"!==t.domain.type)return{max:l,min:r};const{max:o,min:a}=(0,u.A5)(n)||{};return{max:null!=o&&(null===l||null!=l&&o<l)?o:l,min:null!=a&&(null===r||null!=r&&a>r)?a:r}}get required(){const{editable:e,evaluatedRequiredExpression:t,field:n,visible:i,isSubtypeField:l}=this;return!!e&&(!1===n?.nullable||(!!l||!(!i||!1===this.group?.visible||null==t)&&t))}set required(e){this._overrideIfSome("required",e)}get showNoValueOptionEnabled(){const{element:e}=this;return!this.required&&(!(0,m.XI)(e)||e.input.showNoValueOption)}get showNoValueLabel(){const{element:e}=this;return(0,m.XI)(e)?e.input.noValueOptionLabel:null}get submittable(){const{field:e,required:t,valid:n,value:i}=this;return(!t||null!=i)&&(!!n||this.initialFeature.getAttribute(e.name)===i)}get timeResolution(){const e=this.element?.input;if(e&&("datetimeoffset-picker"===e.type||"time-picker"===e.type))return e.timeResolution??"minutes"}get timeStep(){return null!=this.timeResolution?y.fl.get(this.timeResolution):void 0}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:t,visibilityExpressionExecutor:n,preservesValueWhenHidden:i}=this;return null!=t&&t.updating||null!=e&&e.updating||!1===i&&null!=n&&n.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),null===e}get value(){if(this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&!1!==this.group?.visible,!1===this.preservesValueWhenHidden&&this._fieldInputWasVisibleDuringLifetime&&(!1===this.visibilityExpressionExecutor?.lastEvaluatedValue||!1===this.group?.visibilityExpressionExecutor?.lastEvaluatedValue))return null!==this._storedValue&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const e=this.evaluatedValueExpression;return this.dataType===h.Kx.Date?this._arcadeOutputToDateFieldValue(e):null!=e&&"object"==typeof e?`${e}`:e}return this._storedValue}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e),this.notifyChange("value"),this.notifyChange("valid")}get visible(){return!this._isEditTrackingField&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element&&!1!==this.field?.visible||this._isVisibleByDefault)}_arcadeOutputToDateFieldValue(e){const t=this.field.type;try{if("object"==typeof e){if(null===e)return null;if((0,y.rX)(e))return(0,y.fD)(e,t);if("getTime"in e&&"function"==typeof e.getTime&&"date"===t)return parseInt(e.getTime(),10);if("date-only"===t||"time-only"===t||"timestamp-offset"===t)return e.toString()}else{if("string"==typeof e)return"date"===t?parseInt(e,10):e;if("number"==typeof e&&"date"===t)return e}throw new l.default("feature-form:invalid-date-value")}catch{return"date"===t?NaN:""}}_isDomainCompatible(e){const{field:t}=this;if("coded-value"===e?.type){const n=typeof e.codedValues[0].code;if("string"===n&&(0,s.isStringField)(t)||"number"===n&&(0,s.isNumericField)(t))return!0}return!!("range"===e?.type&&(0,s.isNumericField)(t)||(0,d.fs)(t)||(0,s.isTimeOnlyField)(t))}_validate(){const{dataType:e,domain:t,field:n,minLength:i,range:l,required:r,value:o,maxLength:a}=this;return(0,h.Gd)(o,{dataType:e,domain:t,field:n,maxLength:a,minLength:i,range:l,required:r})}};(0,i._)([(0,o.MZ)()],g.prototype,"_dateFormRange",null),(0,i._)([(0,o.MZ)()],g.prototype,"_dateRange",null),(0,i._)([(0,o.MZ)()],g.prototype,"_storedValue",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"_configAllowsEdits",null),(0,i._)([(0,o.MZ)()],g.prototype,"_layerAndFieldAllowEdits",null),(0,i._)([(0,o.MZ)()],g.prototype,"_isVisibleByDefault",null),(0,i._)([(0,o.MZ)()],g.prototype,"_isEditTrackingField",null),(0,i._)([(0,o.MZ)()],g.prototype,"_shouldUseValueExpression",null),(0,i._)([(0,o.MZ)()],g.prototype,"isSubtypeField",null),(0,i._)([(0,o.MZ)()],g.prototype,"valueIsOutOfDomain",null),(0,i._)([(0,o.MZ)()],g.prototype,"dataType",null),(0,i._)([(0,o.MZ)()],g.prototype,"dateDataType",null),(0,i._)([(0,o.MZ)()],g.prototype,"domain",null),(0,i._)([(0,o.MZ)()],g.prototype,"editable",null),(0,i._)([(0,o.MZ)({readOnly:!0})],g.prototype,"error",void 0),(0,i._)([(0,o.MZ)({constructOnly:!0})],g.prototype,"preservesValueWhenHidden",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"evaluatedRequiredExpression",null),(0,i._)([(0,o.MZ)()],g.prototype,"evaluatedValueExpression",null),(0,i._)([(0,o.MZ)()],g.prototype,"field",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"group",void 0),(0,i._)([(0,o.MZ)({readOnly:!0})],g.prototype,"hint",null),(0,i._)([(0,o.MZ)()],g.prototype,"includeDate",null),(0,i._)([(0,o.MZ)()],g.prototype,"includeTime",null),(0,i._)([(0,o.MZ)()],g.prototype,"includeTimeOffset",null),(0,i._)([(0,o.MZ)()],g.prototype,"initialFeature",null),(0,i._)([(0,o.MZ)({readOnly:!0})],g.prototype,"inputType",null),(0,i._)([(0,o.MZ)()],g.prototype,"hasInvalidSwitchValue",null),(0,i._)([(0,o.MZ)()],g.prototype,"isRelationshipKeyField",null),(0,i._)([(0,o.MZ)()],g.prototype,"label",null),(0,i._)([(0,o.MZ)()],g.prototype,"maxLength",null),(0,i._)([(0,o.MZ)()],g.prototype,"minLength",null),(0,i._)([(0,o.MZ)({readOnly:!0})],g.prototype,"name",null),(0,i._)([(0,o.MZ)()],g.prototype,"range",null),(0,i._)([(0,o.MZ)()],g.prototype,"required",null),(0,i._)([(0,o.MZ)()],g.prototype,"requiredExpressionExecutor",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"showNoValueOptionEnabled",null),(0,i._)([(0,o.MZ)()],g.prototype,"submittable",null),(0,i._)([(0,o.MZ)()],g.prototype,"timeResolution",null),(0,i._)([(0,o.MZ)()],g.prototype,"timeStep",null),(0,i._)([(0,o.MZ)({readOnly:!0})],g.prototype,"type",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"updating",null),(0,i._)([(0,o.MZ)()],g.prototype,"valid",null),(0,i._)([(0,o.MZ)({value:null})],g.prototype,"value",null),(0,i._)([(0,o.MZ)()],g.prototype,"valueExpressionExecutor",void 0),(0,i._)([(0,o.MZ)()],g.prototype,"visible",null),g=(0,i._)([(0,a.$)("esri.widgets.FeatureForm.FieldInput")],g);const v=g},66635:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var i=n(35143),l=n(76460),r=n(46053),o=(n(81806),n(47249),n(85842)),a=n(65256),u=n(50265),s=n(70445),d=n(91447),p=n(44135),c=n(53430),f=n(42633),m=n(36693),y=n(67478),h=n(65529),g=n(70590),v=n(95843);const b="Enter",_="Escape";let F=class extends g.default{constructor(e){super(e),this.editInfo=null,this.cellValueValidatorFunction=e=>{let{oldValue:t,value:n}=e;return t!==n},this.editable=!0,this.headerRenderFunction=e=>{const{root:t}=e,n=this.createHeaderContent();this.tableEditingEnabled&&!this.effectiveEditable&&n.prepend(this._lockIconNode),this.removeCellContent(t),t.appendChild(n)},this.inputRenderFunction=e=>{let{root:t,column:n,rowData:i}=e;if(this.editInfo||!this.effectiveEditable||!i)return;const l=this.getCellValue(i),r=this.createInputElement({value:l});this._set("editInfo",{column:n,inputs:[r],root:t,rowData:i,oldValue:l});const o=document.createElement("div");o.appendChild(r),this.removeCellContent(t),t.appendChild(o),r.focus(),r instanceof HTMLInputElement&&r.select()},this.loadingMessage="",this.inputType="text",this.maxLength=null,this.onShowPromptCallback=()=>{},this.parseInputValueFunction=e=>{let{inputs:t}=e;return t?.length||1!==t.length||Array.isArray(t[0].value)?null:t[0].value},this.renderFunction=e=>{const{root:t,rowData:n}=e,{editInfo:i}=this;if(i)return;const l=this.getCellValue(n),r=this.cellValueFormatFunction({root:t,rowData:n,value:l});let o=null;t.onclick=()=>t.focus(),t.ondblclick=()=>this.inputRenderFunction(e),t.ontouchend=()=>this.inputRenderFunction(e);const a=this.grid?.getSlotElementByName(t.slot),u=a?.parentElement;u&&!u.onkeydown&&(u.onkeydown=t=>{t.key!==b||this.editInfo||this.inputRenderFunction(e),t.key===_&&this.editInfo&&this.cancel()}),null!=l&&null!=r?t.title=r.toString():t.title&&t.removeAttribute("title"),o=r instanceof HTMLElement?r:(0,v.Q)(this.messagesURIUtils,r),this.removeCellContent(t),o instanceof HTMLElement?t.appendChild(o):null!=o&&(t.innerHTML=o.toString())},this.required=!1,this.tableEditingEnabled=!1}get _lockIconNode(){return this.createCalciteIcon({icon:"lock",textLabel:this.messages?.editingPreventedColumn})}get effectiveEditable(){return this.tableEditingEnabled&&this.editable}get effectiveRequired(){return this.required}get editing(){return!!this.editInfo}get shouldShowPrompt(){return!1}cancel(){const{editInfo:e}=this;if(!e)return;const{column:t,root:n,rowData:i}=e;this.onEditComplete(),this.renderFunction({column:t,root:n,rowData:i})}createCalciteOption(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=document.createElement("calcite-option");return i.label=e,i.value=`${t}`,i.selected=n,i}createCalciteSelect(e,t){const{effectiveRequired:n,messages:i}=this;let l=!1;const r=t.map((t=>{let{name:n,value:i}=t;const r=i===e;return r&&(l=!0),this.createCalciteOption(n,i,r)}));if(null!=e&&""!==e&&!l){const t=e.toString(),n=this.createCalciteOption(t,t);r.unshift(n)}n||r.unshift(this.createCalciteOption(`<${i?.noValue}>`,""));const o=document.createElement("calcite-select");return r.forEach((e=>o.appendChild(e))),o}createInputElement(e){let{value:t}=e;const{effectiveRequired:n,maxLength:i}=this,l=document.createElement("calcite-input");return null!=i&&(l.maxLength=i),l.required=n,l.value=t,l.addEventListener("calciteInputChange",(()=>this.onInputBlur(l))),l.onkeydown=e=>{e.key===_&&this.onInputBlur(l,!0)},l.onblur=()=>this.onInputBlur(l),l}createDateComponent(){const e=document.createElement("calcite-input-date-picker");return e.focusTrapDisabled=!0,e.overlayPositioning="fixed",e}createTimeComponent(){const e=document.createElement("calcite-input-time-picker");return e.overlayPositioning="fixed",e.placement="auto-start",e.step=1,e}createTimeZoneComponent(){const e=document.createElement("calcite-input-time-zone");return e.maxItems=4,e.overlayPositioning="fixed",e}onEditComplete(){this._set("editInfo",null),this.grid?.generateCellPartNames()}onInputBlur(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.onblur=null,t?this.cancel():this.submit()}async submit(){const{editInfo:e}=this;if(!e)return void this.cancel();const{inputs:t,rowData:n,oldValue:i}=e,l=this.parseInputValueFunction({inputs:t});if(!this.cellValueValidatorFunction({value:l,oldValue:i}))return void this.cancel();const{root:r}=e,o=n.item.objectId,{fieldName:a}=this;r.textContent=this.loadingMessage,this.shouldShowPrompt?this.onShowPromptCallback({column:this,objectId:o,oldValue:i,value:l}):await this.updateItems({objectId:o,updates:[{fieldName:a,value:l}]})}async updateItems(e){const{store:t}=this;if(t)try{await t.updateItem(e),this.onEditComplete()}catch{this.cancel()}else this.cancel()}};(0,i._)([(0,r.MZ)()],F.prototype,"_lockIconNode",null),(0,i._)([(0,r.MZ)({readOnly:!0})],F.prototype,"editInfo",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"cellValueValidatorFunction",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"editable",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"effectiveEditable",null),(0,i._)([(0,r.MZ)()],F.prototype,"effectiveRequired",null),(0,i._)([(0,r.MZ)()],F.prototype,"editing",null),(0,i._)([(0,r.MZ)()],F.prototype,"headerRenderFunction",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"inputRenderFunction",void 0),(0,i._)([(0,r.MZ)({constructOnly:!0})],F.prototype,"loadingMessage",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"inputType",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"maxLength",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"onShowPromptCallback",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"parseInputValueFunction",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"renderFunction",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"required",void 0),(0,i._)([(0,r.MZ)()],F.prototype,"shouldShowPrompt",null),(0,i._)([(0,r.MZ)()],F.prototype,"tableEditingEnabled",void 0),F=(0,i._)([(0,o.$)("esri.widgets.FeatureTable.Grid.EditorColumn")],F);const x=F;var E=n(78984),Z=n(20639),I=n(76099);const T="Escape",M="esri-column",w={input:`${M}__cell-input`,inputContainer:`${M}__cell__input-container`},V=(0,a.J2)("short-date-short-time"),C=(0,a.J2)("short-date"),O={useGrouping:!0,maximumFractionDigits:20};let N=class extends x{constructor(e){super(e),this._activeFieldInput=null,this.cellValueFormatFunction=e=>{let{root:t,rowData:n,value:i}=e;const{formatFunction:l}=this;if(l&&n){const{index:e,item:{attachments:r,feature:o,relatedRecords:a}}=n;return l({attachments:r,column:this,feature:o,field:this.field,index:e,relatedRecords:a,value:I.W5.sanitize(i),virtualIndex:this.getVirtualRowIndex(t)})}if(null===i)return"&nbsp;";const{field:r}=this,o=this._getDomainForFeature(n?.item?.feature);if(o){const e=this._getComputedDomain(i,o);if("date"===r.type&&"range"===o.type)return this._formatDateValueForDisplay(r,e);if(this._isNumericField&&"range"===o.type){const e=this.template?.format,t=e?(0,u.yx)(e):O;return(0,u.ZV)(parseFloat(i),t)}return Z.sH.has(r.type)?"range"===o.type?I.W5.sanitize((0,Z.ZP)(r,e)):I.W5.sanitize(e):e}if("date"===r.type||Z.sH.has(r.type))return this._formatDateValueForDisplay(r,i);if(this._isNumericField){const e=this.template?.format,t=e?(0,u.yx)(e):O;return(0,u.ZV)(parseFloat(i),t)}return I.W5.sanitize(i)},this.cellValueValidatorFunction=e=>{let{oldValue:t,value:n}=e;const{_effectiveRange:i,field:r}=this,{max:o,min:a}=i;if(this.effectiveRequired&&(null==n||""===n))return!1;if(this._isNumericField&&((0,c.validateFieldValue)(r,n)||!(0,Z.eX)({max:o,min:a,value:n})))return l.A.getLogger(this).warn("value-exceeds-valid-range","Field value exceeds valid range. Attempted edit was rejected."),!1;if(this._isAnyDateOrTimeField){const e=r.type;if(!(0,Z.yk)({type:e,range:i,value:n}))return!1}return t!==n},this.field=null,this.formatFunction=null,this.inputRenderFunction=async e=>{let{root:t,column:n,rowData:i}=e;if(this.editInfo||!this.effectiveEditable)return;const r=this.getCellValue(i),{field:o}=this;if("big-integer"===o.type&&(0,c.validateFieldValue)(o,r))return void l.A.getLogger(this).warn("value-exceeds-valid-range","Field value is beyond supported limit. Editing is disabled for this field value.");const a=i?.item.feature;if(!a)return;this._activeFieldInput=this._setUpFieldInput(a,r);const u=document.createElement("div");u.classList.add(w.inputContainer);const s=[],d="coded-value"===this._effectiveDomain?.type;if(this._isAnyDateOrTimeField&&!d){const e=document.createElement("div"),t=this._setUpDateComponents(r),n=this._setUpDateActionBar();t.forEach((t=>e.appendChild(t))),u.appendChild(e),u.appendChild(n),s.push(...t)}else{const e=this.createInputElement({value:r});u.appendChild(e),s.push(e)}this._set("editInfo",{column:n,inputs:s,root:t,rowData:i,oldValue:r}),this.removeCellContent(t),t.appendChild(u),this._syncRowEditingState(t,!0),this.grid?.generateCellPartNames();const p=s[0];await(0,I.Z6)(p),"selectText"in p&&await p.selectText()},this.layer=null,this.parseInputValueFunction=e=>{let{inputs:t}=e;const{editInfo:n,field:i,includeTime:l}=this;if(!n||!t.length)return null;const r=t[0];if(this._isAnyDateOrTimeField){if("coded-value"===this._effectiveDomain?.type){if(null==r.value)return null;const e=String(r.value);return(0,c.isDateField)(i)?parseFloat(e):e}const{timeZone:e}=this.effectiveTimeZoneOptions,o=n.oldValue??void 0;switch(i.type){case"date-only":{const e=r.value;return""!==e?e:null}case"time-only":{const e=(0,Z.iP)(r.value);return""!==e?e:null}case"timestamp-offset":{const n=l?t[1]:void 0,i=t.at(-1);return(0,Z.Ng)({oldValue:o,dateComponent:r,timeComponent:n,timeZoneComponent:i,defaultTimeZone:e})}case"date":{const{max:n,min:i}=this._effectiveRange;return(0,Z.oh)({oldValue:o,dateComponent:r,timeComponent:t[1],timeZone:e,max:n,min:i})}}return null}const o=r.value,{effectiveRequired:a}=this;return a||null!=o&&""!==o?this._isNumericField?parseFloat(o):this._isStringField?o.trim():o:null},this.sortable=!0,this.store=null,this.template=null,this.view=null}get _effectiveDomain(){const e=this._activeFieldInput?.feature;return e?this._getDomainForFeature(e):null}get _effectiveRange(){return this._activeFieldInput?.range??{max:null,min:null}}get _isAnyDateOrTimeField(){const{field:e}=this;return(0,f.fs)(e)||(0,c.isTimeOnlyField)(e)}get _isIntegerField(){return(0,c.isIntegerField)(this.field)}get _isNumericField(){return(0,c.isNumericField)(this.field)}get _isStringField(){return(0,c.isStringField)(this.field)}get _isSubtypeField(){const{layer:e}=this;if(e?.subtypeField){const{subtypeField:t,fieldsIndex:n}=e;return(n.get(t)?.name??t)===this.fieldName}return!1}get alias(){return this.field?.alias}get defaultValue(){return this.field?.defaultValue}get effectiveDescription(){const{description:e,field:t}=this,n=t.description,i=(0,E.$m)(e)?(0,E.$m)(n)?null:n:e;return null==i?null:I.W5.sanitize(i)}get effectiveEditable(){const{editable:e,field:t,layer:n,tableEditingEnabled:i}=this;if(!t||!n)return!1;const l=(0,s.S)(n),r=n.effectiveCapabilities??n.capabilities,o=r?.operations?.supportsUpdate;return!!(t.editable&&l&&o&&"oid"!==t.type&&i)&&e}get effectiveLabel(){return I.W5.sanitize(this.label||this.alias||this.fieldName)}get effectiveRequired(){return!this.nullable||this._isSubtypeField||this._activeFieldInput?.required||this.required}get effectiveTimeZoneOptions(){const{layer:e,field:t}=this;if(!e||"date"!==t?.type&&"timestamp-offset"!==t?.type)return{timeZone:void 0,timeZoneName:void 0};const{tableTimeZone:n,timeZone:i,view:l}=this;return(0,y.hv)(e.preferredTimeZone||null,!!e.datesInUnknownTimezone,i??n??l?.timeZone??m.qU,(0,a.J2)("short-time"),t.type)}get includeTime(){const{field:e,template:t}=this;return"time-only"===e.type||"date-only"!==e.type&&(!t?.input||"includeTime"in t.input&&!1!==t.input.includeTime)}get loadingMessage(){return this.messages?.loading||"..."}get maxLength(){const{field:e,template:t}=this,n=e?.length??-1,i=t?.input&&"maxLength"in t.input?t.input.maxLength:null;return null!=i&&!isNaN(i)&&i>=-1&&(-1===n||i<=n)?i:n}get minLength(){const{template:e,maxLength:t}=this,n=e?.input&&"minLength"in e.input?e.input.minLength:null;return t&&n<=t?n:null}get name(){return this.field?.name}get nullable(){return!1!==this.field.nullable}get shouldShowPrompt(){return this._isSubtypeField}createInputElement(e){let{value:t}=e;const{_effectiveDomain:n,maxLength:i,minLength:l,effectiveRequired:r}=this;let o;if("coded-value"===n?.type)o=this.createCalciteSelect(t,n.codedValues.map((e=>{let{code:t,name:n}=e;return{value:t,name:n}}))),o.addEventListener("calciteSelectChange",(()=>this.onInputBlur(o)));else if(this._isNumericField){const{_effectiveRange:{max:e,min:n}}=this;o=document.createElement("calcite-input"),o.type="number",this._isIntegerField&&(o.step=1),null!=e&&(o.max=e),null!=n&&(o.min=n),o.status=(0,Z.eX)({max:e,min:n,value:t})?"idle":"invalid"}else o=document.createElement("calcite-input"),o.addEventListener("calciteInputChange",(()=>this.onInputBlur(o))),i>-1&&(o.maxLength=i),l>0&&(o.minLength=l);return o.classList.add(w.input),o.required=r,o.value=null!=t?t.toString():"",o.onkeydown=e=>{e.key===T&&this.onInputBlur(o,!0)},o.onblur=()=>this.onInputBlur(o),o}onEditComplete(){const e=this.editInfo?.root;e&&this._syncRowEditingState(e,!1),this._activeFieldInput=null,super.onEditComplete()}_clearActiveEditValues(){this.editInfo?.inputs?.forEach((e=>e.value=""))}_setUpDateActionBar(){const{messagesCommon:e}=this,t=e?.cancel??"",n=e?.clear??"",i=e?.save??"",l=document.createElement("calcite-action-bar");return l.expandDisabled=!0,l.layout="horizontal",l.appendChild(this.createCalciteAction({text:i,icon:"save",onclick:()=>this.submit()})),this.effectiveRequired||l.appendChild(this.createCalciteAction({text:n,icon:"trash",onclick:()=>{this._clearActiveEditValues(),this.submit()}})),l.appendChild(this.createCalciteAction({text:t,icon:"x",onclick:()=>this.cancel()})),l}_formatDateValueForDisplay(e,t){const{timeZone:n,timeZoneName:i}=this.effectiveTimeZoneOptions;return null!=t?(0,Z.ZP)(e,t,{...this._getDateFormatOptions(),timeZone:n,timeZoneName:i}):null}_setUpDateComponents(e){const{_effectiveRange:{max:t,min:n,rawMax:i,rawMin:l},field:r,effectiveRequired:o}=this,a=this._getDateFieldValuesForComponents(r,e),u=[];if((0,f.fs)(r)){const e=this.createDateComponent(),s=(0,c.isDateOnlyField)(r)||(0,c.isTimestampOffsetField)(r)?i:t,d=(0,c.isDateOnlyField)(r)||(0,c.isTimestampOffsetField)(r)?l:n,p=this._getDateFieldValuesForComponents(r,s??null),f=this._getDateFieldValuesForComponents(r,d??null);e.value=a.date??"",e.max=p.date??"",e.min=f.date??"",e.required=o,e.addEventListener("calciteInputDatePickerOpen",(()=>this._onDateComponentOpen(e))),u.push(e)}if(this.includeTime){const e=this.createTimeComponent();e.value=a.time??"",e.required=o,e.addEventListener("calciteInputTimePickerOpen",(()=>this._onDateComponentOpen(e))),u.push(e)}if("timestamp-offset"===r.type){const e=this.createTimeZoneComponent();e.value=a.timeZoneOffset??"0",e.addEventListener("calciteInputTimeZoneOpen",(()=>this._onDateComponentOpen(e))),u.push(e)}return u}_onDateComponentOpen(e){this.editInfo?.inputs.forEach((t=>{t!==e&&"open"in t&&(t.open=!1)}))}_syncRowEditingState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.grid?.getRowContainingNode(e);n&&(t?n.setAttribute("editing","true"):n.removeAttribute("editing"))}_getDateFieldValuesForComponents(e,t){switch(e.type){case"date":return(0,Z.Q0)(t,this.effectiveTimeZoneOptions.timeZone);case"date-only":return{date:t};case"time-only":return{time:t};case"timestamp-offset":return(0,Z.T8)(t);default:return{}}}_setUpFieldInput(e,t){const{field:n,layer:i,effectiveTimeZoneOptions:{timeZone:l}}=this,r=new h.default({feature:e,field:n,initialFeature:e.clone(),layer:i,timeZone:l});return r.set("value",t),r}_isDomainCompatible(e){if(!e)return!1;const{_isNumericField:t,_isStringField:n}=this,{type:i}=e;if("coded-value"===i){const i=typeof e.codedValues[0].code;if("string"===i&&n||"number"===i&&t)return!0}return!("range"!==i||!t)}_getDomainForFeature(e){const{fieldName:t,layer:n,template:i}=this;if(!e||!n?.getFieldDomain)return null;if("wfs"===n.type||"geojson"===n.type||"csv"===n.type||"knowledge-graph-sublayer"===n.type)return null;if(i?.domain&&this._isDomainCompatible(i.domain))return i.domain;if("feature"!==n.type&&"subtype-group"!==n.type&&null==n.getField(t)?.domain){const e=(0,d.hx)(n,t);if(e)return e}return n.getFieldDomain(t,{feature:e})}_getComputedDomain(e,t){if(!t)return null;if("range"===t.type)return e;if("coded-value"===t.type){const n=t.codedValues.filter((t=>t.hasOwnProperty("code")&&t.code===e));return n&&n.length?n[0].name:e}return null}_getDateFormatOptions(){const{template:e}=this,t=e?.format?.dateFormat;return t?(0,a.J2)(t):e?.input&&"includeTime"in e.input&&!1===e.input.includeTime?C:V}};(0,i._)([(0,r.MZ)()],N.prototype,"_effectiveDomain",null),(0,i._)([(0,r.MZ)()],N.prototype,"_activeFieldInput",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"_effectiveRange",null),(0,i._)([(0,r.MZ)()],N.prototype,"_isAnyDateOrTimeField",null),(0,i._)([(0,r.MZ)()],N.prototype,"_isIntegerField",null),(0,i._)([(0,r.MZ)()],N.prototype,"_isNumericField",null),(0,i._)([(0,r.MZ)()],N.prototype,"_isStringField",null),(0,i._)([(0,r.MZ)()],N.prototype,"_isSubtypeField",null),(0,i._)([(0,r.MZ)({readOnly:!0})],N.prototype,"alias",null),(0,i._)([(0,r.MZ)()],N.prototype,"cellValueFormatFunction",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"cellValueValidatorFunction",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],N.prototype,"defaultValue",null),(0,i._)([(0,r.MZ)()],N.prototype,"effectiveDescription",null),(0,i._)([(0,r.MZ)()],N.prototype,"effectiveEditable",null),(0,i._)([(0,r.MZ)()],N.prototype,"effectiveLabel",null),(0,i._)([(0,r.MZ)()],N.prototype,"effectiveRequired",null),(0,i._)([(0,r.MZ)()],N.prototype,"effectiveTimeZoneOptions",null),(0,i._)([(0,r.MZ)({type:p.default})],N.prototype,"field",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"formatFunction",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"includeTime",null),(0,i._)([(0,r.MZ)()],N.prototype,"inputRenderFunction",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"layer",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],N.prototype,"loadingMessage",null),(0,i._)([(0,r.MZ)()],N.prototype,"maxLength",null),(0,i._)([(0,r.MZ)()],N.prototype,"minLength",null),(0,i._)([(0,r.MZ)({readOnly:!0})],N.prototype,"name",null),(0,i._)([(0,r.MZ)({readOnly:!0})],N.prototype,"nullable",null),(0,i._)([(0,r.MZ)()],N.prototype,"parseInputValueFunction",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"shouldShowPrompt",null),(0,i._)([(0,r.MZ)()],N.prototype,"sortable",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"store",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"template",void 0),(0,i._)([(0,r.MZ)()],N.prototype,"view",void 0),N=(0,i._)([(0,o.$)("esri.widgets.FeatureTable.FieldColumn")],N);const D=N},84668:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(35143),l=n(91967),r=n(46053),o=(n(81806),n(76460),n(47249),n(85842)),a=n(3320);let u=class extends l.default{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(e){const{feature:t,layer:n,timeZone:i}=this;return null==n||null==e?e:(0,a.LZ)({label:e,attributes:t.attributes,fieldsIndex:n.fieldsIndex,timeZone:i})}};(0,i._)([(0,r.MZ)({readOnly:!0})],u.prototype,"description",null),(0,i._)([(0,r.MZ)({constructOnly:!0})],u.prototype,"element",void 0),(0,i._)([(0,r.MZ)()],u.prototype,"evaluatedVisibilityExpression",null),(0,i._)([(0,r.MZ)()],u.prototype,"feature",void 0),(0,i._)([(0,r.MZ)()],u.prototype,"label",null),(0,i._)([(0,r.MZ)()],u.prototype,"layer",void 0),(0,i._)([(0,r.MZ)()],u.prototype,"timeZone",void 0),(0,i._)([(0,r.MZ)()],u.prototype,"type",void 0),(0,i._)([(0,r.MZ)()],u.prototype,"updating",null),(0,i._)([(0,r.MZ)()],u.prototype,"visible",null),(0,i._)([(0,r.MZ)()],u.prototype,"visibilityExpressionExecutor",void 0),u=(0,i._)([(0,o.$)("esri.widgets.FeatureForm.InputBase")],u);const s=u}}]);
//# sourceMappingURL=66635.55fa58bb.chunk.js.map